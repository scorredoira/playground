"use strict";var S;(function(a){a.Window=window;function i(j){return typeof j==="object"&&j!==null}a.isObject=i;function b(j){let o=document.querySelector("meta[name='"+j+"']");return o&&o.getAttribute("content")}a.getMetaTag=b,a.debug=b("debug")=="true",a.needToLoadModules=b("loaded")!="true";function c(j){return j===null||j===""||typeof j==="undefined"}a.isEmpty=c;function d(j){try{return!isNaN(l(j))&&isFinite(j)}catch{return!1}}a.isNumeric=d;function e(j){return j>=65&&j<91||j>=97&&j<123}a.isCharFromCode=e;function h(j){return j>="A"&&j<="Z"||j>="a"&&j<"z"}a.isChar=h;function f(j){return j>="0"&&j<="9"}a.isDigit=f;function g(j){if(!j)return 0;let o=Number(j);if(isNaN(o))throw i18n.T("@@Invalid value")+": "+j;return o}a.toInt=g;function k(j,o){if(typeof j==="string"){let q=a.locale.currencySymbol;j.indexOf(q)!=-1&&(j=j.replace(q,""))}return l(j,o)}a.parseCurrency=k;function l(j,o){return c(j)?o||null:typeof j==="number"?j:(typeof j!=="string"&&(j=String(j)),p(j))}a.parseFloat=l;function p(j){if(!j)return 0;if(typeof j==="number")return j;j.contains(a.locale.thousandSeparator)&&(j=j.replaceAll(a.locale.thousandSeparator,"")),a.locale.decimalSeparator!="."&&(j=j.replace(a.locale.decimalSeparator,"."));let o=globalThis.parseFloat(j);if(isNaN(o))throw i18n.T("@@Invalid value")+": "+j;return o}a.toFloat=p;function m(j,o){return o===void 0&&(o=0),Math.round(j*Math.pow(10,o))/Math.pow(10,o)}a.round=m;function n(j){if(j===null||typeof j!=="object"||"_isActiveClone"in j)return j;if(j instanceof Date)return new Date(j.getTime());var o=j.constructor();for(var q in j)Object.prototype.hasOwnProperty.call(j,q)&&(j._isActiveClone=null,o[q]=n(j[q]),delete j._isActiveClone);return o}a.clone=n})(S||(S={})),String.prototype.splitEx=function(a){let i=[],b=this.split(a);for(let c=0,d=b.length;c<d;c++){let e=b[c];e&&i.push(e)}return i},String.prototype.toTitle=function(){return S.toTitle(this)},String.prototype.equalFold=function(a){return a?this?this.toUpperCase()==a.toUpperCase():a==null||a=="":this==null||this==""},String.prototype.toUntitle=function(){return S.toUntitle(this)},String.prototype.contains=function(a){return this.indexOf(a)!=-1},String.prototype.hasPrefix=function(a){return this.indexOf(a)==0},String.prototype.hasSuffix=function(a){return this.indexOf(a)==this.length-a.length},String.prototype.trimPrefix=function(a){return this.indexOf(a)==-1?this:this.substring(a.length)},String.prototype.trimSuffix=function(a){let i=this.length-a.length;return this.substring(i)==a?this.substring(0,i):this.substring(0)},Array.prototype.groupBy=function(a){let i={};for(let b=0,c=this.length;b<c;b++){let d=this[b],e=a(this[b]);e==null&&(e="");let h=i[e];h?h.push(d):i[e]=[d]}return i},Array.prototype.distinct=function(){let a=[];for(var i=0,b=this.length;i<b;i++){let c=this[i];a.contains(c)||a.push(c)}return a},Array.prototype.select=function(a){let i=[];for(var b=0,c=this.length;b<c;b++){let d=this[b];i.push(a(d))}return i},Array.prototype.selectMany=function(a){let i=[];for(let b=0,c=this.length;b<c;b++){let d=a(this[b]);for(let e=0,h=d.length;e<h;e++)i.push(d[e])}return i},Array.prototype.where=function(a){let i=[];for(var b=0,c=this.length;b<c;b++){let d=this[b];a(d)&&i.push(d)}return i},Array.prototype.take=function(a){return this.length>a?this.slice(0,a):this},Array.prototype.count=function(a){let i=0;for(var b=0,c=this.length;b<c;b++){let d=this[b];a(d)&&i++}return i},Array.prototype.min=function(a){let i;for(var b=0,c=this.length;b<c;b++){let d=a(this[b]);(i==null||d<i)&&(i=d)}return i},Array.prototype.max=function(a){let i;for(var b=0,c=this.length;b<c;b++){let d=a(this[b]);(i==null||d>i)&&(i=d)}return i},Array.prototype.first=function(a){if(!a)return this.length?this[0]:null;for(var i=0,b=this.length;i<b;i++){let c=this[i];if(a(c))return c}return null},Array.prototype.firstIndex=function(a){for(var i=0,b=this.length;i<b;i++){let c=this[i];if(a(c))return i}return-1},Array.prototype.last=function(a){if(!a)return this.length?this[this.length-1]:null;for(var i=this.length;i>=0;i--){let b=this[i];if(a(b))return b}return null},Array.prototype.contains=function(a){for(var i=0,b=this.length;i<b;i++)if(this[i]==a)return!0;return!1},Array.prototype.remove=function(a){let i=this.indexOf(a);i!=-1&&this.splice(i,1)},Array.prototype.removeAt=function(a){this.splice(a,1)},Array.prototype.removeWhere=function(a){for(let i=this.length-1;i>=0;i--){let b=this[i];a(b)&&this.splice(i,1)}},Array.prototype.insertAt=function(a,i){this.splice(a,0,i)},Array.prototype.any=function(a){for(var i=0,b=this.length;i<b;i++)if(a(this[i]))return!0;return!1},Array.prototype.all=function(a){for(var i=0,b=this.length;i<b;i++)if(!a(this[i]))return!1;return!0},Array.prototype.sum=function(a){let i=0;if(a)for(let d=0,e=this.length;d<e;d++){var c=a(this[d]);c&&(i+=c)}else for(let d=0,e=this.length;d<e;d++){var b=this[d];b&&(i+=b)}return i};var S;(function(a){function i(b){switch(b){case"1":case"true":case!0:return!0;default:return!1}}a.toBool=i})(S||(S={}));var S;(function(a){var i;function b(d){i||(i=c);for(var e=0;e<i.length;e++)d=d.replace(i[e].letters,i[e].base);return d}a.removeDiacritics=b;let c=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}]})(S||(S={}));var S;(function(a){function i(j){j.innerHTML=""}a.clear=i;function b(j,o){i(j),j.appendChild(o)}a.setContent=b;function c(j,o){o.firstChild?o.insertBefore(j,o.firstChild):o.appendChild(j)}a.insertFirst=c;function d(j,o){let q=o.parentNode;q.insertBefore(j,o),q.removeChild(o)}a.replace=d;function e(j,o){o.parentNode.insertBefore(j,o)}a.insertBefore=e;function h(j,o){o.parentNode.insertBefore(j,o.nextSibling)}a.insertAfter=h;function f(j,o){let q=o.splitEx(" ");for(var s=0,u=q.length;s<u;s++)j.classList.add(q[s])}a.addClass=f;function g(j,o){let q=j.querySelectorAll("."+o);for(let s=0,u=q.length;s<u;s++)q[s].classList.remove(o)}a.removeClass=g;function k(j,o,q,s){var u=document.createElement(j);return o&&f(u,o),q&&q.appendChild(u),s!==void 0&&s!=null&&(typeof s==="string"?p(u,s,!0):typeof s==="number"?p(u,String(s),!0):s instanceof Node?u.appendChild(s):p(u,String(s),!0)),u}a.create=k;function l(j,o,q,s){var u=document.createElement("input");return u.type=j,s&&(u.value=s),o&&f(u,o),q&&q.appendChild(u),u}a.createInput=l;function p(j,o,q){if(o==null){j.textContent="";return}if(q){j.textContent="",typeof o!=="string"&&(o=String(o));let x=o.split(`
`);for(var s=0,u=x.length;s<u;s++)s>0&&j.appendChild(document.createElement("br")),j.appendChild(document.createTextNode(x[s]))}else j.textContent=o}a.setText=p;function m(j){var o=j.getBoundingClientRect();let q=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop;return{top:o.top+s,left:o.left+q}}a.getOffset=m;function n(j){let o=j.style.visibility,q=j.style.position,s=j.style.top,u=j.style.height,x=j.style.height;j.style.visibility="hidden",j.style.position="absolute",j.style.top="0",j.style.height="unset",j.style.maxHeight="unset";let w=j.parentElement;w?j.remove():document.body.appendChild(j);let y=j.offsetWidth,z=j.offsetHeight;return w?w.appendChild(j):document.body.removeChild(j),j.style.visibility=o,j.style.position=q,j.style.top=s,j.style.height=u,j.style.maxHeight=x,{height:z,width:y}}a.getSize=n})(S||(S={}));var S;(function(a){let i=[];function b(m,n){i.push({key:m,value:n})}a.setGlobalHeader=b;function c(m,n){return l("GET",m,n)}a.get=c;function d(m,n){return l("PUT",m,n,{"Content-Type":"application/json"})}a.put=d;function e(m,n){return l("POST",m,n,{"Content-Type":"application/json"})}a.post=e;function h(m){return l("DELETE",m)}a.del=h;function f(m,n,j){let o;switch(m){case"POST":case"PUT":o={"Content-Type":"application/json"};break}return l(m,n,j,o)}a.request=f;let g;function k(m){g=m}a.setFetchInterceptor=k;async function l(m,n,j,o){n=a.fixURL(n);if(i.length>0){o||(o={});for(let G of i)o[G.key]=G.value}if(g){let G=g(m,n,j,o);if(G!==void 0)return G}if(m=="POST")for(let G in j){let A=j[G];if(A instanceof File||A instanceof Blob)return o&&delete o["Content-Type"],await p(n,j,o)}let q,s=n.indexOf("?");s!=-1&&(q=n.substring(s),n=n.substring(0,s)),q&&(n+=q);if(j&&m=="GET"){var u=n.indexOf("?")==-1?"?":"&";n+=u+a.serializeURLObject(j),j=null}j!=null&&(j=JSON.stringify(j));const x=await fetch(n,{method:m,headers:o,cache:"no-cache",body:j});let w=await x.text(),y=x.headers.get("Content-Type"),z=y?.contains("application/json"),F=z?JSON.parse(w):w;if(x.ok)return F;let D=a.getErrorMessage(F);throw a.addIgnoreError(D),D}async function p(m,n,j){m=a.fixURL(m);if(i.length>0){j||(j={});for(let z of i)j[z.key]=z.value}if(g){let z=g("POST",m,n,j);if(z!==void 0)return z}let o,q=m.indexOf("?");q!=-1&&(o=m.substring(q),m=m.substring(0,q));let s=new FormData();for(let z in n){let F=n[z];F!=null&&s.append(z,F)}const u=await fetch(m,{method:"POST",headers:j,cache:"no-cache",body:s});let x=await u.text(),w=x.length>0?JSON.parse(x):{};if(u.ok)return w;let y=a.getErrorMessage(w);throw a.addIgnoreError(y),y}a.postMultipart=p})(S||(S={}));var S;(function(a){function i(b){return b.splitEx("/").last()}a.pathBase=i})(S||(S={}));var S;(function(a){function i(k,l){if(a.isEmpty(l))return"";switch(k){case"d":return a.parseTime(l).format(a.locale.shortDatePattern);case"D":return a.parseTime(l).format(a.locale.longDatePattern);case"M":return a.parseTime(l).format(a.locale.dateMonthPattern);case"H":return a.parseTime(l).format(a.locale.dateMonthTimePattern);case"g":return a.parseTime(l).format(a.locale.dateTimePattern);case"c":return d(l);case"i":return e(l);case"f":return h(l)}return String(l)}a.format=i;function b(k){return Math.floor(k)==k?e(k):h(k)}a.formatNumber=b;function c(k){return a.isEmpty(k)?"":typeof k==="string"?k:k+"%"}a.formatPercent=c;function d(k,l){if(a.isEmpty(k))return"";if(typeof k==="string")return k;if(!l){l=a.locale;if(!l)return String(k)}let p=h(Math.abs(k),l),m=l.currencyPattern.replace("0",p);return k>=0&&(m=m.replace("-","")),m}function e(k,l){if(a.isEmpty(k))return"";l||(l=a.locale);let p=String(k).split("."),m="",n,j=p[0].charAt(0);switch(j){case"-":case"+":n=j,p[0]=p[0].substring(1);break}let o=p[0],q=o.length-1;for(var s=q;s>=0;s--)m.length>0&&((q-s)%3==0&&(m=l.thousandSeparator+m)),m=o.charAt(s)+m;return n&&(m=n+m),m}function h(k,l,p){if(a.isEmpty(k))return"";typeof k==="string"&&(k=a.parseFloat(k)),l||(l=a.locale),p||(p=l.numberOfDecimals??2),k=a.round(k,p);let m=String(k).split("."),n="",j,o=m[0].charAt(0);switch(o){case"-":case"+":j=o,m[0]=m[0].substring(1);break}let q=m[0],s=q.length-1;for(var u=s;u>=0;u--)n.length>0&&((s-u)%3==0&&(n=l.thousandSeparator+n)),n=q.charAt(u)+n;let x=m.length==2?m[1]:"",w=a.padRight(x,"0",p);return n+=l.decimalSeparator+w,j&&(n=j+n),n}function f(k,...l){if(!k)return k;let p=g(k),m=l?l.length:0,n=[],j=0;for(let o=0,q=p.length;o<q;o++){let s=p[o];switch(s.type){case"text":n.push(s.value);break;case"key":if(m<j)continue;n.push(l[j]),j++;break}}return n.join("")}a.fmt=f;function g(k){let l=[],p=[];for(let m=0,n=k.length;m<n;m++){let j=k[m];switch(j){case"%":let o;if(m<n-1)switch(k[m+1]){case"s":case"d":case"f":case"v":o=!0;break}if(o){p.length>0&&(l.push({type:"text",value:p.join("")}),p=[]),l.push({type:"key",value:k[m+1]}),m++;continue}p.push(j);break;default:p.push(j);break}}return p.length>0&&l.push({type:"text",value:p.join("")}),l}})(S||(S={}));var S;(function(a){function i(g,...k){let l=d(g);if(!l)throw`Function ${g} does not exist`;return l.apply(window,k)}a.exec=i;let b;function c(g,k){k||(k=50),b&&clearTimeout(b),b=setTimeout(g,k)}a.throttleCall=c;function d(g){var k=g.split("."),l=window[k[0]];if(!l)return;for(var p=1;p<k.length;p++){l=l[k[p]];if(!l)return}return l}a.getFuncion=d;function e(g,...k){let l=d(g);if(!l)throw`Invalid class name ${g}`;return new l(...k)}a.instantiate=e;let h=0;function f(){return h++,h+Math.random().toString(36).substring(2)+new a.Time().millisecond.toString(36)}a.getUniqueID=f})(S||(S={}));var i18n;(function(a){let i={},b={};const c={};function d(k,l){c[k]=l}a.addRules=d;function e(k,l,p){p||(p={});let m=i[k];m||(m={},i[k]=m),m[l]=p.resources}a.setTranslations=e;function h(k,...l){return f(null,null,k,...l)}a.T=h;function f(k,l,p,...m){if(!p)return"";p=p.trimPrefix("@@");let n,j=S.locale?.language;if(j){let o=S.parseRoute().module,q,s=i[o];if(s){let u=s[j];u&&(q=u[p])}if(!q){s=i.admin;if(s){let u=s[j];u&&(q=u[p])}}if(!q){s=i.slib;if(s){let u=s[j];u&&(q=u[p])}}q&&(n=g(q,j,k,l,p))}return n===void 0&&(n=p),m.length>0&&(n=S.fmt(n,...m)),n}a.getText=f;function g(k,l,p,m,n){if(!k)return n;if(typeof k=="string")return k;if(Array.isArray(k)){let j;if(m!=null){let o=c[l];if(o)for(let q of o){if(q.min!=null&&q.min<m)continue;if(q.max!=null&&q.max>m)continue;j=q.index;break}}return k[j?j:0]}return k=k[p||"all"],g(k,l,null,m,n)}})(i18n||(i18n={}));var S;(function(a){a.locale={culture:"en",currencyPattern:"-$0",currencySymbol:"$",numberOfDecimals:2,decimalSeparator:".",thousandSeparator:",",firstDayOfWeek:0,dateTimePattern:"dd-MM-yyyy HH:mm",longDatePattern:"ddd, MMM dd yyyy",dateMonthPattern:"ddd, MMM dd",dateMonthTimePattern:"ddd, MMM dd HH:mm",shortDatePattern:"MM-dd-yyyy"};function i(c){a.locale=c,i18n.addRules(c.language,c.pluralizationRules)}a.setLocale=i;async function b(c,d){if(!d){d=a.loadModuleType;if(!d)throw"no module type"}let e=a.parseRoute().tenant;e=="system"&&(e="unknown");let h=`/${e}/locale/api/translations?module=${c}&type=${d}`,f=a.locale?.language;f&&(h+="&language="+f);let g=await a.get(h);if(!g){i18n.setTranslations(c,f,null);return}i18n.setTranslations(c,g.language,g)}a.loadTranslations=b})(S||(S={}));var Keys;(function(a){a.DEL=8,a.TAB=9,a.ENTER=13,a.SHIFT=16,a.CTRL=17,a.ALT=18,a.ESC=27,a.SPACE=32,a.PAGEUP=33,a.PAGEDOWN=34,a.END=35,a.HOME=36,a.LEFT=37,a.UP=38,a.RIGHT=39,a.DOWN=40,a.SUPR=46,a.KEY_0=48,a.KEY_1=49,a.KEY_2=50,a.KEY_3=51,a.KEY_4=52,a.KEY_5=53,a.KEY_6=54,a.KEY_7=55,a.KEY_8=56,a.KEY_9=57,a.A=65,a.B=66,a.C=67,a.D=68,a.E=69,a.F=70,a.G=71,a.H=72,a.I=73,a.J=74,a.K=75,a.L=76,a.M=77,a.N=78,a.O=79,a.P=80,a.Q=81,a.R=82,a.S=83,a.T=84,a.U=85,a.V=86,a.W=87,a.X=88,a.Y=89,a.Z=90,a.NUM0=96,a.NUM1=97,a.NUM2=98,a.NUM3=99,a.NUM4=100,a.NUM5=101,a.NUM6=102,a.NUM7=103,a.NUM8=104,a.NUM9=105,a.MUL=106,a.ADD=107,a.SUB=109,a.POINT=110,a.DIV=111,a.F1=112,a.F2=113,a.F3=114,a.F4=115,a.F5=116,a.F6=117,a.F7=118,a.F8=119,a.F9=120,a.F10=121,a.F11=122,a.F12=123,a.SEMICOLON=186,a.EQUAL=187,a.COMMA=188,a.DASH=189,a.PERIOD=190,a.FORWARDSLASH=191,a.ACCENT=192,a.OPENBRACKET=219,a.BACKSLASH=220,a.CLOSEBRACKET=221,a.SINGLEQUOTE=222,a.META=224,a.ALTGR=225;function i(b){switch(b){case a.DEL:return"DEL";case a.TAB:return"TAB";case a.ENTER:return"ENTER";case a.SHIFT:return"SHIFT";case a.CTRL:return"CTRL";case a.ALT:return"ALT";case a.ESC:return"ESC";case a.PAGEUP:return"PAGEUP";case a.PAGEDOWN:return"PAGEDOWN";case a.END:return"END";case a.HOME:return"HOME";case a.LEFT:return"LEFT";case a.UP:return"UP";case a.RIGHT:return"RIGHT";case a.DOWN:return"DOWN";case a.SUPR:return"SUPR";case a.NUM0:return"NUM0";case a.NUM1:return"NUM1";case a.NUM2:return"NUM2";case a.NUM3:return"NUM3";case a.NUM4:return"NUM4";case a.NUM5:return"NUM5";case a.NUM6:return"NUM6";case a.NUM7:return"NUM7";case a.NUM8:return"NUM8";case a.NUM9:return"NUM9";case a.A:return"A";case a.B:return"B";case a.C:return"C";case a.D:return"D";case a.E:return"E";case a.F:return"F";case a.G:return"G";case a.H:return"H";case a.I:return"I";case a.J:return"J";case a.K:return"K";case a.L:return"L";case a.M:return"M";case a.N:return"N";case a.O:return"O";case a.P:return"P";case a.Q:return"Q";case a.R:return"R";case a.S:return"S";case a.T:return"T";case a.U:return"U";case a.V:return"V";case a.W:return"W";case a.X:return"X";case a.Y:return"Y";case a.Z:return"Z";case a.MUL:return"MUL";case a.ADD:return"ADD";case a.SUB:return"SUB";case a.POINT:return"POINT";case a.DIV:return"DIV";case a.F1:return"F1";case a.F2:return"F2";case a.F3:return"F3";case a.F4:return"F4";case a.F5:return"F5";case a.F6:return"F6";case a.F7:return"F7";case a.F8:return"F8";case a.F9:return"F9";case a.F10:return"F10";case a.F11:return"F11";case a.F12:return"F12";case a.SEMICOLON:return"SEMICOLON";case a.EQUAL:return"EQUAL";case a.COMMA:return"COMMA";case a.DASH:return"DASH";case a.PERIOD:return"PERIOD";case a.FORWARDSLASH:return"FORWARDSLASH";case a.ACCENT:return"ACCENT";case a.OPENBRACKET:return"OPENBRACKET";case a.BACKSLASH:return"BACKSLASH";case a.CLOSEBRACKET:return"CLOSEBRACKET";case a.SINGLEQUOTE:return"SINGLEQUOTE";case a.META:return"META";case a.ALTGR:return"ALTGR"}}a.getKeyString=i})(Keys||(Keys={}));var S;(function(a){class i extends Array{push(b,c){return super.push(b),c||(this.onInsert&&this.onInsert(b),this.onChange&&this.onChange()),this.length}insertAt(b,c,d){super.insertAt(b,c),d||(this.onInsert&&this.onInsert(c),this.onChange&&this.onChange())}remove(b,c){super.remove(b),c||(this.onRemove&&this.onRemove(b),this.onChange&&this.onChange())}removeAt(b,c){let d=super[b];super.removeAt(b),c||(this.onRemove&&this.onRemove(d),this.onChange&&this.onChange())}clear(b){for(let c=this.length-1;c>=0;c--)this.remove(this[c],b)}}a.List=i})(S||(S={}));var S;(function(a){var i=[];function b(d){i.push(d)}a.setLoadedFile=b;async function c(d){return new Promise((e,h)=>{let f=d.urls;for(let o=f.length-1;o>=0;o--)i.contains(f[o])&&f.removeAt(o);let g=f.length;g==0&&e();let k=0,l=0,p=[],m=function(o){k++,i.push(o),k+l==g&&j()},n=o=>{p.push(o),i.remove(o),l++,k+l==g&&j()};function j(){l>0?h("Error loading "+p):e()}for(let o=0;o<g;o++){let q=f[o],s=q.length;if(q.substring(s-4)==".css"){if(i.indexOf(q)!=-1){m(q);continue}let u=document.createElement("link");u.setAttribute("rel","stylesheet"),u.setAttribute("type","text/css"),u.onload=()=>m(q),u.onerror=()=>n(q),u.setAttribute("href",a.setUrlValue(q,"cb",a.cacheBreaker)),document.getElementsByTagName("head")[0].appendChild(u)}else{if(i.indexOf(q)!=-1){m(q);continue}let u=document.createElement("script");u.onload=()=>m(q),u.onerror=()=>n(q),u.src=a.setUrlValue(q,"cb",a.cacheBreaker),d.async!==void 0?u.async=d.async:u.async=!1,document.body.appendChild(u)}}})}a.loadFiles=c})(S||(S={}));var S;(function(a){const i=[];function b(e){i.length>5&&i.shift(),i.push(e)}a.addIgnoreError=b;function c(e){return e?typeof e=="string"?e:e.error?e.error:e.stack&&e.stack.contains("/vendor/vs/language/")?void 0:e.toString?e.toString():JSON.stringify(e):"Unhandled Client Error"}a.getErrorMessage=c;async function d(e){let h=c(e);if(h.contains("ResizeObserver"))return;if(h=="Script error.")return;ui.showToast(h,"error");if(i.contains(e))return;try{await a.post("/system/api/logError",{message:h,url:a.getCurrentURL(),client:JSON.stringify(window.navigator.userAgent)})}catch(f){console.log("Error notifiyng error",e,f)}}a.logError=d})(S||(S={}));var orm;(function(a){a.PASSWORD_MASK="****";function i(d){return d.name+d.refDesc.toTitle()}a.getRefDesc=i;function b(d,e,h){if(!e)return!1;for(let f of e){if(f.name!="*"&&!S.systemSession.permissions.contains(f.name))continue;if(f.flags=="*"||f.flags.contains(d))return!0}return!1}a.hasPermission=b;function c(d){switch(d.default){case null:case void 0:return;case"now()":return new S.Time();default:return d.default}}a.getDefaultValue=c})(orm||(orm={}));var S;(function(a){function i(b,c){switch(b){case"c":return a.parseCurrency(c);case"i":return parseInt(c);case"f":return a.parseFloat(c)}return c}a.parse=i})(S||(S={}));var S;(function(a){function i(c){let d=a.PeriodTypes.first(e=>e.name==c);if(!d)throw"invalid period type "+c;return d.func()}a.parsePeriod=i;function b(c){if(c.range){let d=a.PeriodTypes.first(e=>e.name==c.range);return i18n.T(d.label)}else{if(c.start&&c.end)return c.start.format("d")+" - "+c.end.format("d");{if(c.start)return c.start.format("d")+" - ";if(c.end)return" - "+c.end.format("d")}}}a.toPeriodString=b,a.PeriodTypes=[{name:"today",label:"@@Today",func:()=>{let c=new a.Time().startOfDay(),d=new a.Time().endOfDay();return{start:c,end:d}}},{name:"yesterday",label:"@@Yesterday",func:()=>{let c=new a.Time().addDays(-1).startOfDay(),d=c.endOfDay();return{start:c,end:d}}},{name:"thisMonth",label:"@@This month",func:()=>{var c=new a.Time();let d=a.newDate(c.year,c.month,1,0,0,0),e=d.addMonths(1).addDays(-1).endOfDay();return{start:d,end:e}}},{name:"lastMonth",label:"@@Last month",func:()=>{var c=new a.Time();let d=a.newDate(c.year,c.month,1,0,0,0).addMonths(-1),e=d.addMonths(1).addDays(-1).endOfDay();return{start:d,end:e}}},{name:"thisYear",label:"@@This year",func:()=>{var c=new a.Time();let d=a.newDate(c.year,1,1,0,0,0),e=d.addYears(1).addDays(-1).endOfDay();return{start:d,end:e}}},{name:"lastYear",label:"@@Last year",func:()=>{var c=new a.Time();let d=a.newDate(c.year-1,1,1,0,0,0),e=d.addYears(1).addDays(-1).endOfDay();return{start:d,end:e}}}]})(S||(S={}));var S;(function(a){function i(c){if(!c.user)return;a.systemSession=c}a.setSystemSession=i;function b(c){return c?a.systemSession.permissions.contains(c):!0}a.hasPermission=b})(S||(S={}));var S;(function(a){a.shortcuts={};function i(l,p){a.shortcuts[l.toUpperCase()]=p}a.registerShortcut=i;function b(){for(var l in a.shortcuts)a.shortcuts.hasOwnProperty(l)&&delete a.shortcuts[l]}a.unregisterAll=b;function c(l){delete a.shortcuts[l]}a.unregister=c;function d(){for(var l in a.shortcuts)if(a.shortcuts.hasOwnProperty(l)){var p=a.shortcuts[l];p.global||delete a.shortcuts[l]}}a.clearLocalShortcuts=d;function e(){window.addEventListener("keydown",h)}a.initShorcuts=e;function h(l){var p=f(l);if(p==null)return;var m=a.shortcuts[p.toUpperCase()];if(m){l.stopPropagation(),m.func(l);return}}function f(l){var p=k(l.keyCode,!0);return p==null?null:(l.metaKey&&(p="META+"+p),l.altKey&&(p="ALT+"+p),l.shiftKey&&(p="SHIFT+"+p),l.ctrlKey&&(p="CTRL+"+p),p)}function g(l){return l>=Keys.KEY_0&&l<=Keys.KEY_9||l>=Keys.A&&l<=Keys.Z||l>=Keys.NUM0&&l<=Keys.NUM9?!0:!1}a.isWord=g;function k(l,p){if(p)switch(l){case Keys.SHIFT:case Keys.CTRL:case Keys.ALT:case Keys.META:case Keys.ALTGR:return null}return Keys.getKeyString(l)}a.getChar=k})(S||(S={}));var S;(function(a){function i(p,m){return Array(m+1).join(p||" ")}a.repeat=i;function b(p,m,n){typeof p==="number"&&(p=String(p));let j=p.length;if(j>=n)return p;m||(m=" ");for(var o=0,q=n-j;o<q;o++)p=m+p;return p}a.padLeft=b;function c(p,m,n){let j=p.length;if(j>=n)return p;m||(m=" ");for(var o=0,q=n-j;o<q;o++)p+=m;return p}a.padRight=c;function d(p,m){return p?p.length<=m?p:p.substring(0,m):p}a.take=d;function e(p){return p?p.charAt(0).toUpperCase()+p.substring(1):p}a.toTitle=e;function h(p){return p?p.charAt(0).toLowerCase()+p.substring(1):p}a.toUntitle=h;function f(p,m){return p.indexOf(m)==0&&(p=p.substring(m.length)),p}a.removePrefix=f;function g(p,m){return p=k(p,m),p=l(p,m),p}a.trim=g;function k(p,m){for(var n=0;~m.indexOf(p[n]);)n++;return n>0&&(p=p.slice(n)),p}a.trimLeft=k;function l(p,m){for(var n=p.length-1,j=n;~m.indexOf(p[j]);)j--;return j<n&&(p=p.slice(0,j+1)),p}a.trimRight=l})(S||(S={}));var S;(function(a){let i={},b=Intl.DateTimeFormat().resolvedOptions().timeZone;a.ISO_DATE_FORMAT="yyyy-MM-dd",a.ISO_DATETIME_FORMAT="yyyy-MM-ddTHH:mm:ss";function c(){return new g()}a.now=c;function d(m,n){return new g(new Date(m),n)}a.newTime=d;function e(m,n,j,o,q,s,u){n!=null&&n--;let x=new Date();o==null&&(o=x.getHours()),q==null&&(q=x.getMinutes()),s==null&&(s=x.getSeconds());let w=new Date(m??x.getFullYear(),n??x.getMonth(),j??x.getDate(),o,q,s);return new g(w,u)}a.newDate=e;function h(m){if(m instanceof g)return m;let n=new f().parse(m),j=a.locale?.timezone;return j&&j!=b&&(n=n.in(j)),n}a.parseTime=h;class f{constructor(){this.formats=[a.locale.dateTimePattern,a.locale.shortDatePattern,a.ISO_DATETIME_FORMAT,a.ISO_DATE_FORMAT]}parse(m){for(let n of this.formats){let j=this.doParse(m,n);if(j)return new g(j,b)}throw`invalid format ${m}`}doParse(m,n){this.value=m,this.format=n;let j,o,q,s,u,x;for(;;){let w=this.nextFormatToken();if(!w)break;let y=this.nextValueToken();if(!y)return;switch(w){case"d":case"dd":q=Number(y);if(q<1||q>31)return;break;case"M":case"MM":o=Number(y);if(o<1||o>12)return;break;case"yy":j=Number(y);if(j<0||j>99)return;j+=2000;break;case"yyyy":j=Number(y);if(j<1000||j>9999)return;break;case"H":case"HH":s=Number(y);if(s<0||s>23)return;break;case"h":case"hh":s=Number(y);if(s<0||s>11)return;break;case"m":case"mm":u=Number(y);if(u<0||u>59)return;break;case"s":case"ss":x=Number(y);if(x<0||x>59)return;break;default:return}if(this.format.length==0)break;let z=this.nextFormatToken(!0);if(!z)break;let F=this.nextValueToken(!0);if(!F||z!=F)return}return this.format.length>0||this.value.length>0?void 0:j==null||o==null||q==null?void 0:new Date(j,o-1,q,s??0,u??0,x??0)}nextFormatToken(m){let n=[],j,o;for(j=0,o=this.format.length;j<o;j++){let q=this.format[j];if(m){if(a.isChar(q))break;q=="/"&&(q="-")}else if(!a.isChar(q))break;n.push(q)}return this.format=this.format.substring(j),n.join("")}nextValueToken(m){let n=[],j,o;for(j=0,o=this.value.length;j<o;j++){let q=this.value[j];if(m){if(a.isDigit(q))break;q=="/"&&(q="-")}else if(!a.isDigit(q))break;n.push(q)}return this.value=this.value.substring(j),n.join("")}}a.TimeParser=f;class g{constructor(m,n){m||(m=new Date()),this._date=m,n||(n=a.locale?.timezone),n?(this._location=n,this._locationOffset=this.getTimezoneOffset(this,n)):(this._location=b,this._locationOffset=this._date.getTimezoneOffset())}get location(){return this._location}get locationOffset(){return this._locationOffset}get nativeDate(){return this._date}get hour(){return this._date.getHours()}get minute(){return this._date.getMinutes()}get second(){return this._date.getSeconds()}get millisecond(){return this._date.getMilliseconds()}get milliseconds(){return this._date.getTime()}get day(){return this._date.getDate()}get weekDay(){return this._date.getDay()}get month(){return this._date.getMonth()+1}get year(){return this._date.getFullYear()}before(m){return this._date.getTime()<m._date.getTime()}beforeOrEqual(m){return this._date.getTime()<=m._date.getTime()}after(m){return this._date.getTime()>m._date.getTime()}afterOrEqual(m){return this._date.getTime()>=m._date.getTime()}isSameDay(m){return this.year===m.year&&this.month===m.month&&this.day===m.day}addMilliseconds(m){return d(this._date.getTime()+m,this._location)}addMinutes(m){return this.addMilliseconds(m*60000)}addHours(m){return this.addMilliseconds(m*60*60000)}addDays(m){var n=this.copy();return n._date.setDate(n.day+m),n}isLeapYear(){let m=this.year;return m%4===0&&m%100!==0||m%400===0}daysInMonth(){let m=this.month-1;return[31,this.isLeapYear()?29:28,31,30,31,30,31,31,30,31,30,31][m]}addMonths(m){let n=new Date(this._date.getTime());return n.setDate(1),n.setMonth(this.month-1+m),n.setDate(Math.min(n.getDate(),this.daysInMonth())),new g(n)}addYears(m){var n=this.copy();return n._date.setFullYear(n.year+m),n}setDay(m){var n=this.copy();return n._date.setDate(m),n}setTime(m,n,j,o){var q=this.copy();if(typeof m==="string"){let s=m.split(":");m=a.toInt(s[0]),n=a.toInt(s[1])}return q._date.setHours(m,n??0,j??0,o??0),q}in(m){let n=this.getUTCTime(),j=this.getTimezoneOffset(this,m),o=new g(new Date(n-j*60*1000),m);return o}startOfDay(){return new g(new Date(this.year,this.month-1,this.day),this._location)}endOfDay(){let m=new Date(this.year,this.month-1,this.day);return m.setDate(m.getDate()+1),new g(new Date(m.getTime()-1),this.location)}copy(){return new g(new Date(this._date.getTime()),this.location)}getUTCTime(){return this._date.getTime()+this._locationOffset*60*1000}toUTC(){return new g(new Date(this.getUTCTime()),"UTC")}getTimezoneOffset(m,n){if(n=="UTC")return 0;const j=this.formatTimezone("UTC",m),o=this.formatTimezone(n,m);let q=this.parseISOLocal(o),s=this.parseISOLocal(j),u=s.getTime()-q.getTime();return u/60/1000}formatTimezone(m,n){let j=this.getFormat(m),o=j.format(n._date);var q=o.splitEx(/\D/);let s=parseInt(q[3],10);return s>=24&&(s-=24,o=q[0]+"/"+q[1]+"/"+q[2]+", "+s+":"+q[4]+":"+q[5]),o}toString(){return this.format("yyyy-MM-dd HH:mm")+" ("+this._location+")"}format(m){switch(m){case"t":m="HH:mm";break;case"d":m=a.locale.shortDatePattern;break;case"D":m=a.locale.longDatePattern;break;case"M":m=a.locale.dateMonthPattern;break;case"H":m=a.locale.dateMonthTimePattern;break;case"g":m=a.locale.dateTimePattern;break;case"G":m=a.locale.longDatePattern+" HH:mm";break;case"r":return p(this)}let n=[];for(let o=0,q=m.length-1;o<=q;o++){let s=m[o];switch(s){case"d":if(o<q&&m[o+1]=="d"){if(o<q-1&&m[o+2]=="d"){n.push({token:"ddd"}),o+=2;continue}n.push({token:"dd"}),o++;continue}n.push({token:"d"});continue;case"M":if(o<q&&m[o+1]=="M"){if(o<q-1&&m[o+2]=="M"){n.push({token:"MMM"}),o+=2;continue}n.push({token:"MM"}),o++;continue}n.push({token:"M"});continue;case"y":if(o<q&&m[o+1]=="y"){if(o<q-2&&m[o+2]=="y"&&m[o+3]=="y"){n.push({token:"yyyy"}),o+=3;continue}n.push({token:"yy"}),o++;continue}n.push(s);break;case"w":n.push({token:"w"});continue;case"h":if(o<q&&m[o+1]=="h"){n.push({token:"hh"}),o++;continue}n.push({token:"h"});continue;case"H":if(o<q&&m[o+1]=="H"){n.push({token:"HH"}),o++;continue}n.push({token:"H"});continue;case"m":if(o<q&&m[o+1]=="m"){n.push({token:"mm"}),o++;continue}n.push({token:"m"});continue;case"s":if(o<q&&m[o+1]=="s"){n.push({token:"ss"}),o++;continue}n.push({token:"s"});continue;case"a":n.push({token:"a"});continue;case"z":n.push({token:"z"});continue;case"Z":n.push({token:"Z"});continue;case"\\":if(o<q){n.push(m[o+1]),o++;continue}break;default:n.push(s);break}}let j=[];for(let o of n)switch(o.token){case"d":j.push(this.day);break;case"dd":j.push(a.padLeft(String(this.day),"0",2));break;case"ddd":let q=a.weekDayNames[this.weekDay];j.push(i18n.T(q));break;case"M":j.push(this.month);break;case"MM":j.push(a.padLeft(String(this.month),"0",2));break;case"MMM":let s=a.monthNames[this.month-1];j.push(i18n.T(s));break;case"yy":j.push(a.padLeft(String(this.year-2000),"0",2));break;case"yyyy":j.push(this.year);break;case"w":j.push(this.weekDay);break;case"h":j.push(this.hour);break;case"hh":let u=this.hour;u>12&&(u-=12),j.push(a.padLeft(String(u),"0",2));break;case"HH":j.push(a.padLeft(String(this.hour),"0",2));break;case"m":j.push(this.minute);break;case"mm":j.push(a.padLeft(String(this.minute),"0",2));break;case"s":j.push(this.second);break;case"ss":j.push(a.padLeft(String(this.second),"0",2));break;case"a":j.push(this.hour<12?"AM":"PM");break;case"z":j.push(String(this._locationOffset));break;case"Z":j.push(this.location);break;case void 0:j.push(o);break;default:j.push(o.token);break}return j.join("")}toJSON(){return this.format(a.ISO_DATETIME_FORMAT)}getFormat(m){let n=i[m];return n||(n=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:m}),i[m]=n),n}parseISOLocal(m){var n=m.splitEx(/\D/);if(n.length!=6)throw"Invalid ISO date";let j=Number(n[0])-1,o=Number(n[1]),q=Number(n[2]),s=Number(n[3]),u=Number(n[4]),x=Number(n[5]);return new Date(q,j,o,s,u,x,0)}}a.Time=g;let k;(function(m){m[m.Sunday=0]="Sunday",m[m.Monday=1]="Monday",m[m.Tuesday=2]="Tuesday",m[m.Wednesday=3]="Wednesday",m[m.Thursday=4]="Thursday",m[m.Friday=5]="Friday",m[m.Saturday=6]="Saturday"})(k=a.weekDay||(a.weekDay={})),a.weekDayNames=["@@Sunday","@@Monday","@@Tuesday","@@Wednesday","@@Thursday","@@Friday","@@Saturday"],a.weekDaysShort=["@@Sun","@@Mon","@@Tue","@@Wed","@@Thu","@@Fri","@@Sat"];function l(m){return a.weekDayNames[m]}a.getWeekdayName=l,a.monthNames=["@@January","@@February","@@March","@@April","@@May","@@June","@@July","@@August","@@September","@@October","@@November","@@December"];function p(m){typeof m==="string"&&(m=h(m));let n=60,j=n*60,o=j*24;var q=Math.round((new g().milliseconds-m.milliseconds)/1000);if(q<30)return i18n.T("@@a moment ago");{if(q<n)return i18n.T("@@%d seconds ago",q);{if(q<2*n)return i18n.T("@@one minute ago");{if(q<j)return i18n.T("@@%d minutes ago",Math.round(q/n));{if(Math.floor(q/j)==1)return i18n.T("@@an hour ago");if(q<o)return i18n.T("@@%d hours ago",Math.round(q/j))}}}}return m.format("g")}})(S||(S={}));var S;(function(a){a.cacheBreaker=a.getMetaTag("cache");function i(n){var j=n.match(/^(?:(https?\:)\/\/)?(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return j?{href:n,protocol:j[1],host:j[2],hostname:j[3],port:j[4],pathname:j[5],search:j[6],hash:j[7]}:void 0}a.parseURL=i;function b(n){if(!n)return n;switch(typeof n){case"string":return encodeURIComponent(n);case"number":case"boolean":return n;default:return n instanceof a.Time?encodeURIComponent(n.toJSON()):encodeURIComponent(JSON.stringify(n))}}a.serializeURLParam=b;function c(n){var j=[];for(var o in n){var q=n[o];if(q==null)continue;j[j.length]=encodeURIComponent(o)+"="+b(q)}return j.join("&")}a.serializeURLObject=c;function d(n){let j=g(n);switch(j){case"1":case"true":return!0;case"0":case"false":return!1}}a.getURLBool=d;function e(n){let j=g(n);return j?parseInt(j,10):void 0}a.getURLInt=e;function h(n){let j=g(n);return j?a.parseTime(j):void 0}a.queryTime=h;function f(n){let j=g(n);return JSON.parse(j)}a.getURLJSON=f;function g(n){if(!n)return null;for(var j=window.location.search.substring(1),o=j.split("&"),q=0,s=o.length;q<s;q++){var u=o[q].indexOf("=");if(o[q].substring(0,u)===n)return decodeURIComponent(o[q].substring(u+1))}return null}a.getURLSTring=g;function k(n,j){let o=window.location,q=o.pathname+o.search;return l(q,n,j)}a.getURLWithValue=k;function l(n,j,o){j=encodeURIComponent(j),a.isEmpty(o)||(o=b(o));var q=n.indexOf("?");if(q==-1)return n+"?"+j+"="+o;for(var s=n.substring(0,q+1),u=n.substring(q+1),x=u!=""?u.split("&"):[],w=0,y=!1,q=0,z=x.length;q<z;q++){var F=x[q].split("=");if(F.length<=1)continue;var D=F[0];if(D=="")continue;D==j?(y=!0,o!=null&&(w>0&&(s+="&"),w++,s+=D+"="+o)):(w>0&&(s+="&"),w++,s+=D+"="+F[1])}return!y&&o&&(x.length>0&&(s+="&"),s+=j+"="+o),s}a.setUrlValue=l;function p(n,j,o){var q=document.createElement("form");q.style.visibility="hidden",q.style.position="absolute",q.style.top="0",o&&(q.target=o),q.method="POST",q.action=n;for(var s in j)if(j.hasOwnProperty(s)){var u=document.createElement("input");u.type="text",u.name=s,u.value=j[s],q.appendChild(u)}document.body.appendChild(q),q.submit(),document.body.removeChild(q)}a.postForm=p;function m(){var n=navigator.userAgent,j,o=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(o[1]))return j=/\brv[ :]+(\d+)/g.exec(n)||[],{name:"IE",version:j[1]||""};if(o[1]==="Chrome"){j=n.match(/\bOPR|Edge\/(\d+)/);if(j!=null)return{name:"Opera",version:j[1]}}return o=o[2]?[o[1],o[2]]:[navigator.appName,navigator.appVersion,"-?"],(j=n.match(/version\/(\d+)/i))!=null&&o.splice(1,1,j[1]),{name:o[0],version:o[1]}}a.getBrowser=m})(S||(S={}));var S;(function(a){let i;window.addEventListener("keydown",r=>{(r.ctrlKey||r.altKey)&&(i=!0)}),window.addEventListener("keyup",()=>{i=!1});function b(){return i}a.isControlPressed=b;function c(){let r=location.hostname;return r=="localhost"||r.hasPrefix("127.")}a.isLocal=c;const d=["account","assets","cms","system"];let e,h;var f,g;let k={};var l={};function p(r,t,v){r=M(r);let C=r.replace(".","/").splitEx("/"),B=l,E=[];for(var H=0,J=C.length;H<J;H++){var K=C[H];K.charAt(0)==":"&&(E||(E=[]),E.push(K.substring(1)),K=":"),B.child||(B.child={});let I=B.child[K];if(I){B=I;continue}I={},B.child[K]=I,B=I}let N={url:r,params:E,handler:v,filter:t};B.route=N,k[r]=N}a.addRoute=p;function m(r){return a.getURLSTring("ret")||r}a.getBackURL=m;function n(){return Object.keys(k)}a.getRouteURLs=n;function j(r,t){p(r,null,t)}a.addPublicRoute=j;let o=[];function q(r){o.push(r)}a.addRouteChangeAction=q;function s(){for(let r=0,t=o.length;r<t;r++)o[r]();o=[]}function u(r,t){const v=" ⚫︎";let C=document.title;r?C.contains(v)||(document.title+=v):C.contains(v)&&(document.title=document.title.replace(v,""));if(r){a.isDirty=!0,typeof t==="string"?(e=t,h=null):(h=t,e=null),window.onbeforeunload=()=>!0;return}a.isDirty=!1,h=null,e=null,window.onbeforeunload=null}a.setDirty=u;function x(r){if(!a.isDirty)return!0;if(r)return window.confirm(r)?(u(!1),!0):!1;if(h){if(h())return u(!1),!0}else if(window.confirm(e||i18n.T("@@Leave and ignore changes? ")))return u(!1),!0}a.confirmLeave=x;function w(r,t){if(t){var v=r.indexOf("?")==-1?"?":"&";r+=v+a.serializeURLObject(t)}window.open(r,"_blank")}a.executeInNewTab=w;function y(r){if(!r){let t=window.location;r=t.pathname+t.search}window.location.href=r}a.reloadDocument=y;async function z(){let r=window.location,t=r.pathname+r.search;O(t)}a.reloadView=z;function F(r){if(!r){let t=window.location;r=t.pathname+t.search,r=t.pathname+t.search}window.location.replace(r)}a.refresh=F;function D(r){window.location.href=M(r)}a.redirect=D;function G(){let r=window.location.pathname.splitEx("/");return r.length<3?null:r.slice(3)}a.getRouteParams=G;function A(){let r=window.location;return r.pathname+r.search}a.getCurrentURL=A;function ia(){return g}a.getCurrentAction=ia;function ja(){let r=window.location;return r.pathname}a.getCurrentPath=ja;function ka(r){let t=a.getURLSTring("ret");if(t){O(t);return}if(f){O(f.route.url);return}if(r){O(r);return}history.back()}a.goBack=ka;function la(r,t){return!r||!t?!1:a.parseURL(r).pathname==a.parseURL(t).pathname}a.areSamePath=la;function T(r){if(r){let v=r.indexOf("?");v!=-1&&(r=r.substring(0,v))}else r=window.location.pathname;let t=r.splitEx("/");return d.contains(t[0])?{tenant:a.systemSession?.tenant||"unknown",module:t[0]}:{tenant:t[0],module:t[1]}}a.parseRoute=T;function _(r){let t=r.indexOf("?");return t!=-1&&(r=r.substring(0,t)),r}a.getURLPath=_;function ma(r,t){t||(t={}),t.ret=A(),O(r,t)}a.executeWithReturn=ma;async function O(r,t,v){if(a.isDirty){if(!x())return}let C=r.indexOf("?");if(t){var B=C==-1?"?":"&";r+=B+a.serializeURLObject(t)}if(r.hasPrefix("URL:")){r=r.trimPrefix("URL:"),r=M(r),i?window.open(r,"_blank"):window.location.href=M(r);return}if(r.hasPrefix("FILE:")){r=r.trimPrefix("FILE:"),r=M(r),i?window.open(r,"_blank"):window.location.href=M(r);return}r=M(r);if(i){window.open(r,"_blank");return}if(a.needToReloadPage){window.location.replace(r);return}a.clearLocalShortcuts(),s(),ui.closeAll(),a.needToLoadModules&&await ra(r);let E=_(r),H=na(E);if(!H){U("Action not found: "+a.parseURL(r).pathname);return}let J=H.route;if(!J){console.log("Not found: "+E);return}oa(r,v?.mode);if(J.filter&&!J.filter())return;let K=v?.data;if(a.debug)J.handler(H.params,K);else try{J.handler(H.params,K)}catch(V){U(V)}let N=f!=null;g&&(f=g);let I={route:J,routeParams:H.params,data:K};g=I,N&&window.dispatchEvent(new CustomEvent("routeChange",{detail:r})),window.scrollTo(0,0)}a.executeAction=O;function na(r){let t=r.splitEx("/"),v=t.length;if(v>0){let L=t[v-1],da=L.indexOf(".");da!=-1&&(t[v-1]=L.substring(0,J),t.push(L.substring(da+1)))}let C=[],B,E=l;for(var H=0,J=t.length;H<J;H++){var K=t[H];if(!E.child){if(B)break;return null}B=!1;let L=E.child[K];if(L){E=L;continue}L=E.child[":"];if(L){C.push(K),E=L;continue}L=E.child["*"];if(L){B=!0,E=L;continue}return null}if(!E.route)return null;let N,I=E.route;if(I.params&&I.params.length>0){N={};for(var H=0,J=I.params.length;H<J;H++){var V=I.params[H];N[V]=C[H]}}return{route:I,params:N}}function oa(r,t){switch(t){case null:case void 0:Q(r,r,r);break;case"ReplaceHistory":R(r,r,r);break;case"InPlace":break}}function M(r){if(r.hasPrefix("//")){let t=T();r="/"+t.tenant+r.substring(1)}return r}a.fixURL=M;let P=[];function pa(r){P.contains(r)||P.push(r)}a.setAsLoadedModule=pa;function qa(r){a.loadModuleType=r}a.setLoadModuleType=qa;async function ra(r,t){let v=T(r).module;if(!v)throw`invalid path (module): ${r}`;return $(v,t)}async function $(r,t){t||(t=a.loadModuleType);if(!t)return;if(P.contains(r))return;await Promise.all([a.loadTranslations(r,t),a.loadFiles({urls:["/assets/modules/"+r+"_"+t+".js","/assets/modules/"+r+"_"+t+".css"]})]),P.push(r)}a.loadModule=$;function sa(r,t){if(t){var v=r.indexOf("?")==-1?"?":"&";r+=v+a.serializeURLObject(t)}return r}a.getURL=sa;function aa(r){return typeof r=="string"?r:a.debug&&r.stack?r.stack:r.error?r.error:r.toString?r.toString():JSON.stringify(r)}a.errorToString=aa;function U(r){let t=aa(r),v=document.getElementById("page");v.innerHTML=`<h1 class="center">${t}</h1>`,a.logError(t)}a.handleError=U,window.addEventListener("popstate",function(r){let t=r.state;typeof t==="string"&&O(t,null,{mode:"DontAddToHistory"})});function ta(r,t){let v=r.indexOf("?");v!=-1&&(r=r.substring(v)),Q(r,t,r)}a.pushURL=ta;function ua(r){r||(r=""),document.title=r;let t=window.location,v=t.pathname+t.search;window.history.replaceState(v,r,v)}a.pushTitle=ua;function va(r,t,v){let C=a.getURLSTring(r);if(C==t)return;if(!C&&!t)return;let B=a.getURLWithValue(r,t);R(B,v||document.title,B)}a.replaceURLValue=va;function wa(r,t){let v=btoa(JSON.stringify(t));v=v.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),ba(r,v)}a.pushAsBase64=wa;function xa(r){let t=a.getURLSTring(r);return t?(t.length%4!=0&&(t+="===".slice(0,4-t.length%4)),t=t.replace(/-/g,"+").replace(/_/g,"/"),JSON.parse(atob(t))):void 0}a.getFromBase64=xa;function ba(r,t,v){let C=a.getURLSTring(r);if(C==t)return;if(C==null&&t==null)return;let B=a.getURLWithValue(r,t);v===!1?R(B,document.title,B):Q(B,document.title,B)}a.pushURLValue=ba;let ca;function Q(r,t,v){if(ca==v){window.history.replaceState(r,t,v);return}ca=v,t==v&&(t=a.parseURL(v).pathname),window.history.pushState(r,t,v),t==null&&(t="");var C=document.getElementsByTagName("title");C.length>0&&C[0].appendChild(document.createTextNode(t)),t&&(document.title=t)}a.pushState=Q;function R(r,t,v){let C=window.location,B=C.pathname+C.search;if(B==v)return;window.history.replaceState(r,t,v),t==null&&(t="");var E=document.getElementsByTagName("title");E.length>0&&E[0].appendChild(document.createTextNode(t)),t&&(document.title=t)}a.replaceState=R})(S||(S={}));var ui;(function(a){function i(f,g,k){let l=k?()=>S.throttleCall(g,k):g,p=new ResizeObserver(l);p.observe(f.element),S.addRouteChangeAction(()=>p.disconnect())}a.addResizeObserver=i;function b(){let f=document.activeElement;f&&f.blur()}a.blur=b;function c(){return"ontouchstart"in window||navigator.maxTouchPoints>0}a.isTouchScreen=c;function d(f){return a.currentView.getById(f)}a.getById=d;function e(f){let g;if(f.control){let k=f.control;k.id||(k.id=f.name),g=k}else if(f.readOnly){let k=new a.PropertyLabel();k.id=f.name,g=k}else switch(f.type){case"bool":if(f.inlineLabel===!1){let A=new a.Select();A.options=[{value:"1",label:i18n.T("@@yes")},{value:"0",label:i18n.T("@@no")}],g=A}else{let A=new a.Checkbox();A.id=f.name,A.text=i18n.T(f.label||f.name),g=A}break;case"int":let k=new a.NumberInput();k.format="i",k.id=f.name,g=k,h(f,k);break;case"decimal":let l=new a.TextInput();l.format="f",l.id=f.name,g=l,h(f,l);break;case"currency":let p=new a.TextInput();p.format="f",p.id=f.name,p.suffix=S.locale.currencySymbol,g=p,h(f,p);break;case"text":let m=new a.TextArea();m.id=f.name,g=m;break;case"hash":case"encrypted":let n=new a.PasswordInput();f.options?.autocomplete||(n.input.autocomplete="new-password"),n.id=f.name,g=n,h(f,n);break;case"html":let j=new a.HTMLEditor();j.id=f.name,j.render(),g=j;break;case"color":let o=new a.ColorPicker();o.id=f.name,g=o;break;case"date":let q=new a.DatePicker();q.id=f.name,g=q,h(f,q);break;case"datetime":let s=new a.DateTimeInput();s.id=f.name,g=s,h(f,s);break;case"image":let u=new a.ImagePicker();u.id=f.name,g=u;break;case"file":let x=new a.Filepicker();x.id=f.name,g=x;break;case"picklist":let w=new a.Select();w.id=f.name,f.options?.loadURL?w.loadURL=f.options.loadURL:f.items&&(w.options=f.items.select(A=>({value:String(A.value),label:i18n.T(A.label||A.name)}))),g=w;break;case"picklistKey":let y=new a.Select();y.id=f.name,f.options?.loadURL?y.loadURL=f.options.loadURL:f.items&&(y.options=f.items.select(A=>({value:A.name,label:i18n.T(A.label||A.name)}))),g=y;break;case"lookup":let z=S.parseRoute(),F=`//${z.module}/api/crud/${f.refTable}/lookup?property=${f.refDesc||"name"}`,D=new a.Select();D.id=f.name,D.loadURL=F,g=D;break;default:let G=new a.TextInput();G.id=f.name,g=G,h(f,G);break}g.property=f,g.focusVisible=!0,f.default&&(g.value=orm.getDefaultValue(f)),f.classList&&a.addClass(g,f.classList);if(f.options)for(let k in f.options)g[k]=f.options[k];return g}a.getControl=e;function h(f,g){if(!f.inlineHelp)return;let k=a.getIcon("help");k.style.cursor="pointer",k.classList.add("suffixIcon"),g.suffixElement.appendChild(k),new a.Tooltip(f.inlineHelp,k)}})(ui||(ui={}));var ui;(function(a){function i(d){typeof d==="string"&&(d=JSON.parse(d));let e=S.instantiate(d.type);return b(e,e.settings,d),e}a.build=i;function b(d,e,h){for(let f of Object.keys(e)){switch(f){case"type":continue}let g=e[f],k=c(f,g,h);if(k==null)continue;switch(g.kind){case"style":d.style[f]=k;break;case"signal":d.addSignalListener(f,k);break;case"property":d[f]=k;break}}}function c(d,e,h){let f=h[d];if(f==null)return;switch(e.type){case"string":case"color":case"icon":return f;case"function":let l=S.getFuncion(f);return l;case"control":return i(f);case"controlList":let p=f;var g=new S.List();for(let n of p)g.push(i(n));return g;case"object":var k={};return b(k,e.settings,f),k;case"objectList":let m=[];for(let n of f){var k={};b(k,e.settings,n),m.push(k)}return m;case"boolean":switch(f){case"true":case!0:case"1":case 1:return!0;default:return!1}default:return f}}})(ui||(ui={}));var ui;(function(a){let i=[];function b(f){if(i.contains(f))return;i.push(f)}a.addCloser=b;function c(f){for(let g=i.length-1;g>=0;g--)f==i[g]&&i.removeAt(g)}a.removeCloser=c;function d(){for(let f=i.length-1;f>=0;f--)i[f].close();i=[]}a.closeAll=d;function e(f){let g=f.getDescendants();for(let k=i.length-1;k>=0;k--){let l=i[k];g.contains(l)&&(l.close(),i.removeAt(k))}}a.closeDescendants=e;function h(f){let g=f.getAncestors();for(let k=i.length-1;k>=0;k--){let l=i[k];if(g.contains(l))continue;l.close(),i.removeAt(k)}}a.closeOthers=h})(ui||(ui={}));var ui;(function(a){const i=["click","show"],b=["color","backgroundColor","height","width","maxHeight","minHeight","maxWidth","minWidth","padding","margin","display","overflow","fontFamily"];class c{constructor(f,g,k,l){this.element=document.createElement(f),this._children=new S.List(),this._children.onInsert=p=>this.onInsertChildren(p),this._children.onRemove=p=>this.onRemoveChildren(p);if(g)for(let p of g.splitEx(" "))this.element.classList.add(p);k&&k.appendChild(this),l!==void 0&&l!=null&&(typeof l==="string"?S.setText(this.element,l,!0):this.appendChild(l)),this.settings={id:{type:"string",kind:"property",readonly:!0},type:{type:"string",kind:"property"}};for(let p of i)this.settings[p]={type:"function",kind:"signal"};for(let p of b)this.settings[p]={type:"string",kind:"style"};this.element.addEventListener("click",p=>{p.stopPropagation(),this.sendSignal("click")})}addSettings(f){for(let g in f)this.settings[g]=f[g]}get classList(){return this.element.classList}get style(){return this.element.style}get textContent(){return this.element.textContent}set textContent(f){this.element.textContent=f}get id(){return this._id}set id(f){this._id=f}get parent(){return this._parent}setParent(f,g){this._parent&&this._parent.removeChild(this,g),this._parent=f}get windowParent(){return this._windowParent}get childWindows(){return this._childWindows||(this._childWindows=[]),this._childWindows}appendWindow(f){return f.windowParent&&f.windowParent.childWindows.remove(f),f._windowParent=this,this.childWindows.push(f),f}get children(){return this._children}set children(f){this._children.clear(),this._children=f;for(let g of f)this.onInsertChildren(g)}contains(f){for(let g of this._children){if(g==f)return!0;for(let k of g.children){if(k==f)return!0;if(k.contains(f))return!0}}}getDescendants(){let f=[];for(let g of this._children){f.push(g);for(let k of g.getDescendants())f.push(k)}for(let g of this.childWindows){f.push(g);for(let k of g.getDescendants())f.push(k)}return f}getAncestors(){let f=[];this._windowParent&&(f=f.concat(this._windowParent.getAncestors()));let g=this.parent;for(;g;)f.push(g),g=g.parent;return f}removeChild(f,g){this._children.remove(f,g)}replaceChild(f,g){S.replace(f.element,g.element),this._children.remove(g,!0),f.setParent(this),this._children.push(f,!0)}setChild(f){this.clear(),f&&this.appendChild(f)}onInsertChildren(f){f.setParent(this),this.element.appendChild(f.element)}onRemoveChildren(f){f.element.remove()}appendChild(f){return this._children.push(f),f}clear(){this._children.clear(),this.element.innerHTML=""}remove(){this.parent?this.parent.removeChild(this):this.element.remove()}addFinalListener(f,g){let k=l=>{l.stopPropagation(),g(l)};this.addSignalListener(f,k)}addSignalListener(f,g){this.listeners||(this.listeners=[]),this.listeners.push({type:f,func:g})}removeSignalListener(f){if(!this.listeners)return;for(let g=this.listeners.length-1;g>=0;g--)if(f==this.listeners[g].func){this.listeners.removeAt(g);break}}sendSignal(f,g,k){let l=new d();l.type=f,l.data=g,l.source=this,this.doSendSignal(l);switch(k){case"bubbleDown":break;default:this.bubbleUp(l);break}switch(k){case"bubbleAll":case"bubbleDown":h(this,p=>p.doSendSignal(l));break}}bubbleUp(f){let g=this.parent;for(;g;){if(f.propagationStopped)break;g.doSendSignal(f),g=g.parent}}doSendSignal(f){if(this.listeners)for(let g of this.listeners)g.type==f.type&&g.func(f)}getById(f){if(this.id==f)return this;for(let g of this._children){if(g.id==f)return g;let k=g.getById(f);if(k)return k}}getTopParent(){let f=this;for(;f.parent;)f=f.parent;return f}}a.Control=c;class d{stopPropagation(){this.propagationStopped=!0}}a.Signal=d;function e(f,g){let k=g.splitEx(" ");for(var l=0,p=k.length;l<p;l++)f.element.classList.add(k[l])}a.addClass=e;function h(f,g){let k=f.children;for(let l=0,p=k.length;l<p;l++){let m=k[l];g(m),h(m,g)}}a.forEach=h})(ui||(ui={}));var ui;(function(a){function i(e,...h){let f=g=>{for(let k of h)if(k&&k.contains(g.source))return;a.currentView.removeSignalListener(f),e()};return requestAnimationFrame(()=>{if(!a.currentView)return;a.currentView.addSignalListener("click",f)}),f}a.addGlobalClick=i;function b(e){a.currentView.removeSignalListener(e)}a.removeGlobalClick=b;function c(e){let h=f=>{window.removeEventListener("resize",h),e()};return window.addEventListener("resize",h),h}a.addGlobalResize=c;function d(e){window.removeEventListener("resize",e)}a.removeGlobalResize=d})(ui||(ui={}));var ui;(function(a){function i(h,f,g){let k=d(h,f,g);if(!k)throw"Invalid icon: "+h;let l=new a.Icon(k);return l.element.classList.add("icon-"+h),l}a.getIcon=i;function b(){return Object.keys(e)}a.getIcons=b;function c(h,f){e[h]=f}a.setIconPath=c;function d(h,f,g){let k=e[h];if(!k)return;var l=document.createElementNS("http://www.w3.org/2000/svg","svg");return l.classList.add("icon"),l.setAttribute("width",String(f||16)),l.setAttribute("height",String(g||16)),l.setAttribute("viewBox","0 0 24 24"),l.setAttribute("fill","none"),l.setAttribute("stroke","currentColor"),l.setAttribute("stroke-linecap","round"),l.innerHTML=k,l}a.getIconElement=d;let e={critical:'<circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line>',warning:'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line>',success:'<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline>',info:'   <circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line>',home:'<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline>',arrowLeft:'<line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline>',arrowRight:'<line x1="5" y1="12" x2="19" y2="12" /><line x1="13" y1="18" x2="19" y2="12" /><line x1="13" y1="6" x2="19" y2="12" />',arrowUpRight:'<line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline>',arrowUp:'<line x1="12" y1="5" x2="12" y2="19" /><line x1="16" y1="9" x2="12" y2="5" /><line x1="8" y1="9" x2="12" y2="5" />',fileExport:'<path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M11.5 21h-4.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v5m-5 6h7m-3 -3l3 3l-3 3" />',tableExport:'<path d="M11.5 20h-5.5a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v7.5m-16 -3.5h16m-10 -6v16m4 -1h7m-3 -3l3 3l-3 3" />',arrowsHorizontal:'<polyline points="7 8 3 12 7 16" /><polyline points="17 8 21 12 17 16" /><line x1="3" y1="12" x2="21" y2="12" />',mobile:'<rect x="7" y="4" width="10" height="16" rx="1" /><line x1="11" y1="5" x2="13" y2="5" /><line x1="12" y1="17" x2="12" y2="17.01" />',laptop:'<line x1="3" y1="19" x2="21" y2="19" /><rect x="5" y="6" width="14" height="10" rx="1" />',eye:'<circle cx="12" cy="12" r="2" /><path d="M22 12c-2.667 4.667 -6 7 -10 7s-7.333 -2.333 -10 -7c2.667 -4.667 6 -7 10 -7s7.333 2.333 10 7" />',eyeOff:'<line x1="3" y1="3" x2="21" y2="21" /><path d="M10.584 10.587a2 2 0 0 0 2.828 2.83" /> <path d="M9.363 5.365a9.466 9.466 0 0 1 2.637 -.365c4 0 7.333 2.333 10 7c-.778 1.361 -1.612 2.524 -2.503 3.488m-2.14 1.861c-1.631 1.1 -3.415 1.651 -5.357 1.651c-4 0 -7.333 -2.333 -10 -7c1.369 -2.395 2.913 -4.175 4.632 -5.341" />',leftChevron:'<polyline points="15 18 9 12 15 6"></polyline>',rightChevron:'<polyline points="9 18 15 12 9 6"></polyline>',downChevron:'<polyline points="6 9 12 15 18 9"></polyline>',upChevron:'<polyline points="6 15 12 9 18 15" />',rightCaret:'<path d="M18 15l-6-6l-6 6h12" transform="rotate(90 12 12)" />',downCaret:'<path d="M18 15l-6-6l-6 6h12" transform="rotate(180 12 12)" />',crop:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 5v10a1 1 0 0 0 1 1h10" /><path d="M5 8h10a1 1 0 0 1 1 1v10" />',justifyLeft:'<line x1="4" y1="6" x2="20" y2="6" /><line x1="4" y1="12" x2="14" y2="12" /><line x1="4" y1="18" x2="18" y2="18" />',justifyCenter:'<line x1="4" y1="6" x2="20" y2="6" /><line x1="8" y1="12" x2="16" y2="12" /><line x1="6" y1="18" x2="18" y2="18" />',justifyFull:'<path d="M21 10H3"/><path d="M21 6H3"/><path d="M21 14H3"/><path d="M21 18H3"/>',justifyRight:'<line x1="4" y1="6" x2="20" y2="6" /><line x1="10" y1="12" x2="20" y2="12" /><line x1="6" y1="18" x2="20" y2="18" />',typography:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="20" x2="7" y2="20" /><line x1="14" y1="20" x2="21" y2="20" /><line x1="6.9" y1="15" x2="13.8" y2="15" /><line x1="10.2" y1="6.3" x2="16" y2="20" /><polyline points="5 20 11 4 13 4 20 20" />',bold:'<path d="M7 5h6a3.5 3.5 0 0 1 0 7h-6z" /><path d="M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7" />',italic:'<line x1="11" y1="5" x2="17" y2="5" /><line x1="7" y1="19" x2="13" y2="19" /><line x1="14" y1="5" x2="10" y2="19" />',underline:'<line x1="6" y1="20" x2="18" y2="20" /><path d="M8 5v6a4 4 0 0 0 8 0v-6" />',link:'<path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/>',remove:'<path d="M21 4H8l-7 8 7 8h13a2 2 0 002-2V6a2 2 0 00-2-2z"/><path d="M18 9l-6 6"/><path d="M12 9l6 6"/>',code:'<path d="M16 18l6-6-6-6"/><path d="M8 6l-6 6 6 6"/>',indentLeft:'<line x1="20" y1="6" x2="13" y2="6" /><line x1="20" y1="12" x2="11" y2="12" /><line x1="20" y1="18" x2="13" y2="18" /><path d="M8 8l-4 4l4 4" />',indentRight:'<line x1="20" y1="6" x2="9" y2="6" /><line x1="20" y1="12" x2="13" y2="12" /><line x1="20" y1="18" x2="9" y2="18" /><path d="M4 8l4 4l-4 4" />',photo:'<line x1="15" y1="8" x2="15.01" y2="8" /><rect x="4" y="4" width="16" height="16" rx="3" /><path d="M4 15l4 -4a3 5 0 0 1 3 0l 5 5" /><path d="M14 14l1 -1a3 5 0 0 1 3 0l 2 2" />',gripVertical:'<circle cx="9" cy="5" r="1" /><circle cx="9" cy="12" r="1" /><circle cx="9" cy="19" r="1" /><circle cx="15" cy="5" r="1" /><circle cx="15" cy="12" r="1" /><circle cx="15" cy="19" r="1" />',header:'<rect x="4" y="4" width="16" height="16" rx="2" /><line x1="4" y1="9" x2="20" y2="9" />',footer:'<rect x="4" y="4" width="16" height="16" rx="2" /><line x1="4" y1="15" x2="20" y2="15" />',thumbsUp:'<path d="M7 11v8a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-7a1 1 0 0 1 1 -1h3a4 4 0 0 0 4 -4v-1a2 2 0 0 1 4 0v5h3a2 2 0 0 1 2 2l-1 5a2 3 0 0 1 -2 2h-7a3 3 0 0 1 -3 -3" />',palette:'<path d="M12 21a9 9 0 1 1 0 -18a9 8 0 0 1 9 8a4.5 4 0 0 1 -4.5 4h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" /><circle cx="7.5" cy="10.5" r=".5" fill="currentColor" /><circle cx="12" cy="7.5" r=".5" fill="currentColor" /><circle cx="16.5" cy="10.5" r=".5" fill="currentColor" />',world:'<circle cx="12" cy="12" r="9" /><line x1="3.6" y1="9" x2="20.4" y2="9" /><line x1="3.6" y1="15" x2="20.4" y2="15" /><path d="M11.5 3a17 17 0 0 0 0 18" /><path d="M12.5 3a17 17 0 0 1 0 18" />',wallet:'<path d="M17 8v-3a1 1 0 0 0 -1 -1h-10a2 2 0 0 0 0 4h12a1 1 0 0 1 1 1v3m0 4v3a1 1 0 0 1 -1 1h-12a2 2 0 0 1 -2 -2v-12" /><path d="M20 12v4h-4a2 2 0 0 1 0 -4h4" />',ticket:'<line class="cls-1" x1="0.5" y1="14.46" x2="15.5" y2="0.58"/><line class="cls-1" x1="7.49" y1="22.75" x2="22.5" y2="8.87"/><line class="cls-1" x1="0.5" y1="14.46" x2="1.88" y2="15.81"/><line class="cls-1" x1="7.39" y1="22.64" x2="6.02" y2="21.29"/><line class="cls-1" x1="15.73" y1="0.5" x2="17.11" y2="1.85"/><line class="cls-1" x1="22.62" y1="8.68" x2="21.25" y2="7.33"/><line class="cls-1" x1="12.34" y1="5.74" x2="13.24" y2="6.61"/><line class="cls-1" x1="14.55" y1="7.9" x2="15.44" y2="8.77"/><line class="cls-1" x1="16.63" y1="9.93" x2="17.52" y2="10.81"/><path class="cls-1" d="M6.36,21.66c0-3-1.17-4.91-4.16-5.46" transform="translate(-0.33 -0.38)"/><path class="cls-1" d="M17.45,2.22c0,3,1.16,4.92,4.14,5.49" transform="translate(-0.33 -0.38)"/>',more:'<circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle>',fileText:'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline>',archive:'<polyline points="21 8 21 21 3 21 3 8"></polyline><rect x="1" y="3" width="22" height="5"></rect><line x1="10" y1="12" x2="14" y2="12"></line>',star:'<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>',"refresh-cw":'<polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>',"refresh-ccw":'<polyline points="1 4 1 10 7 10"></polyline><polyline points="23 20 23 14 17 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>',mapPin:'<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle>',box:'<path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line>',key:'<path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>',grid:'<rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect>',minus:'<line x1="5" y1="12" x2="19" y2="12"></line>',school:'<polygon points="12,4.9 0.7,8.8 12,13 23.3,8.8 "/><path d="M19.6,15.7c-7.5,3.1-7.5,3.1-14.9,0v-5.3"/><path d="M19.6,20.1v-9.9l-8-1.4"/>',slash:'<circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>',plus:'<line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line',maximize:'<path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>',flag:'<path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line>',tag:'<path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line>;',rotateFwd:'<polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>',rotateBack:'<polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>',settings:'<circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>',package:'<path d="M12.89 1.45l8 4A2 2 0 0 1 22 7.24v9.53a2 2 0 0 1-1.11 1.79l-8 4a2 2 0 0 1-1.79 0l-8-4a2 2 0 0 1-1.1-1.8V7.24a2 2 0 0 1 1.11-1.79l8-4a2 2 0 0 1 1.78 0z"></path><polyline points="2.32 6.16 12 11 21.68 6.16"></polyline><line x1="12" y1="22.76" x2="12" y2="11"></line><line x1="7" y1="3.5" x2="17" y2="8.5"></line>',list:'<line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3" y2="6"></line><line x1="3" y1="12" x2="3" y2="12"></line><line x1="3" y1="18" x2="3" y2="18"></line>',check:'<polyline points="20 6 9 17 4 12"></polyline>',circle:'<circle cx="12" cy="12" r="10"></circle>',alertCircle:'<circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12" y2="16"></line>',alertTriangle:'<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12" y2="17"></line>',sun:'<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>',system:'<rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect><line x1="6" y1="6" x2="6" y2="6"></line><line x1="6" y1="18" x2="6" y2="18">',options:'<circle cx="12" cy="12" r="2"></circle><circle cx="12" cy="4" r="2"></circle><circle cx="12" cy="20" r="2"></circle>',posts:'<polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline>',book:'<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>',cashRegister:'<polyline points="22 13 16 13 14 16 10 16 8 13 2 13"></polyline><path d="M5.47 5.19L2 13v5a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5l-3.47-7.81A2 2 0 0 0 16.7 4H7.3a2 2 0 0 0-1.83 1.19z"></path>',delete:'<polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line>',edit:'<path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path><polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>',edit2:'<path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path',xSquare:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="9" x2="15" y2="15"></line><line x1="15" y1="9" x2="9" y2="15"></line>',plusSquare:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line>',minusSquare:'<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="8" y1="12" x2="16" y2="12"></line>',copy:'<rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>',bookmark:'<path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>',phone:'<path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>',folder:'<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>',file:'<path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>',newFile:'<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line>',config:'<line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line>',client:'<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>',clients:'<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path>',shield:'<path d="M12 22s8-4 8-10V4l-8-2-8 2v8c0 6 8 10 8 10z"></path>',cam:'<polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>',camOff:'<path d="M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"></path><line x1="1" y1="1" x2="23" y2="23"></line>',lock:'<rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path>',creditCard:'<rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line>',shoppingCart:'<circle cx="8" cy="21" r="2"></circle><circle cx="20" cy="21" r="2"></circle><path d="M5.67 6H23l-1.68 8.39a2 2 0 0 1-2 1.61H8.75a2 2 0 0 1-2-1.74L5.23 2.74A2 2 0 0 0 3.25 1H1"></path>',search:'<circle cx="10.5" cy="10.5" r="7.5"></circle><line x1="21" y1="21" x2="15.8" y2="15.8"></line>',attach:'<path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>',printer:'<polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect>',smartphone:'<rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12" y2="18"></line>',tablet:'<rect x="4" y="2" width="16" height="20" rx="2" ry="2" transform="rotate(180 12 12)"></rect><line x1="12" y1="18" x2="12" y2="18">',close:'<line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>',external:'<path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>',calendar:'<rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>',bell:'<path d="M22 17H2a3 3 0 0 0 3-3V9a7 7 0 0 1 14 0v5a3 3 0 0 0 3 3zm-8.27 4a2 2 0 0 1-3.46 0"></path>',mail:'<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline>',send:'<line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>',menu:'<line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>',comment:'<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>',help:'<circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12" y2="17"></line>',filter:'<polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>',clock:'<circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>',download:'<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line>',upload:'<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line>',login:'<path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line>',logout:'<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line>',barChart:'<line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line>',pieChart:'<path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path><path d="M22 12A10 10 0 0 0 12 2v10z"></path>',activity:'<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>',database:'<ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>',table:'<rect x="4" y="4" width="16" height="16" rx="2" /><line x1="4" y1="10" x2="20" y2="10" /><line x1="10" y1="4" x2="10" y2="20" />',columns:'<line x1="4" y1="6" x2="9.5" y2="6" /><line x1="4" y1="10" x2="9.5" y2="10" /><line x1="4" y1="14" x2="9.5" y2="14" /><line x1="4" y1="18" x2="9.5" y2="18" /><line x1="14.5" y1="6" x2="20" y2="6" /><line x1="14.5" y1="10" x2="20" y2="10" /><line x1="14.5" y1="14" x2="20" y2="14" /><line x1="14.5" y1="18" x2="20" y2="18" />',repeat:'<polyline points="17 1 21 5 17 9"></polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"></path><polyline points="7 23 3 19 7 15"></polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"></path>',money:'<rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line>',coffee:'<path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line>',clipboard:'<path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>',cart:'<circle cx="4.5" cy="17.3" r="3"/><line  x1="16" y1="18.2" x2="8.5" y2="18.3"/><circle cx="19.5" cy="17.3" r="3"/><path d="M19.5,13.5v-3c0-3.3-1.8-6-4-6h-7c-2.2,0-4,2.7-4,6v3"/><line x1="9.6" y1="12.7" x2="7.1" y2="15.3"/>',clubs:'<path d="M10,7.6h6.5c0.7,0,1.3,0.6,1.3,1.4v11.6c0,0.8-0.6,1.4-1.3,1.4H10c-0.7,0-1.3-0.6-1.3-1.4V9 C8.7,8.2,9.3,7.6,10,7.6z"/><line x1="11" y1="3.4" x2="11" y2="7.1"/><line x1="15.4" y1="2" x2="15.4" y2="7.4"/><path d="M7.5,11.5l-0.9,0c-0.9,0-1.7,0.9-1.7,2l0,3.5c0,1.1,0.8,2,1.7,2l0.9,0"/>',electric:'<circle cx="8.7" cy="16.5" r="3"/><path d="M2.7,4.5l3,0c1.1,0,2,0.9,2,2l0,7"/><line x1="20.3" y1="17.4" x2="12.7" y2="17.5"/>',manual:'<line x1="3.4" y1="3.5" x2="20.6" y2="20.5"/><circle cx="10" cy="17.8" r="3"/>',moto:'<circle cx="4.5" cy="17.3" r="3"/><line x1="16" y1="16.9" x2="8.5" y2="16.9"/><circle cx="19.5" cy="17.3" r="3"/><line x1="8" y1="10.9" x2="5.9" y2="13.9"/><line x1="20" y1="12.1" x2="16.4" y2="12.2"/>'}})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(c,d,e,h){super(c,d,e,h);this.settings.value={type:"string",kind:"property"},this.settings.input={type:"function",kind:"signal"}}addValidation(c){this.validations||(this.validations=[]),this.validations.push(c)}validate(){let c=this.property;if(c){let d=this.value;if(S.isEmpty(d)){if(!c.nullable&&!c.nullableInType){let e=i18n.T("@@%s is required",i18n.T(this.validateLabel||c.label||c.name));return this.showError(e),e}}else if(typeof d==="string"){if(c.size&&d.length&&d.length>c.size){let e=i18n.T("@@%s is too long. Max is %d, got %d",i18n.T(this.validateLabel||c.label||c.name),c.size,d.length);return this.showError(e),e}}switch(c.type){case"int":try{S.isEmpty(d)||S.toInt(d)}catch(e){let h=i18n.T("@@The value must be a number with no decimals.");return this.showError(h),h}break;case"decimal":try{S.isEmpty(d)||S.toFloat(d)}catch(e){let h=i18n.T("@@The value must be a number with no decimals.");return this.showError(h),h}break}}if(this.validations)for(let d of this.validations){let e=d();if(e)return this.showError(e),e}this.showError(null)}}a.InputControl=i;class b extends i{constructor(c,d){super("div","ui-input");d&&a.addClass(this,d),this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.prefixElement=new a.Control("span","prefix",this.inputPanel),this.input=S.createInput(c,null,this.inputPanel.element),this.clearElement=new a.Control("span","clear",this.inputPanel),this.suffixElement=new a.Control("span","suffix",this.inputPanel),this.input.autocomplete="off",this.input.addEventListener("input",e=>this.onInput(e))}showError(c){this.errorPanel.clear();if(!c){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=c}get id(){return this.input.id}set id(c){this.input.id=c}get inlineLabel(){return!1}onInput(c){c.stopPropagation(),this.updateClearIcon(),this.sendSignal("input")}updateClearIcon(){if(!this._clearIcon)return;this.input.value?this.clearElement.element.classList.add("visible"):this.clearElement.element.classList.remove("visible")}get clearIcon(){return this._clearIcon}set clearIcon(c){this._clearIcon=c,this.clearElement.clear();if(c){let d=a.getIcon("critical",20,20);this.clearElement.appendChild(d),this.clearElement.addSignalListener("click",()=>{this.value=null,this.sendSignal("input",{clearIcon:!0})})}}get value(){return this.format?S.parse(this.format,this.input.value):this.input.value}set value(c){this.format&&(c=S.format(this.format,c)),this.input.value=c,this.updateClearIcon()}get placeholder(){return this.input.placeholder}set placeholder(c){this.input.placeholder=c}set prefixIcon(c){this.prefixElement.clear(),this.prefixElement.element.appendChild(a.getIconElement(c))}get prefix(){return this.prefixElement.element.textContent}set prefix(c){this.prefixElement.element.textContent=c}get prefixSolid(){return this.prefixElement.classList.contains("solid")}set prefixSolid(c){c?this.prefixElement.classList.add("solid"):this.prefixElement.classList.remove("solid")}get suffix(){return this.suffixElement.element.textContent}set suffix(c){this.suffixElement.element.textContent=c}set suffixIcon(c){this.suffixElement.clear(),this.suffixElement.element.appendChild(a.getIconElement(c))}}a.Input=b})(ui||(ui={}));var ui;(function(a){function i(d){let e=new a.Modal();e.dismissPanel.style.display="none";let h;typeof d==="string"?(e.dialog.classList.add("modalText"),h={content:d}):h=d,e.title=h.title,h.className&&e.classList.add(h.className),typeof h.content==="string"&&(h.content=new a.Text(h.content)),e.contentPanel.setChild(h.content);let f=new a.ButtonGroup();return e.footerRight.setChild(f),h.leftButtons&&e.footerLeft.appendChild(h.leftButtons),e.show(),new Promise(g=>{let k=new a.Button(i18n.T("@@Cancel"));f.appendChild(k),k.click=async()=>{if(h.cancel){k.wait=!0;let p=await h.cancel();k.wait=!1,p!==!1&&(e.close(),g(!1))}else e.close(),g(!1)};let l=new a.Button(h.okLabel||i18n.T("@@Accept"));f.appendChild(l),h.destructive?l.destructive=!0:l.highlighted=!0,l.click=async()=>{if(h.accept){l.wait=!0;let p;try{p=await h.accept()}finally{l.wait=!1}p!==!1&&(e.close(),g(!0))}else e.close(),g(!0)}})}a.confirm=i;function b(d){let e=new a.Modal(),h;typeof d==="string"?(e.dialog.classList.add("modalText"),h={content:d}):h=d,e.title=h.title,h.className&&e.classList.add(h.className),typeof h.content==="string"&&(h.content=new a.Text(h.content)),e.contentPanel.setChild(h.content);let f=new a.ButtonGroup();e.footerRight.setChild(f),h.leftButtons&&e.footerLeft.appendChild(h.leftButtons),e.show();let g=new a.Button(h.okLabel||i18n.T("@@Accept"));f.appendChild(g),h.destructive?g.destructive=!0:g.highlighted=!0,g.click=async()=>{if(h.accept){g.wait=!0;let k=await h.accept();g.wait=!1,k!==!1&&e.close()}else e.close()}}a.alert=b;async function c(d){let e=new a.Modal();e.title=d.title,d.className&&e.classList.add(d.className),e.contentPanel.setChild(d.content);let h=new a.ButtonGroup(),f;!d.accept&&d.cancelButton!==!1&&(f=new a.Button(i18n.T("@@Cancel")),h.appendChild(f),f.click=()=>e.close());let g=new a.Button(d.okLabel||i18n.T("@@Accept"));h.appendChild(g),g.highlighted=!0;let k;return d.accept?(k=async()=>{g.wait=!0;try{let l=await d.accept();g.wait=!1,l!==!1&&e.close()}catch(l){a.showToast(l,"error")}finally{g.wait=!1}},g.click=k):g.click=()=>e.close(),e.footerRight.setChild(h),{modal:e,show:()=>e.show(),close:()=>e.close(),okButton:g,accept:k,cancelButton:f}}a.newModal=c})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c,d){super(b,c,d)}}a.ModelControl=i})(ui||(ui={}));var ui;(function(a){function i(b,c){switch(b.type){case"hash":case"encrypted":return orm.PASSWORD_MASK;case"date":return S.format("d",c);case"datetime":return S.format("g",c);case"int":return S.format("i",c);case"decimal":return S.format("f",c);case"currency":return S.format("c",c);case"bool":return c==1||c==!0?i18n.T("@@yes"):i18n.T("@@no");case"picklist":if(b.items)for(var d=0,e=b.items.length;d<e;d++){var h=b.items[d];if(h.value==c)return i18n.T(h.label||h.name)}break}return c}a.formatProperty=i})(ui||(ui={}));var ui;(function(a){function i(b,c){const d=b.selectionStart,e=b.selectionEnd,h=b.value,f=h.substring(0,d),g=h.substring(e,h.length);b.value=f+c+g,b.selectionStart=b.selectionEnd=d+c.length}a.insertText=i})(ui||(ui={}));var ui;(function(a){function i(b){a.currentView&&(a.currentView=null),b.element.getAttribute("fullHeight")=="true"&&(document.body.parentElement.style.height="100%",document.body.style.height="100%");let c=document.getElementById("page");c.innerHTML="",c.appendChild(b.element),a.currentView=b,document.title=b.title||"",b.sendSignal("show",null,"bubbleDown")}a.setView=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c,d,e){super(b,c,d);this.waitElement=e||this}get spinnerColor(){return this._spinnerColor}set spinnerColor(b){this._spinnerColor=b}get waitDelay(){return this._waitDelay}set waitDelay(b){this._waitDelay=b}get wait(){return this._wait}set wait(b){this.setWait(b)}setWait(b,c){if(this._wait&&b)return;if(!b){this.overlay&&(this.overlay.element.remove(),this.overlay=null),this._wait=b,clearTimeout(this.waitTimeout),this.element.classList.remove("wait");return}if(this._waitDelay&&!c){clearTimeout(this.waitTimeout),this.waitTimeout=setTimeout(()=>this.setWait(b,!0),this._waitDelay);return}this._wait=b;let d=new a.Spinner();this.spinnerColor&&(d.color=this.spinnerColor);switch(this.waitSize){case"small":d.borderWidth="2px",d.size=1.7;break;default:d.borderWidth="2px",d.size=3;break}let e=new a.Overlay();e.appendChild(d),this.overlay=e,this.element.classList.add("wait"),this.waitElement.appendChild(e)}}a.WaitControl=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-accordion");b&&b.appendChild(this)}addItem(b,c){let d=new a.AccordionItem(b,c);return this.add(d),d}add(b){super.appendChild(b)}}a.Accordion=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("div","ui-accordionItem");this.header=b,this.body=c,this.headerRow=new a.Control("div","accordionItemHeader",this),this._bodyWrap=new a.Control("div","accordionItemBodyWrap",this),this.header&&this.render()}render(){this.headerRow.clear(),this.bodyWrap.clear();if(!this.body){this.headerRow.appendChild(this.header),this.element.classList.remove("hasChildren");return}this.element.classList.add("hasChildren"),this.arrowWrap=new a.Control("div","arrowIcon");let b=a.getIcon("rightCaret");this.arrowWrap.appendChild(b),this.headerRow.appendChild(this.arrowWrap),this.headerRow.appendChild(this.header),this.bodyElement=new a.Control("div","accordionItemBody",this.bodyWrap),this.bodyElement.appendChild(this.body),this.headerRow.addSignalListener("click",c=>{c.stopPropagation(),this.togle()}),this.bodyWrap.addSignalListener("nodeExpand",()=>this.adjustHeight()),this.bodyWrap.addSignalListener("nodeCollapse",()=>this.adjustHeight())}get bodyWrap(){return this._bodyWrap}set bodyWrap(b){this._bodyWrap=b,this.render()}togle(){this.bodyWrap.element.offsetHeight==0?this.open():this.close()}async open(){this.onExpand&&await this.onExpand(),this.sendSignal("expand");let b=()=>{this.bodyWrap.element.style.height=this.bodyWrap.element.style.height,this.sendSignal("nodeExpand",null,"bubbleUp"),this.element.removeEventListener("transitionend",b)};this.element.addEventListener("transitionend",b),this.adjustHeight(),this.element.classList.add("expanded")}adjustHeight(){this.bodyWrap.element.style.height=this.bodyElement.element.offsetHeight+1+"px"}close(){let b=()=>{this.sendSignal("nodeCollapse",null,"bubbleUp"),this.element.removeEventListener("transitionend",b)};this.element.addEventListener("transitionend",b),this.element.classList.remove("expanded"),this.bodyWrap.element.style.height=""}}a.AccordionItem=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-actionlist")}get actions(){return this._actions||(this._actions=[]),this._actions}set actions(b){this._actions=b,this.render()}select(b){let c=this.actions.findIndex(d=>d.id==b);for(let d=0,e=this.rows.length;d<e;d++){let h=this.rows[d];d==c?h.classList.add("selected"):h.classList.remove("selected")}}render(){this.clear(),this.rows=[];let b=this._actions.any(c=>c.icon);for(let c of this._actions){let d=new a.Control("div","action",this);d.customData=c,this.rows.push(d),c.classList&&a.addClass(d,c.classList),c.separator&&d.element.classList.add("separator");if(b){let e=new a.Control("span","iconPanel",d);c.icon&&e.appendChild(a.getIcon(c.icon,18,18))}new a.Control("span","text",d,c.label),d.addFinalListener("click",()=>{c.click&&c.click()})}}}a.ActionList=i})(ui||(ui={}));var ui;(function(a){function i(h){a.globalAdminMenu=h}a.setGlobalMenu=i;class b extends a.Control{constructor(){super("div","ui-adminview");this.element.setAttribute("fullHeight","true"),this.innerElement=new a.Control("div","innerElement",this),this.topBar=new a.Topbar(),this.innerElement.appendChild(this.topBar),this.topBar.menuIcon.addSignalListener("click",h=>{h.stopPropagation(),this.onMenuIconClick()}),this.body=new a.Control("div","viewBody"),this.innerElement.appendChild(this.body),this.navigation=new a.Navigation(),this.navigation.element.classList.add("mainNav"),this.body.appendChild(this.navigation),this.navigation.addSignalListener("menuItemClick",h=>{h.stopPropagation(),this.onMenuIconClick()}),this._page=new a.Page(),this.body.appendChild(this._page),this.toast=new a.Toast(this.innerElement),this.innerElement.appendChild(this.toast),this.contextBar=new a.ContextBar(),this.innerElement.appendChild(this.contextBar),this.mainMenu=a.globalAdminMenu}get title(){return document.title}set title(h){document.title=h}get page(){return this._page}set page(h){this.replaceChild(h,this._page),this._page=h,h.sendSignal("show",null,"bubbleDown")}get showNavigation(){return!this.navigation.element.style.display}set showNavigation(h){this.navigation.element.style.display=h?"":"none"}get mainMenu(){return this._mainMenu}set mainMenu(h){this._mainMenu=h,this.renderMenu(h)}renderMenu(h){this.navigation.wait=!1;let f=[],g=[];if(!h){this.navigation.clearSelection(),this.navigation.mainSections=[],this.navigation.render();return}let k=h.groupBy(l=>l.parent);for(let l in k){let p=[];g.push({items:p});for(let m of k[l]){let n={name:m.name,parentName:m.parent,label:m.label,icon:m.icon,url:m.url,disabled:m.disabled,click:()=>{m.url&&S.executeAction(m.url),m.func&&m.func()}};f.push(n),p.push(n)}}for(let l of f)if(l.parentName){l.parent=f.first(p=>p.name==l.parentName);if(!l.parent){console.log("Menu parent not found: "+l.parentName);continue}l.parent.children||(l.parent.children=[]),l.parent.children.push(l)}this.navigation.clearSelection(),this.navigation.mainSections=g,this.navigation.render()}showToast(h){this.toast.text=h,this.toast.show()}closeToast(){this.toast.close()}showContextBar(h,f){this.contextBar.show(h,f)}closeContextBar(){this.contextBar.close()}initializeResponsiveNavigation(){let h,f=k=>{h=k.touches.item(0).clientX},g=k=>{k.preventDefault();if(!h)return;let l=h-k.changedTouches.item(0).clientX;l>35&&this.hideResonsiveNavigation()};this.navigation.element.addEventListener("touchstart",f,!1),this.navigation.element.addEventListener("touchmove",g,!1),this.removeListenerFuncs||(this.removeListenerFuncs=[]),this.removeListenerFuncs.push(()=>{this.navigation.element.removeEventListener("touchstart",f),this.navigation.element.removeEventListener("touchmove",g)})}removeListeners(){if(!this.removeListenerFuncs)return;for(let h of this.removeListenerFuncs)h();this.removeListenerFuncs=[]}onMenuIconClick(){if(this.navigation.element.classList.contains("visible")){this.hideResonsiveNavigation();return}this.showResonsiveNavigation()}showResonsiveNavigation(){a.closeAll(),this.navigation.element.classList.add("visible"),S.addRouteChangeAction(()=>this.hideResonsiveNavigation()),this.globalClickFunc=a.addGlobalClick(()=>this.hideResonsiveNavigation(),this.navigation),this.initializeResponsiveNavigation()}hideResonsiveNavigation(){this.globalClickFunc&&(a.removeGlobalClick(this.globalClickFunc),this.globalClickFunc=null),this.navigation.element.classList.remove("visible"),this.removeListeners()}}a.AdminView=b;function c(){let h=a.currentView;if(h instanceof b)return h}a.getAdminViewOrNull=c;function d(){let h=a.currentView;return h instanceof b?h:(h=new b(),a.setView(h),h)}a.getAdminView=d;function e(h){let f,g;a.currentView instanceof b?f=a.currentView:(f=new b(),g=!0),f.page=h,g?a.setView(f):h.sendSignal("show",null,"bubbleDown")}a.setPage=e})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(c){super("div","ui-annotatedlayout",c)}addRow(c,d,e){let h=new b(c,d,e);return this.appendChild(h),h}}a.AnnotatedLayout=i;class b extends a.Control{constructor(c,d,e){super("div","annotatedRow");this.annotation=new a.Control("div","annotation",this),this.title=new a.Control("div","title",this.annotation,i18n.T(c)),this.description=new a.Control("div","description",this.annotation,i18n.T(d)),this.content=new a.Control("div","content",this,e)}}a.AnnotatedRow=b})(ui||(ui={}));var ui;(function(a){class i extends a.ModelControl{constructor(){super("div","ui-audit")}get model(){return this._model}set model(b){this._model=b,this.render(b)}render(b){this.clear();if(b.created){let c=new a.Control("div","row",this);c.textContent=S.parseTime(b.created).format("r")}}}a.Audit=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(){super("div","ui-autocomplete");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.prefixElement=new a.Control("span","prefix",this.inputPanel),this.input=S.createInput("text",null,this.inputPanel.element),this.clearElement=new a.Control("span","clear",this.inputPanel),this.suffixElement=new a.Control("span","suffix",this.inputPanel),this.popup=new a.Popup(),this.appendWindow(this.popup),this.popup.activator=this,this.popup.widthMode="activatorWidth",this.element.addEventListener("focus",()=>this.showPopup()),this.element.addEventListener("keydown",b=>this.onKeydown(b)),this.input.addEventListener("blur",b=>{b.stopPropagation(),!this.selectedOption&&this.input.value&&(this.input.value=null)}),this.input.addEventListener("input",()=>{this.updateClearIcon(),this.onInput()})}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get id(){return this.input.id}set id(b){this.input.id=b}selectOption(b){let c=this.options.findIndex(d=>d.value==b.value);c==-1&&this.options.push(b),this.selectedIndex=this.options.length,this.selectedOption=b,this.input.value=b.label,this.updateClearIcon(),this.sendSignal("input",b)}get text(){return this.input.value}get value(){return this.selectedOption?this.selectedOption.value:null}set value(b){if(!b){this.selectedIndex=null,this.selectedOption=null,this.input.value="",this.updateClearIcon();return}let c=this.options.findIndex(d=>d.value==b);if(c==-1)throw"Option does not exist: "+b;this.selectedIndex=c,this.selectedOption=this.options[c],this.input.value=b,this.updateClearIcon()}get inlineLabel(){return!1}updateClearIcon(){if(!this._clearIcon)return;this.input.value?this.clearElement.element.classList.add("visible"):this.clearElement.element.classList.remove("visible")}get clearIcon(){return this._clearIcon}set clearIcon(b){this._clearIcon=b,this.clearElement.clear();if(b){let c=a.getIcon("critical",20,20);this.clearElement.appendChild(c),this.clearElement.addSignalListener("click",d=>{d.stopPropagation(),this.value=null,this.sendSignal("input")})}}get placeholder(){return this.input.placeholder}set placeholder(b){this.input.placeholder=b}set prefixIcon(b){this.prefixElement.clear(),this.prefixElement.appendChild(a.getIcon(b))}get prefix(){return this.prefixElement.element.textContent}set prefix(b){this.prefixElement.element.textContent=b}get suffix(){return this.suffixElement.element.textContent}set suffix(b){this.suffixElement.element.textContent=b}get options(){return this._options||(this._options=[]),this._options}set options(b){this._options=b}onSelectOption(b){this.doSelectOption(b),this.popup.close()}doSelectOption(b){this.selectedOption=b,this.renderValue(),this.sendSignal("input",b)}renderValue(){this.input.value=this.selectedOption?this.selectedOption.label:""}onKeydown(b){if(!this.popupOptions||this.popupOptions.length==0)return;switch(b.keyCode){case Keys.DOWN:if(this.selectedIndex<this.popupOptions.length-1){this.selectedIndex!=-1&&this.popupOptions[this.selectedIndex].row.element.classList.remove("selected"),this.selectedIndex++;let c=this.popupOptions[this.selectedIndex].row;this.selectRow(c)}break;case Keys.UP:if(this.selectedIndex>0){this.popupOptions[this.selectedIndex].row.element.classList.remove("selected"),this.selectedIndex--;let c=this.popupOptions[this.selectedIndex].row;this.selectRow(c)}break;case Keys.TAB:this.onSelectOption(this.popupOptions[this.selectedIndex].option);break;case Keys.ENTER:this.popup.visible?this.onSelectOption(this.popupOptions[this.selectedIndex].option):this.showPopup();break}}selectRow(b){b.element.classList.add("selected"),b.element.scrollIntoView(!1)}onInput(){this.selectedOption&&(this.selectedOption=null,this.selectedIndex=-1,this.sendSignal("input"));if(this.loadURL){clearTimeout(this.inputTimeout),this.inputTimeout=setTimeout(()=>this.showPopup(),300);return}this.showPopup()}showPopup(){this.refreshPopupList().then(b=>{b?this.popup.show():this.popup.visible&&this.popup.close()})}async refreshPopupList(){let b=new a.Control("div","ui-autocompletePanel");this.popupOptions=[],this.selectedIndex=-1;let c=this.getFilterValue(),d=new RegExp(c,"gi");const e=await this.getOptions();if(e.length==0)return this.popup.clear(),Promise.resolve(!1);for(let h=0,f=e.length;h<f;h++){let g=e[h];if(c&&!d.test(S.removeDiacritics(g.label)))continue;let k=new a.Control("div","row",b,g.label);h==0&&(this.selectedIndex=0,k.element.classList.add("selected")),k.addSignalListener("click",l=>{l.stopPropagation(),this.onSelectOption(g)}),this.popupOptions.push({row:k,option:g})}return this.popupOptions.length==0?(this.popup.clear(),Promise.resolve(!1)):(this.popup.clear(),this.popup.appendChild(b),Promise.resolve(!0))}async getOptions(){if(this.loadURL){if(!this.input.value)return[];let d=S.setUrlValue(this.loadURL,"search",this.input.value);const e=await S.get(d);let h=[];for(let f of e)typeof f=="string"?h.push({label:f,value:f}):h.push(f);return h}if(!this.options)return[];let b=this.getFilterValue(),c=[];if(b){let d=new RegExp(b,"gi");for(let e of this.options)d.test(S.removeDiacritics(e.label))&&c.push(e)}else c=this.options;return c}getFilterValue(){let b=S.removeDiacritics(this.input.value);return b=b.replace(/[^a-zA-Z0-9 -]/,""),b}}a.Autocomplete=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("span","ui-badge",null,c);b&&(this.status=b)}get status(){return this._status}set status(b){this._status=b,this.element.classList.add("status-"+b)}get text(){return this._text}set text(b){this._text=b,this.element.textContent=b}}a.Badge=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c,d){super("div","ui-banner");this.wrap=new a.Control("div","bannerWrap",this),this.iconPanel=new a.Control("div","iconPanel",this.wrap),this.bodyPanel=new a.Control("div","bodyPanel",this.wrap),this.headerPanel=new a.Control("div","headerPanel",this.bodyPanel),this.titlePanel=new a.Control("div","titlePanel",this.headerPanel,c),this.dismissPanel=new a.Control("div","dismissPanel",this.headerPanel),this.contentPanel=new a.Control("div","contentPanel",this.bodyPanel,d),this.actionsPanel=new a.Control("div","actionsPanel",this.bodyPanel),b&&(this.status=b)}get title(){return this.titlePanel.element.textContent}set title(b){this.titlePanel.element.textContent=b}get text(){return this.contentPanel.element.textContent}set text(b){this.contentPanel.element.textContent=b}get action(){return this._action}set action(b){this._action=b,this.actionsPanel.clear();if(b){let c=new a.Button(b.label);b.click&&c.addSignalListener("click",()=>b.click()),this.actionsPanel.appendChild(c)}}get status(){return this._status}set status(b){this._status=b,this.wrap.element.classList.add(b),this.iconPanel.clear();switch(b){case"success":this.iconPanel.appendChild(a.getIcon("success",20,20));break;case"critical":this.iconPanel.appendChild(a.getIcon("critical",20,20));break;case"warning":this.iconPanel.appendChild(a.getIcon("warning",20,20));break;case"info":this.iconPanel.appendChild(a.getIcon("info",20,20));break}}get dismissible(){return this._dismissible}set dismissible(b){this.dismissPanel.clear(),this._dismissible=b;if(b){let c=a.getIcon("close",20,20);this.dismissPanel.appendChild(c),c.addSignalListener("click",()=>this.dismiss())}}dismiss(){this.element.addEventListener("transitionend",()=>this.element.remove());var b=this.element.scrollHeight,c=this.element.style.transition;this.element.style.transition="none",requestAnimationFrame(()=>{this.element.style.height=b+"px",this.element.style.transition=c,requestAnimationFrame(()=>this.element.style.height=0+"px")})}}a.Banner=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c,d){super("button","ui-button");this.left=new a.Control("span",null,this),this.center=new a.Control("span",null,this),this.right=new a.Control("span",null,this),this.waitSize="small",this.settings.text={type:"string",kind:"property"},this.settings.icon={type:"icon",kind:"property"},this.settings.dropdownIcon={type:"icon",kind:"property"},this.settings.dropdown={type:"boolean",kind:"property"},c&&a.addClass(this,c),this.text=b,this.click=d,this.addSignalListener("click",e=>{this.click&&(e.stopPropagation(),typeof this.click==="string"?S.executeAction(this.click):this.click(this))})}get text(){return this.center.textContent}set text(b){this.center.textContent=b}get icon(){return this._icon}set icon(b){this._icon=b;let c=a.getIcon(this._icon);c.classList.add("leftIcon"),this.left.setChild(c)}get dropdownIcon(){return this._dropdownIcon}set dropdownIcon(b){this._dropdownIcon=b,this.dropdown=!0}get dropdown(){return this._dropdown}set dropdown(b){this._dropdown=b,this.right.clear();if(b){let c=a.getIcon(this._dropdownIcon||"downChevron");this.right.appendChild(c)}}get destructive(){return this.element.classList.contains("destructive")}set destructive(b){b?this.element.classList.add("destructive"):this.element.classList.remove("destructive")}get disabled(){return this.element.classList.contains("disabled")}set disabled(b){b?this.element.classList.add("disabled"):this.element.classList.remove("disabled")}get highlighted(){return this.element.classList.contains("highlighted")}set highlighted(b){b?this.element.classList.add("highlighted"):this.element.classList.remove("highlighted")}get plain(){return this.element.classList.contains("plain")}set plain(b){b?this.element.classList.add("plain"):this.element.classList.remove("plain")}get more(){return this.element.classList.contains("more")}set more(b){b?(this.element.classList.add("more"),this.dropdownIcon="more"):(this.element.classList.remove("more"),this.dropdownIcon=null)}get actions(){return this._actions}set actions(b){this._actions=b,this.dropdown===void 0&&(this.dropdown=!0),this.popup=new a.Popup(),this.appendWindow(this.popup),this.popup.activator=this,this.popup.horizontalMode=this.popupHorizontalMode,this.addSignalListener("click",()=>this.togleActions())}get popupHorizontalMode(){return this._popupHorizontalMode}set popupHorizontalMode(b){this._popupHorizontalMode=b,this.popup&&(this.popup.horizontalMode=b)}togleActions(){if(this.popup.element.childElementCount==0){let b=new a.ActionList();b.actions=this._actions.select(c=>({label:c.label,icon:c.icon,id:c.id,click:()=>{this.popup.close(),c.click()}})),this.popup.appendChild(b)}this.popup.togle()}}a.Button=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("div","ui-buttongroup",c);b&&(this.segmented=!0)}get right(){return this.element.classList.contains("right")}set right(b){b?this.element.classList.add("right"):this.element.classList.remove("right")}get segmented(){return this.element.classList.contains("segmented")}set segmented(b){b?this.element.classList.add("segmented"):this.element.classList.remove("segmented")}}a.ButtonGroup=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b){super("div","ui-card",b)}}a.Card=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(b){super("div","ui-checkbox");this._inlineLabel=!0,this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.input=S.createInput("checkbox",null,this.inputPanel.element),this.input.addEventListener("click",c=>this.onCheckClick(c)),this.label=new a.Control("span","label",this.inputPanel,b),this.label.element.addEventListener("click",c=>this.onLabelClick(c))}get checked(){return this.input.checked}set checked(b){this.input.checked=b}get inlineLabel(){return this._inlineLabel}set inlineLabel(b){this._inlineLabel=b}get value(){return this.input.checked}set value(b){this.input.checked=b}get text(){return this.label.element.textContent}set text(b){this.label.element.textContent=i18n.T(b)}onCheckClick(b){b.stopPropagation(),this.sendSignal("input")}onLabelClick(b){b.preventDefault(),b.stopPropagation(),this.input.checked=!this.input.checked,this.sendSignal("input")}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}}a.Checkbox=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("div","ui-choicelist",c);this.titlePanel=S.create("div","title",this.element),this.choicesPanel=S.create("div","choices",this.element),this._values=[],this._selectedChoices=[],this.multiple=b}get values(){return this._values}set values(b){this._values=b;if(this.inputs)for(let c of this.inputs)c.checked=b.contains(c.value)}get selectedChoices(){return this._selectedChoices}set selectedChoices(b){this._selectedChoices=b;if(this.inputs){let c=b.select(d=>d.value);for(let d of this.inputs)d.checked=c.contains(d.value)}}get value(){return this._value}set value(b){this._value=b;if(this.inputs)for(let c of this.inputs)c.checked=c.value==b}get title(){return this.titlePanel.textContent}set title(b){this.titlePanel.textContent=b}get multiple(){return this._multiple}set multiple(b){this._multiple=b,this.render()}get choices(){return this._choices}set choices(b){this._choices=b,this.render()}render(){S.clear(this.choicesPanel),this.inputs=[];if(!this.choices)return;for(let b of this.choices){let c=S.create("div","row",this.choicesPanel),d=S.createInput(this._multiple?"checkbox":"radio",null,c);d.value=b.value,this.inputs.push(d),this.value==b.value?d.checked=!0:this.values&&this.values.contains(b.value)?d.checked=!0:this.selectedChoices&&this.selectedChoices.any(h=>h.value==b.value)&&(d.checked=!0),d.addEventListener("input",h=>{h.stopPropagation(),this.onChoiceClick(b,d.checked)});let e=S.create("span","label",c,b.label);e.addEventListener("click",()=>{d.checked=!d.checked,this.onChoiceClick(b,d.checked)});if(b.description){let h=S.create("div","description",this.choicesPanel,b.description);h.addEventListener("click",()=>{d.checked=!d.checked,this.onChoiceClick(b,d.checked)})}}}onChoiceClick(b,c){this.multiple?c?this.addSelectedChoice(b):this.removeSelectedChoice(b):(this.value=b.value,this.selectedChoice=b),this.sendSignal("input",{detail:{choice:b,selected:c,values:this.values}})}addSelectedChoice(b){this.values.contains(b.value)||this.values.push(b.value),this._selectedChoices.any(c=>c.value==b.value)||this._selectedChoices.push(b)}removeSelectedChoice(b){this.values.contains(b.value)&&this.values.remove(b.value);let c=this._selectedChoices.findIndex(d=>d.value==b.value);c!=-1&&this._selectedChoices.removeAt(c)}clearSelection(){for(let b of this.inputs)b.checked=!1;this.selectedChoice=null,this.selectedChoices=[]}}a.ChoiceList=i})(ui||(ui={}));var ui;(function(a){S.Window.require||(S.Window.require={paths:{vs:"/assets/vendor/vs"}});class i extends a.InputControl{constructor(b,c){super("div","ui-codeEditor");this.inlineLabel=!1,b&&b.appendChild(this),this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.initialize(c)}initialize(b){S.loadFiles({urls:["/assets/vendor/vs/loader.js","/assets/vendor/vs/editor/editor.main.nls.js","/assets/vendor/vs/editor/editor.main.js"]}).then(()=>{S.Window.require(["vs/editor/editor.main"],()=>{monaco.languages.typescript.typescriptDefaults.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.ESNext,noLib:!0,noEmit:!0,noImplicitAny:!0,allowNonTsExtensions:!0}),this.editor=monaco.editor.create(this.inputPanel.element,{automaticLayout:!0,fontSize:13,fontFamily:"Courier New",scrollBeyondLastLine:!1,minimap:{enabled:!1}}),this._value&&(this.value=this._value),b&&b(this)})})}format(){this.editor.getAction("editor.action.formatDocument").run()}addLib(b){monaco.languages.typescript.typescriptDefaults.addExtraLib(b)}setModel(b,c){let d=monaco.editor.createModel(b,c);this.editor.setModel(d)}focus(){this.editor.focus()}get language(){return this._language}set language(b){this._language=b,this.editor&&monaco.editor.setModelLanguage(this.editor.getModel(),b)}addNativeLib(){S.get("//playground/native.d.ts").then(b=>{monaco.languages.typescript.typescriptDefaults.addExtraLib(b)})}get value(){return this.editor?this.editor.getValue():this._value}set value(b){if(this.editor){let c=monaco.editor.createModel(b,this.language||"typescript");this.editor.setModel(c),this._value=null}this._value=b}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}}a.CodeEditor=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(b){super("div","ui-colorbutton");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.previewElement=new a.Control("span","preview",this.inputPanel),this.labelElement=S.create("span","label",this.inputPanel.element,b),this.popup=new a.Popup(),this.appendWindow(this.popup),this.popup.activator=this.previewElement,this.popup.element.style.padding="1rem",this.popup.transitionEnd=()=>{this.popup.visible&&this.list.refresh()},this.list=new a.ColorList(),this.list.addSignalListener("input",c=>{let d=c.data;this._value=d,this.previewElement.element.style.backgroundColor=d,this.sendSignal("input",d)}),this.popup.appendChild(this.list),this.previewElement.element.tabIndex=0,this.previewElement.element.addEventListener("keydown",c=>this.onKeydown(c)),this.addSignalListener("click",c=>{c.stopPropagation(),this.popup.togle()})}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get text(){return this.labelElement.textContent}set text(b){this.labelElement.textContent=b}get inlineLabel(){return!0}get value(){return this._value}set value(b){this._value=b,this.previewElement.element.style.backgroundColor=b,this.list.value=b}onKeydown(b){switch(b.keyCode){case Keys.ENTER:this.popup.togle();break}}}a.ColorButton=i})(ui||(ui={}));var ui;(function(a){const i=8;class b extends a.Control{constructor(){super("div","ui-colorlist");this.element.addEventListener("click",g=>{g.stopPropagation()}),this.build(),this.hsv={h:0,s:1,v:1,a:1},this.setColor(this.hsv),d("rgba(255, 0, 0, 1)")}get value(){return e(this.hsv)}set value(g){g.hasPrefix("#")?this.hsv=c(g):g.hasPrefix("rgb")?this.hsv=d(g):this.hsv={h:0,s:1,v:1,a:1},this.setColor(this.hsv)}build(){this.clear(),this.picker=S.create("div","picker",this.element);var g=document.createElementNS("http://www.w3.org/2000/svg","svg");this.picker.appendChild(g),g.setAttribute("width","100%"),g.setAttribute("height","100%"),g.innerHTML=`<defs><linearGradient id="gradient-v0" x1="0" y1="0" x2="100%" y2="0"><stop offset="0%" stop-color="#fff" stop-opacity="1"></stop><stop offset="100%" stop-color="#fff" stop-opacity="0"></stop></linearGradient><linearGradient id="gradient-v1" x1="0" y1="0" x2="0" y2="100%"><stop offset="0%" stop-color="#000" stop-opacity="0"></stop><stop offset="100%" stop-color="#000" stop-opacity="1"></stop></linearGradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-v0)"></rect><rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-v1)"></rect>`,this.pickerHandle=S.create("div","handle",this.picker),this.pickerHandle.addEventListener("mousedown",n=>this.onMouseDown(n,"picker")),this.picker.addEventListener("mousedown",n=>this.onPickerMousedown(n)),this.hueBar=S.create("div","slidebar",this.element);var k=document.createElementNS("http://www.w3.org/2000/svg","svg");this.hueBar.appendChild(k),k.setAttribute("width","100%"),k.setAttribute("height","100%"),k.innerHTML=`<defs><linearGradient id="gradient-hsv-0" x1="0" y1="0" x2="100%" y2="0"><stop offset="0%" stop-color="#FF0000" stop-opacity="1"></stop><stop offset="13%" stop-color="#FF00FF" stop-opacity="1"></stop><stop offset="25%" stop-color="#8000FF" stop-opacity="1"></stop><stop offset="38%" stop-color="#0040FF" stop-opacity="1"></stop><stop offset="50%" stop-color="#00FFFF" stop-opacity="1"></stop><stop offset="63%" stop-color="#00FF40" stop-opacity="1"></stop><stop offset="75%" stop-color="#0BED00" stop-opacity="1"></stop><stop offset="88%" stop-color="#FFFF00" stop-opacity="1"></stop><stop offset="100%" stop-color="#FF0000" stop-opacity="1"></stop></linearGradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-hsv-0)"></rect>`,this.hueHandle=S.create("div","handle",this.hueBar),this.hueHandle.addEventListener("mousedown",n=>this.onMouseDown(n,"hue")),this.hueBar.addEventListener("mousedown",n=>this.onHueMousedown(n));let l=S.create("div","sliderWrap transparent",this.element);this.alphaBar=S.create("div","slideInner",l);var p=document.createElementNS("http://www.w3.org/2000/svg","svg");this.alphaBar.appendChild(p),p.setAttribute("width","100%"),p.setAttribute("height","100%"),p.innerHTML=`<defs><linearGradient id="gradient-alpha-0" x1="0%" y1="0" x2="100%" y2="0"><stop offset="0%" stop-color="#000" stop-opacity="0"></stop><stop offset="100%" stop-color="#000" stop-opacity="1"></stop></linearGradient></defs><rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-alpha-0)"></rect>`,this.alphaHandle=S.create("div","handle",this.alphaBar),this.alphaHandle.addEventListener("mousedown",n=>this.onMouseDown(n,"alpha")),this.alphaBar.addEventListener("mousedown",n=>this.onAlphaMousedown(n));let m=S.create("div","previewRow",this.element);l=S.create("div","previewWrap transparent",m),this.preview=S.create("div","preview",l),this.txtInput=new a.TextInput(),this.txtInput.input.readOnly=!0,m.appendChild(this.txtInput.element)}onMouseDown(g,k){g.preventDefault(),g.stopPropagation(),this.dragging=!0,this.dragType=k;let l=m=>{if(m.buttons==0){p(m);return}this.onMouseMove(m)},p=m=>{m.preventDefault(),m.stopPropagation(),this.dragging=!1,this.dragType=null,window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",p)};window.addEventListener("mouseup",p),window.addEventListener("mousemove",l)}getCoords(g,k){var l=k.getBoundingClientRect(),p=g.x-l.left;p<0?p=0:p>l.width&&(p=l.width);var m=g.y-l.top;m<-1?m=-1:m>l.height&&(m=l.height);let n=this.getPercent(p,l.width),j=this.getPercent(m,l.height);return{x:n,y:j,left:p,top:m,width:l.width,height:l.height}}getPercent(g,k){let l=g/k;return l<0?l=0:l>100&&(l=100),l}onPickerMousedown(g){this.setValueCoords(g),this.onMouseDown(g,"picker")}onHueMousedown(g){this.setHueCoords(g),this.onMouseDown(g,"hue")}onAlphaMousedown(g){this.setAlphaCoords(g),this.onMouseDown(g,"alpha")}setValueCoords(g){var k=this.getCoords(g,this.picker);this.pickerHandle.style.left=k.left-i+"px",this.pickerHandle.style.top=k.top-i+"px",this.hsv.s=k.x,this.hsv.v=1-k.y,this.refreshPreviewColor()}setHueCoords(g){var k=this.getCoords(g,this.hueBar);this.hueHandle.style.left=k.left-i+"px",this.hsv.h=(1-k.x)*360,this.refreshPickerColor(),this.refreshPreviewColor()}setAlphaCoords(g){var k=this.getCoords(g,this.hueBar);this.alphaHandle.style.left=k.left-i+"px",this.hsv.a=S.round(k.x,2),this.refreshPreviewColor()}setColor(g){this.hsv=g,this.refresh()}refresh(){let g=this.picker.getBoundingClientRect();this.pickerHandle.style.left=this.hsv.s*g.width-i+"px",this.pickerHandle.style.top=(1-this.hsv.v)*g.height-i+"px",g=this.hueBar.getBoundingClientRect(),this.hueHandle.style.left=(1-this.hsv.h)/360-i+"px",g=this.hueBar.getBoundingClientRect();let k=this.hsv.h==0?359:this.hsv.h,l=g.width-k/360;this.hueHandle.style.left=l-i+"px",g=this.alphaBar.getBoundingClientRect(),this.alphaHandle.style.left=this.hsv.a*g.width-i+"px",this.refreshPickerColor(),this.refreshPreviewColor()}onMouseMove(g){g.preventDefault(),g.stopPropagation();if(!this.dragging)return;switch(this.dragType){case"picker":this.setValueCoords(g);break;case"hue":this.setHueCoords(g);break;case"alpha":this.setAlphaCoords(g);break}this.fireInputEvent()}refreshPickerColor(){let g={h:this.hsv.h,s:1,v:1,a:1};this.picker.style.backgroundColor=e(g)}refreshPreviewColor(){let g=e(this.hsv);this.preview.style.backgroundColor=g,this.txtInput.value=g}fireInputEvent(){let g=e(this.hsv);this.sendSignal("input",g)}}a.ColorList=b;function c(g){switch(g.length){case 4:var k=parseInt(g.substr(1,1)+g.substr(1,1),16),l=parseInt(g.substr(2,2)+g.substr(2,2),16),p=parseInt(g.substr(3,3)+g.substr(3,3),16);return f({r:k,g:l,b:p,a:1});case 7:var k=parseInt(g.substr(1,2),16),l=parseInt(g.substr(3,2),16),p=parseInt(g.substr(5,2),16);return f({r:k,g:l,b:p,a:1});case 9:var k=parseInt(g.substr(1,2),16),l=parseInt(g.substr(3,2),16),p=parseInt(g.substr(5,2),16),m=parseInt(g.substr(7,2),16)/100;return f({r:k,g:l,b:p,a:m});default:throw"Invalid hex value: "+g}}function d(g){let k=/rgb\((\d+),\s*(\d+),\s*(\d+\.{0,1}\d*)\)/,l=k.exec(g);if(l){var p=parseInt(l[1],10),m=parseInt(l[2],10),n=parseInt(l[3],10);return f({r:p,g:m,b:n,a:1})}k=/rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d+\.{0,1}\d*)\)/,l=k.exec(g);if(l){var p=parseInt(l[1],10),m=parseInt(l[2],10),n=parseInt(l[3],10),j=parseFloat(l[4]);return f({r:p,g:m,b:n,a:j})}throw"Invalid RGB value: "+g}function e(g){let k=h(g);return`rgba(${k.r}, ${k.g}, ${k.b}, ${g.a})`}function h(g){var k,l,p,m,n,j=g.h%360/60;n=g.v*g.s,m=n*(1-Math.abs(j%2-1)),k=l=p=g.v-n,j=~~j,k+=[n,m,0,0,m,n][j],l+=[m,n,n,m,0,0][j],p+=[0,0,m,n,n,m][j];var o=Math.floor(k*255),q=Math.floor(l*255),s=Math.floor(p*255);return{r:o,g:q,b:s,a:g.a}}function f(g){var k=g.r,l=g.g,p=g.b;(g.r>1||g.g>1||g.b>1)&&(k/=255,l/=255,p/=255);var m,n,j,o;return j=Math.max(k,l,p),o=j-Math.min(k,l,p),m=o==0?null:j==k?(l-p)/o+(l<p?6:0):j==l?(p-k)/o+2:(k-l)/o+4,m=m%6*60,n=o==0?0:o/j,{h:m,s:n,v:j,a:g.a}}})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(){super("div","ui-colorpicker");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.previewElement=S.create("span","preview",this.inputPanel.element),this.labelElement=S.create("span","label",this.inputPanel.element);let b=a.getIconElement("downChevron",20,20);this.inputPanel.element.appendChild(b),this.popup=new a.Popup(),this.appendWindow(this.popup),this.popup.activator=this,this.popup.element.style.padding="1rem",this.popup.transitionEnd=()=>{this.popup.visible&&this.list.refresh()},this.list=new a.ColorList(),this.list.addSignalListener("input",c=>{let d=c.data;this._value=d,this.previewElement.style.backgroundColor=d,this.labelElement.textContent=d,this.sendSignal("input",d)}),this.popup.appendChild(this.list),this.element.tabIndex=0,this.element.addEventListener("keydown",c=>this.onKeydown(c)),this.addSignalListener("click",c=>{c.stopPropagation(),this.popup.togle()}),this.focusVisible=!0,this.element.tabIndex=0,this.element.addEventListener("focus",c=>this.onFocus(c)),this.element.addEventListener("blur",c=>this.onBlur(c))}onFocus(b){this.focusVisible&&this.inputPanel.classList.add("focused")}onBlur(b){this.focusVisible&&this.inputPanel.classList.remove("focused")}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get inlineLabel(){return!1}get value(){return this._value}set value(b){this._value=b,this.previewElement.style.backgroundColor=b,this.labelElement.textContent=b,this.list.value=b}onKeydown(b){switch(b.keyCode){case Keys.ENTER:this.popup.togle();break}}}a.ColorPicker=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-contextbar");this.titlePanel=new a.Control("div","title",this,i18n.T("@@Unsaved changes")),this.actionsPanel=new a.Control("div","actions",this);let b=new a.Button(i18n.T("@@Discard"));this.cancelButton=b,this.actionsPanel.appendChild(b),b.addFinalListener("click",d=>{this.onDiscard&&this.onDiscard(),this.close()});let c=new a.Button(i18n.T("@@Save"));c.highlighted=!0,this.saveButton=c,this.actionsPanel.appendChild(c),c.addFinalListener("click",async()=>{c.wait=!0;try{let d=await this.onSave();d&&this.close()}finally{c.wait=!1}})}show(b,c){if(this.element.classList.contains("visible"))return;b&&(this.onSave=b),c?(this.onDiscard=c,this.cancelButton.style.display=""):this.cancelButton.style.display="none",this.element.classList.add("visible"),a.addCloser(this)}close(){this.element.classList.remove("visible"),this.saveButton.wait=!1}get title(){return this.titlePanel.element.textContent}set title(b){this.titlePanel.element.textContent=b}}a.ContextBar=i})(ui||(ui={}));var ui;(function(a){class i extends a.Input{constructor(){super("input","ui-datepicker");this.suffixIcon="calendar",this.suffixElement.addFinalListener("click",()=>this.showCalendar())}onInput(b){b.stopPropagation();let c=this.input.value;if(!c){this._value=null,this.showError(null),this.updateClearIcon(),this.sendSignal("input");return}try{let d=S.parseTime(c);this._value=d,this.showError(null),this.updateClearIcon(),this.sendSignal("input")}catch(d){this.showError(i18n.T("invalid date"))}}showCalendar(){let b=new a.MonthCalendar(this.value);b.classList.add("datepickerCalendar"),b.selectedDate=this.value||S.now();let c=new a.Modal();c.width="",c.titlePanel.textContent=b.selectedDate.format("D"),c.dismissPanel.remove(),c.footerRight.appendChild(new a.Button(i18n.T("@@Cancel"),"plain",()=>c.close())),c.footerRight.appendChild(new a.Button(i18n.T("@@Accept"),"highlighted",()=>{c.close(),this.selectDate(b.selectedDate)})),c.contentPanel.appendChild(b),b.addFinalListener("input",d=>{c.close(),this.selectDate(d.data)}),c.show()}selectDate(b){this.value=b,this.sendSignal("input",b)}get value(){return this._value}set value(b){if(typeof b==="string")this._value=S.parseTime(b);else if(b instanceof S.Time)this._value=b;else if(!b)this._value=null;else throw"invalid date "+b;this._value?this.input.value=this._value.format("d"):this.input.value=""}}a.DatePicker=i})(ui||(ui={}));var ui;(function(a){class i extends a.Input{constructor(){super("datetime-local");this.element.addEventListener("keydown",b=>this.onKeydown(b))}onKeydown(b){b.keyCode==Keys.ENTER&&this.sendSignal("submit")}get value(){return this.input.value}set value(b){if(typeof b==="string"){let c=S.parseTime(b);b=c.nativeDate.getTime()}this.input.valueAsNumber=b}}a.DateTimeInput=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-emptystate");this.titlePanel=new a.Control("div","titlePanel",this),this.textPanel=new a.Control("div","textPanel",this,b),this.actionsPanel=new a.Control("div","ActionsPanel",this)}set icon(b){let c=a.getIcon(b,90,90);c.element.classList.add("emptyStateIcon"),this.appendChild(c)}set image(b){this.imageElement=new a.Img(null,this),this.imageElement.src=b}get title(){return this.titlePanel.element.textContent}set title(b){this.titlePanel.element.textContent=b}get text(){return this.textPanel.element.textContent}set text(b){this.textPanel.element.textContent=b}set action(b){this.actionsPanel.clear(),this.actionsPanel.appendChild(b)}}a.EmptyState=i})(ui||(ui={}));var ui;(function(a){const i=i18n.T("@@or drop a file to upload");class b extends a.InputControl{constructor(){super("div","ui-filedrop");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.input=S.createInput("file","inputFile",this.inputPanel.element),this.input.onclick=f=>f.stopPropagation(),this.input.addEventListener("input",f=>this.onFilePicked()),this.addDropEvents(this.element);let c=a.getIcon("arrowUp",37,37),d=new a.Control("span","iconWrap",this.inputPanel,c),e=new a.Control("div","row",this.inputPanel,d);this.addDropEvents(e.element);let h=new a.Button(i18n.T("@@Add file"));h.click=()=>this.input.click(),this.inputPanel.appendChild(h),e=new a.Control("div","row",this.inputPanel,h),this.addDropEvents(e.element),this.subtitleRow=new a.Control("div","row subtitle",this.inputPanel,i),this.addDropEvents(this.subtitleRow.element)}get value(){return this._value}set value(c){this._value=c}showError(c){this.errorPanel.clear();if(!c){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=c}addDropEvents(c){c.addEventListener("dragover",d=>this.onDragover(d)),c.addEventListener("dragenter",d=>this.onDragenter(d)),c.addEventListener("dragleave",d=>this.onDragleave(d)),c.addEventListener("drop",d=>this.onDrop(d))}get inlineLabel(){return!1}onDragover(c){c.preventDefault(),c.stopPropagation()}onDragenter(c){c.preventDefault(),c.stopPropagation(),this.element.classList.add("dragover")}onDragleave(c){c.preventDefault(),c.stopPropagation(),this.element.classList.remove("dragover")}onDrop(c){c.preventDefault(),c.stopPropagation(),this.element.classList.remove("dragover"),this.onFileSelected(c.dataTransfer.files[0]),c.dataTransfer.clearData()}onFilePicked(){this.onFileSelected(this.input.files[0]),this.input.files=null}onFileSelected(c){this.value=c,this.subtitleRow.element.textContent=i18n.T("@@Selected %v",c.name);let d=a.getIcon("close");d.classList.add("removeFile"),d.addSignalListener("click",e=>{e.stopPropagation(),this.subtitleRow.element.textContent=i,this.value=null,this.input.files=null,this.sendSignal("input")}),this.subtitleRow.appendChild(d),this.sendSignal("input",c)}}a.Filedrop=b})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(){super("div","ui-filepicker");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this);let b=new a.Button(i18n.T("@@Choose file"),null,()=>this.input.click());this.inputPanel.appendChild(b),this.label=new a.Text(),this.inputPanel.appendChild(this.label),this.clearIcon=a.getIcon("close"),this.inputPanel.appendChild(this.clearIcon),this.clearIcon.addFinalListener("click",()=>this.clearFiles()),this.input=S.createInput("file","inputFile",this.inputPanel.element),this.input.onclick=c=>c.stopPropagation(),this.input.addEventListener("input",c=>this.onFilePicked())}get value(){return this._value}set value(b){this._value=b}get values(){return this._values}set values(b){this._values=b}get multiple(){return this.input.multiple}set multiple(b){this.input.multiple=b}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get inlineLabel(){return!1}onFilePicked(){this.onFileSelected(this.input.files),this.input.files=null}clearFiles(){this.value=null,this.input.files=null,this.label.clear(),this.clearIcon.style.display="none",this.sendSignal("input")}onFileSelected(b){this.clearIcon.style.display="flex";if(this.multiple){let c=[];for(let d=0,e=b.length;d<e;d++){let h=b[d];c.push(h.name)}this.label.textContent=c.join(", "),this._values=b,this.sendSignal("input",b)}else this.value=b[0],this.label.textContent=this.value.name,this.sendSignal("input",this.value)}}a.Filepicker=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-filter",b);this.filtersRow=new a.Control("div","filtersRow",this),this.buttonGroup=new a.ButtonGroup(!0),this.filtersRow.appendChild(this.buttonGroup),this.tagsStack=new a.Stack(),this.appendChild(this.tagsStack),this._showSearch=!0,this._filters=[],this._promotedFilters=[],this._values={search:null,properties:{}},this.resizeFunc=()=>this.onResize(),window.addEventListener("resize",this.resizeFunc),S.addRouteChangeAction(()=>this.removeListeners()),this.addSignalListener("show",()=>{if(this.displayed)return;this.displayed=!0,this.render(),this.refreshPromotedButtons()})}appendTagsRowTo(b){b.appendChild(this.tagsStack)}get values(){return this._values?this._values.properties||(this._values.properties={}):this._values={search:null,properties:{}},this._values}set values(b){this._values=b,this.render()}removeListeners(){this.resizeFunc&&(window.removeEventListener("resize",this.resizeFunc),this.resizeFunc=null)}onResize(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.refreshPromotedButtons()},50)}refreshPromotedButtons(){if(!this.filterButtons)return;const b=this.element.offsetWidth-230;let c=0;for(let d of this.filterButtons){if(c>b){d.element.style.display="none";continue}d.element.style.display="",c+=d.element.offsetWidth}}get placeholder(){return this._placeholder}set placeholder(b){this._placeholder=b}get showSearch(){return this._showSearch}set showSearch(b){this._showSearch=b}get query(){return this._query}set query(b){this._query=b}get promotedFilters(){return this._promotedFilters}set promotedFilters(b){this._promotedFilters=b}get filters(){return this._filters}set filters(b){this._filters=b}get allFilters(){return this._filters.concat(this._promotedFilters)}render(){this.clear();if(this._showSearch){let c=new a.TextInput();c.element.classList.add("queryFilter"),c.prefixIcon="search",c.clearIcon=!0,this.placeholder&&(c.placeholder=this.placeholder),c.addSignalListener("input",d=>{this.values.search=c.value;let e=!d.data?.clearIcon;this.onChange(e)}),this.values.search&&(c.value=this.values.search),this.buttonGroup.appendChild(c)}this.filterButtons=[];for(let c of this.promotedFilters){let d=new a.Button(i18n.T(c.label||c.name));d.dropdown=!0,d.addSignalListener("click",()=>this.showFilter(d,c)),this.buttonGroup.appendChild(d),this.filterButtons.push(d)}let b=this.values.properties;for(let c in b){let d=this.allFilters.first(e=>e.name==c);if(d){let e=b[c];this.setTag(d,e)}}}showFilter(b,c){let d=new a.Popup();this.appendWindow(d);let e=this.buildFilterPanel(c,d);e.element.classList.add("ui-filter-panel"),d.appendChild(e),d.show(b)}buildFilterPanel(b,c){let d=new a.Card(),e=this.values.properties[b.name];switch(b.type){case"picklist":let f=new a.ChoiceList();f.multiple=!0,f.choices=b.items,e&&Array.isArray(e)&&(f.selectedChoices=e),f.render(),f.addSignalListener("input",()=>this.onPicklistChange(b,f)),d.appendChild(f);break;case"int":case"decimal":case"currency":var h=new a.Form();d.appendChild(h),h.addFields({name:"min",type:b.type,label:"@@Min",nullable:!0},{name:"max",type:b.type,label:"@@Max",nullable:!0}),e&&(h.model=e),h.addSignalListener("input",l=>{this.onFilterChange(b,h.model,!0)});break;case"date":case"datetime":case"time":let g=new a.PeriodPanel();e&&(g.value=e),g.addSignalListener("input",()=>{this.onFilterChange(b,g.value,!1),g.value.range&&c.close()}),d.appendChild(g);break;default:var h=new a.Form();d.appendChild(h);let k=new a.TextInput();e&&(k.value=e),h.addRow(k),h.focus(),k.addSignalListener("input",()=>this.onFilterChange(b,k.value,!0));break}return d}onFilterChange(b,c,d){if(!c){this.clearFilter(b);return}this.addFilter(b,c,d)}onPicklistChange(b,c){let d=c.selectedChoices;if(!d||d.length==0){this.clearFilter(b);return}this.addFilter(b,d,!1)}addFilter(b,c,d){this.values.properties[b.name]=c,this.setTag(b,c),this.onChange(d)}clearFilter(b){delete this.values.properties[b.name],this.removeTag(b),this.onChange(!1)}setTag(b,c){let d=this.tagsStack.getById(b.name);d||(d=new a.Tag(),d.id=b.name,d.closeAction=()=>this.clearFilter(b),this.tagsStack.appendChild(d));let e;switch(b.type){case"picklist":e=i18n.T(b.label||b.name)+" "+c.select(f=>f.label).join(", ");break;case"int":case"decimal":case"currency":e=i18n.T(b.label||b.name)+" ";var h=c;h.min!=null&&h.max!=null?e+=i18n.T("@@between %v and %v",h.min,h.max):h.min!=null?e+=S.fmt(" >= %v",h.min):h.max!=null&&(e+=S.fmt(" <=  %v",h.max));break;case"date":case"datetime":c.start&&(c.start=S.parseTime(c.start)),c.end&&(c.end=S.parseTime(c.end)),e=i18n.T(b.label||b.name)+" "+S.toPeriodString(c);break;case"time":e=i18n.T(b.label||b.name)+" ";var h=c;h.min!=null&&h.max!=null?e+=i18n.T("@@between %v and %v",h.min,h.max):h.min!=null?e+=S.fmt(" >= %v",h.min):h.max!=null&&(e+=S.fmt(" <=  %v",h.max));break;default:e=i18n.T(b.label||b.name)+" "+c;break}d.text=e,d.render()}removeTag(b){let c=this.tagsStack.getById(b.name);c&&c.remove()}onMoreFiltersClick(){}onChange(b){b?(clearTimeout(this.changeTimeout),this.changeTimeout=setTimeout(()=>this.fireChangeEvent(),300)):this.fireChangeEvent()}fireChangeEvent(){clearTimeout(this.changeTimeout),this.sendSignal("filterChange",this.values)}clear(){this.buttonGroup.clear(),this.tagsStack.clear()}}a.Filter=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c){super("div","ui-flexPanel");b&&S.addClass(this.element,b),c&&c.appendChild(this),this.addSettings({children:{type:"controlList",kind:"property"},gap:{type:"string",kind:"style"},flexDirection:{type:"string",kind:"style"}})}}a.FlexPanel=i})(ui||(ui={}));var ui;(function(a){function i(d){let e;for(let h of d.children){if(h instanceof c){let f=h.validate();f||(e=!0);continue}i(h)||(e=!0)}return!e}a.validate=i;function b(d){for(let e of d.children){if(e instanceof c)return e.focus(),!0;if(b(e))return!0}}a.focus=b;class c extends a.Control{constructor(d){super("div","ui-form");d&&d.appendChild(this),this.errorPanel=new a.Control("div","errorPanel",this),this.contentPanel=new a.Panel(null,this),this.contentPanel.classList.add("contentPanel"),this.buttonsPanel=new a.ButtonGroup(!1,this),this.buttonsPanel.classList.add("buttonsPanel"),this.addSignalListener("input",e=>this.onInput(e)),this.addSignalListener("submit",()=>this.submit()),this.addSignalListener("show",()=>{if(this.displayed)return;this.displayed=!0})}addValidation(d){this.validations||(this.validations=[]),this.validations.push(d)}addButton(d){this.buttonsPanel.appendChild(d)}addSubmitButton(d,e,h){d||(d="@@Save");let f=new a.Button(i18n.T(d),"highlighted");return this.buttonsPanel.appendChild(f),this.submitButton=f,e&&(this.URL=e),h&&(this.sendSuccess=h),f}onInput(d){let e=d.source,h=e.property,f=h?h.name:e.id;this.model[f]=e.value,this.useSaveContextBar&&this.showAsDirty()}showAsDirty(){let d=a.getAdminViewOrNull();d&&d.showContextBar(()=>this.submit())}get submitButton(){return this._submitButton}set submitButton(d){this._submitButton=d,d.addSignalListener("click",()=>this.submit())}get model(){return this._model||(this._model={}),this._model}set model(d){this._model=d,this.refresh()}setContainer(d){return this.container=d,d}addContainer(d){this.container=d,this.contentPanel.appendChild(d)}endContainer(){this.container=null}addFields(...d){let e=new a.Control("div","formRow",this.container||this.contentPanel);for(let h of d){let f=a.getControl(h),g=new a.FormCell(void 0,f);e.appendChild(g)}return e}addRow(...d){let e=new a.Control("div","formRow",this.container||this.contentPanel);for(let h of d)e.appendChild(h);return e}addCells(...d){let e=new a.Control("div","formRow",this.container||this.contentPanel);for(let h of d)e.appendChild(h);return e}focus(){if(!this.displayed){let e=()=>{this.focus(),this.removeSignalListener(e)};this.addSignalListener("show",e);return}let d=this.element.querySelector("input[type='text'], textarea, input[type='password']");d&&requestAnimationFrame(()=>d.focus())}refresh(){let d=this._model||{};for(let e of this.getDescendants()){if(e instanceof a.InputControl){let h=e.property,f=h?h.name:e.id;if(!f)continue;let g=d[f];if(h)switch(e.property.type){case"hash":case"encrypted":g=orm.PASSWORD_MASK;break;case"lookup":if(e instanceof a.Select){if(g){let k=orm.getRefDesc(h),l=d[k];e.selectOption({value:g,label:l})}continue}break}g===void 0&&(g=null),e.value=g;continue}if(e instanceof a.ModelControl){e.model=d;continue}}}async submit(){if(!this.URL)return!1;let d=this.model;if(this.preValidate){let h=this.preValidate(d);h&&(d=h)}if(!this.validate())return!1;let e=this.method||"POST";this.submitButton&&(this.submitButton.wait=!0);try{this.submitButton&&(this.submitButton.wait=!0);let h;return typeof this.URL==="string"?h=await S.request(e,this.URL,d):h=await this.URL(d),S.setDirty(!1),this.sendSuccess&&(typeof this.sendSuccess==="string"?S.executeAction(this.sendSuccess,null,h):this.sendSuccess(h)),this.submitButton&&(this.submitButton.wait=!1),!0}catch(h){this.submitButton&&(this.submitButton.wait=!1);let f=S.getErrorMessage(h);return this.showError(f),!1}}validate(){let d,e=[];if(this.validations)for(let h of this.validations){let f=h();f&&e.push(f)}for(let h of this.getDescendants())if(h instanceof a.InputControl){let f=h.validate();f&&(d=!0)}return this.errorPanel.clear(),e.length>0?(this.showError(e.join(`
`)),!1):d?(this.reviewErrorsMessage&&this.showError(i18n.T("@@Please review the errors")),!1):!0}showError(d){this.errorPanel.clear();if(!d)return;let e=new a.Banner("critical",null,d);this.errorPanel.appendChild(e)}}a.Form=c})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c){super("div","ui-form2");b&&S.addClass(this.element,b),c&&c.appendChild(this),this.settings.children={type:"controlList",kind:"property"},this.addSignalListener("input",d=>this.onInput(d))}onInput(b){let c=b.source,d=c.property,e=d?d.name:c.id;this.model[e]=c.value}get model(){return this._model||(this._model={}),this._model}set model(b){this._model=b,this.refresh()}refresh(){let b=this._model||{};for(let c of this.getDescendants()){if(c instanceof a.InputControl){let d=c.property,e=d?d.name:c.id;if(!e)continue;let h=b[e];h===void 0&&(h=null),c.value=h;continue}if(c instanceof a.ModelControl){c.model=b;continue}}}}a.Form2=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("div","ui-formCell");this.labelPanel=new a.Control("div","formLabel",this,i18n.T(b)),this.controlPanel=new a.Control("div","controlPanel",this),this.helpPanel=new a.Control("div","helpPanel",this),this.control=c}get control(){return this._control}set control(b){this._control=b;let c=this.control.property;this.controlPanel.clear(),this.helpPanel.clear(),this.controlPanel.appendChild(this._control),this._control.inlineLabel?this.element.classList.add("inlineLabel"):c&&c.label&&(this.labelPanel.clear(),this.labelPanel.element.textContent=i18n.T(c.label||c.name),!c.nullable&&!c.nullableInType&&!c.readOnly&&c.requiredHint!==!1&&this.labelPanel.appendChild(new a.Control("span","required",this.labelPanel,"*"))),c&&c.help&&(this.helpPanel.element.textContent=i18n.T(c.help))}}a.FormCell=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c,d){super("div","ui-horizontalLayout",d);c&&a.addClass(this,c),b&&(this.type=b),this.settings.children={type:"controlList",kind:"property"}}get type(){return this._type}set type(b){this._type=b,this.element.classList.add(b)}get gap(){return this.style.gap}set gap(b){this.style.gap=b}}a.HorizontalLayout=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(){super("div","ui-htmleditor");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.toolbar=new a.Control("div","toolbar",this.inputPanel),this.editorIFrame=new a.Control("iframe","editor",this.inputPanel),this.editorIFrame.element.addEventListener("load",()=>{this.editorDocument=this.editorIFrame.element.contentWindow.document;let d=this.editorDocument.body;d.contentEditable="true",d.parentElement.style.padding="0",d.style.fontSize="14px",d.style.fontFamily='"Helvetica Neue", Helvetica, Arial, sans-serif',d.style.color="#4a4a4a",d.style.lineHeight="1.5rem",d.addEventListener("keydown",()=>this.fireChanged()),this._value&&(this.editorDocument.body.innerHTML=this._value)}),this.render(),this.handleFocus()}handleFocus(){let d=()=>{requestAnimationFrame(()=>{document.activeElement==this.editorIFrame.element&&this.editorIFrame.classList.add("focused")})};window.addEventListener("blur",d);let e=()=>this.editorIFrame.classList.remove("focused");window.addEventListener("focus",e),this.closeFunc=()=>{window.removeEventListener("focusout",e),window.removeEventListener("focusout",d)},a.addCloser(this)}close(){this.closeFunc&&this.closeFunc()}showError(d){this.errorPanel.clear();if(!d){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=d}get inlineLabel(){return!1}fireChanged(){setTimeout(()=>{this._value=this.editorDocument.body.innerHTML,this.sendSignal("input",this._value)},50)}get value(){return this._value}set value(d){this._value=d,this.editorDocument&&(this.editorDocument.body.innerHTML=d)}get mode(){return this._mode}set mode(d){this._mode=d,this.render()}render(){this.toolbar.clear();let d;switch(this.mode){case"basic":d=b;break;default:d=c;break}for(let e of d){let h=new a.ButtonGroup(!0);this.toolbar.appendChild(h);for(let f of e){let g=new a.Button();f.icon?(g.icon=f.icon,g.element.title=f.label):g.text=f.text||i18n.T(f.label),f.children?(g.actions=f.children.select(k=>({label:k.label,click:()=>this.sendCommand(g,k.cmd,k.value)})),g.popup.element.classList.add("ui-htmleditor-toolbar-popup")):g.addSignalListener("click",k=>{k.stopPropagation(),this.sendCommand(g,f.cmd,f.value)}),h.appendChild(g)}}}sendCommand(d,e,h){switch(e){case"toggleHTML":this.toggleHTML();break;case"createLink":this.showLinkDialog();break;case"insertImage":this.showImageDialog();break;default:this.execCommand(e,h),this.fireChanged();break}}showLinkDialog(){let d=new a.Form();d.addFields({name:"label",type:"string",label:i18n.T("@@Label")}),d.addFields({name:"url",type:"string",label:i18n.T("@@URL")});let e=new a.Modal();e.title=i18n.T("@@Link"),e.addContent(d);let h=new a.Button(i18n.T("@@Aceptar"));h.highlighted=!0,h.addSignalListener("click",()=>{if(!d.validate())return;e.close();let f=' <a href="'+d.model.label+'" target="_blank">'+d.model.url+"</a> ";this.execCommand("insertHTML",f),this.fireChanged()}),e.footerRight.appendChild(h),e.show(()=>d.focus())}showImageDialog(){let d=new a.Form();d.addFields({name:"url",type:"string",label:i18n.T("@@Image")});let e=new a.Modal();e.title=i18n.T("@@Image"),e.addContent(d);let h=new a.Button(i18n.T("@@Aceptar"));h.highlighted=!0,h.addSignalListener("click",()=>{if(!d.validate())return;e.close();let f='<img src="'+d.model.url+'" style="max-width: 100%">';this.execCommand("insertHTML",f),this.fireChanged()}),e.footerRight.appendChild(h),e.show(()=>d.focus())}execCommand(d,e){this.editorDocument.body.focus(),this.editorDocument.execCommand(d,!1,e)}toggleHTML(){let d=this.editorDocument.body;this.HTMLMode?(d.style.whiteSpace="",d.style.fontFamily='"Helvetica Neue", Helvetica, Arial, sans-serif',d.innerHTML=d.textContent):(d.style.whiteSpace="pre-wrap",d.style.fontFamily="monospace",d.textContent=d.innerHTML),this.HTMLMode=!this.HTMLMode}}a.HTMLEditor=i;const b=[[{icon:"bold",label:i18n.T("@@Bold"),cmd:"bold"},{icon:"italic",label:i18n.T("@@Italic"),cmd:"italic"},{icon:"link",label:i18n.T("@@Link"),cmd:"createLink"}]],c=[[{icon:"bold",label:i18n.T("@@Bold"),cmd:"bold"},{icon:"italic",label:i18n.T("@@Italic"),cmd:"italic"},{icon:"underline",label:i18n.T("@@Underline"),cmd:"underline"}],[{icon:"typography",label:i18n.T("@@Heading"),children:[{label:"Heading 1",cmd:"formatBlock",value:"H1"},{label:"Heading 2",cmd:"formatBlock",value:"H2"},{label:"Heading 3",cmd:"formatBlock",value:"H3"},{label:"Normal",cmd:"formatBlock",value:"div"}]}],[{icon:"indentLeft",label:i18n.T("@@Indent decrease"),cmd:"outdent"},{icon:"indentRight",label:i18n.T("@@Right increase"),cmd:"indent"},{icon:"list",label:i18n.T("@@Unordered list"),cmd:"insertUnorderedList"},{icon:"list",label:i18n.T("@@Ordered list"),cmd:"insertOrderedList"}],[{icon:"justifyLeft",label:i18n.T("@@Left align"),cmd:"justifyLeft"},{icon:"justifyCenter",label:i18n.T("@@Center align"),cmd:"justifyCenter"},{icon:"justifyRight",label:i18n.T("@@Right align"),cmd:"justifyRight"}],[{icon:"link",label:i18n.T("@@Link"),cmd:"createLink"},{icon:"photo",label:i18n.T("@@Image"),cmd:"insertImage"},{icon:"slash",label:i18n.T("@@Clear formatting"),cmd:"removeFormat"}],[{icon:"code",label:i18n.T("@@View code"),cmd:"toggleHTML"}]]})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("span","ui-icon");this.svg=b,this.element.appendChild(b)}get wait(){return this._wait}set wait(b){this._wait=b;if(b){if(!this.spinner){let c=a.getIconElement("refresh-cw");c.classList.add("spin"),this.spinner=c}this.svg.style.display="none",this.element.appendChild(this.spinner)}else this.spinner&&this.spinner.remove(),this.svg.style.display=""}}a.Icon=i})(ui||(ui={}));var ui;(function(a){class i extends a.Button{constructor(b,c,d){super(null,"ui-iconButton",d);super.icon=b,c&&a.addClass(this,c)}}a.IconButton=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(){super("div","ui-imagePicker");this.inputPanel=new a.Control("div","inputPanel empty",this),this.errorPanel=new a.Control("div","errPanel",this),this.innerPanel=new a.Control("div","innerPanel",this.inputPanel),this.render()}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get inlineLabel(){return!1}render(){this.innerPanel.clear();if(this.value){const b=new FileReader();b.readAsDataURL(this.value),b.onload=()=>{let c=b.result.toString();this.renderImage(c)};return}this.renderEmpty()}get value(){return this._value}set value(b){if(typeof b==="string"){let c=b;c.hasPrefix("/files/")||(c="/files"+c),this.renderImage(c);return}this._value=b,this.render()}renderEmpty(){let b=new a.Button(i18n.T("Select image"));b.highlighted=!0,b.click=()=>{if(this.onSelect){this.onSelect();return}this.showSelectFile()},this.imgDisplay=new a.Control("div","imgDisplay",this.innerPanel),this.imgDisplay.appendChild(b)}showSelectFile(){let b=S.createInput("file","inputFile");b.onclick=c=>c.stopPropagation(),b.style.position="absolute",b.style.visibility="hidden",b.style.height="0",b.style.width="0",b.accept=".gif,.jpg,.jpeg,.png",b.addEventListener("input",c=>this.onFilePicked(b.files[0])),this.innerPanel.element.appendChild(b),b.click()}onFilePicked(b){this.value=b,this.sendSignal("input",b)}renderImage(b){this.innerPanel.clear(),this.inputPanel.classList.remove("empty"),this.imgDisplay=new a.Control("div","imgDisplay",this.innerPanel);let c=new a.Img(null,this.imgDisplay);c.src=b;let d=new a.ButtonGroup(!0);this.previewButtons=d,d.classList.add("previewButtons"),this.innerPanel.appendChild(d);let e=new a.Button(i18n.T("@@Remove"));e.click=()=>{this.clear(),this.sendSignal("input"),this.render()},d.appendChild(e)}clear(){this._value=null,this.imgDisplay=null,this.innerPanel.clear(),this.inputPanel.classList.add("empty"),this.previewButtons&&(this.previewButtons.clear(),this.previewButtons.remove(),this.previewButtons=null)}}a.ImagePicker=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-imagedrop");this.innerPanel=new a.Control("div","innerPanel",this),this.render()}addDropEvents(c){c.addEventListener("dragover",d=>this.onDragover(d)),c.addEventListener("dragenter",d=>this.onDragenter(d)),c.addEventListener("dragleave",d=>this.onDragleave(d)),c.addEventListener("drop",d=>this.onDrop(d))}render(){if(!this.data&&!this.url){this.renderEmpty();return}this.innerPanel.element.classList.remove("empty");let c=new a.Control("div","imgDisplay",this.innerPanel),d=new a.Img(null,c);d.src=this.data||this.url;let e=new a.ButtonGroup(!0);e.element.classList.add("previewButtons"),this.innerPanel.appendChild(e);let h;h=new a.Button(i18n.T("@@Edit")),h.click=()=>this.startCrop(),e.appendChild(h),h=new a.Button(i18n.T("@@Remove")),h.click=()=>{this.url=null,this.data=null,this.renderEmpty()},e.appendChild(h)}clear(){this.innerPanel.clear()}isEmpty(){return this.innerPanel.element.classList.contains("empty")}renderEmpty(){this.clear(),this.innerPanel.element.classList.remove("crop"),this.innerPanel.element.classList.add("empty"),this.input=S.createInput("file","inputFile",this.innerPanel.element),this.input.onclick=e=>e.stopPropagation(),this.input.accept=".gif,.jpg,.jpeg,.png",this.input.addEventListener("input",e=>this.onFilePicked()),this.addDropEvents(this.innerPanel.element);let c=new a.Button(i18n.T("@@Add file"));c.highlighted=!0,c.click=()=>this.input.click(),this.appendChild(c);let d=new a.Control("div","row",this.innerPanel,c);this.addDropEvents(d.element),this.subtitleRow=new a.Control("div","row subtitle",this.innerPanel,b),this.addDropEvents(this.subtitleRow.element)}onDragover(c){c.preventDefault(),c.stopPropagation()}onDragenter(c){c.preventDefault(),c.stopPropagation(),this.innerPanel.element.classList.add("dragover")}onDragleave(c){c.preventDefault(),c.stopPropagation(),this.innerPanel.element.classList.remove("dragover")}onDrop(c){c.preventDefault(),c.stopPropagation();if(!this.isEmpty())return;this.innerPanel.element.classList.remove("dragover"),this.onFileSelected(c.dataTransfer.files[0]),c.dataTransfer.clearData()}onFilePicked(){this.onFileSelected(this.input.files[0]),this.input.files=null}onFileSelected(c){const d=new FileReader();d.readAsDataURL(c),d.onload=()=>{this.data=d.result.toString(),this.sendSignal("input",c),this.render()}}startCrop(){this.clear(),this.cropArea=new a.Control("div","cropArea",this.innerPanel);let c=new a.Control("div","footer",this.innerPanel),d=new a.ButtonGroup();c.appendChild(d);let e=new a.Button(i18n.T("@@Cancel"));e.addSignalListener("click",f=>{f.stopPropagation(),this.onCancelCrop()}),d.appendChild(e);let h=new a.Button(i18n.T("@@Save"));h.highlighted=!0,h.addSignalListener("click",f=>{f.stopPropagation(),this.saveCrop()}),d.appendChild(h),this.innerPanel.element.classList.add("crop"),this.innerPanel.element.classList.remove("empty"),this.cropImage=S.create("img",null,this.cropArea.element),this.cropImage.addEventListener("load",()=>this.showCropper()),this.cropImage.src=this.data||this.url}onCancelCrop(){this.stopDragging(),this.url=null,this.data=null,this.render()}saveCrop(){this.stopDragging(),this.data=this.getCroppedImage(),this.render()}getCroppedImage(c,d){const e=document.createElement("canvas"),h=this.cropImage.naturalWidth/this.cropImage.width,f=this.cropImage.naturalHeight/this.cropImage.height;let g=this.cropperBounds;const k=this.cropImage.offsetWidth-g.left-g.right,l=this.cropImage.offsetHeight-g.top-g.bottom;var p=k*h,m=l*f,n=1200,j=1200/(16/9),o=p,q=m;(p>n||m>j)&&(p/m>n/j?(o=n,q=Math.round(n*(m/p))):(q=j,o=Math.round(j*(p/m)))),e.width=o,e.height=q;const s=e.getContext("2d");return s.drawImage(this.cropImage,g.left*h,g.top*f,k*h,l*f,0,0,o,q),e.toDataURL(c||"image/png",d||1)}showCropper(){this.cropLayer=new a.Control("div","cropLayer",this.cropArea),this.innerPanel.element.addEventListener("mouseup",()=>this.stopDragging()),this.innerPanel.element.addEventListener("mousemove",l=>this.onMouseMove(l)),this.cropperBounds={left:20,right:20,top:20,bottom:20},this.adjustGrid();let c=new a.Control("div","cover",this.cropLayer);c.element.style.gridColumn="span 3",new a.Control("div","cover",this.cropLayer);let d=new a.Control("div","cropper",this.cropLayer);new a.Control("div","cover",this.cropLayer);let e=new a.Control("div","cover",this.cropLayer);e.element.style.gridColumn="span 3";let h=new a.Control("div","handle leftTop",d),f=new a.Control("div","handle rightTop",d),g=new a.Control("div","handle leftBottom",d),k=new a.Control("div","handle rightBottom",d);d.element.addEventListener("mousedown",l=>this.startDragging(l,"cropper")),h.element.addEventListener("mousedown",l=>this.startDragging(l,"leftTop")),f.element.addEventListener("mousedown",l=>this.startDragging(l,"rightTop")),g.element.addEventListener("mousedown",l=>this.startDragging(l,"leftBottom")),k.element.addEventListener("mousedown",l=>this.startDragging(l,"rightBottom"))}startDragging(c,d){if(c.button!=0)return;c.stopPropagation(),this.draggingElement=d,this.mouseStart={x:c.x,y:c.y},this.startBounds={left:this.cropperBounds.left,right:this.cropperBounds.right,top:this.cropperBounds.top,bottom:this.cropperBounds.bottom}}stopDragging(){this.mouseStart=null,this.startBounds=null,this.draggingElement=null}onMouseMove(c){if(c.buttons!=1)return;if(!this.startBounds)return;let d=c.x-this.mouseStart.x,e=c.y-this.mouseStart.y,h;switch(this.draggingElement){case"cropper":h=!0,this.cropperBounds.left=this.startBounds.left+d,this.cropperBounds.right=this.startBounds.right-d,this.cropperBounds.top=this.startBounds.top+e,this.cropperBounds.bottom=this.startBounds.bottom-e;break;case"leftTop":this.cropperBounds.left=this.startBounds.left+d,this.cropperBounds.top=this.startBounds.top+e;break;case"leftBottom":this.cropperBounds.left=this.startBounds.left+d,this.cropperBounds.bottom=this.startBounds.bottom-e;break;case"rightTop":this.cropperBounds.right=this.startBounds.right-d,this.cropperBounds.top=this.startBounds.top+e;break;case"rightBottom":this.cropperBounds.right=this.startBounds.right-d,this.cropperBounds.bottom=this.startBounds.bottom-e;break}d<0?this.cropperBounds.left<0&&(this.cropperBounds.left=0,h&&(this.cropperBounds.right=this.startBounds.left+this.startBounds.right)):d>0&&(this.cropperBounds.right<0&&(this.cropperBounds.right=0,h&&(this.cropperBounds.left=this.startBounds.left+this.startBounds.right))),e<0&&(this.cropperBounds.top<0&&(this.cropperBounds.top=0,h&&(this.cropperBounds.bottom=this.startBounds.top+this.startBounds.bottom))),e>0&&(this.cropperBounds.bottom<0&&(this.cropperBounds.bottom=0,h&&(this.cropperBounds.top=this.startBounds.top+this.startBounds.bottom))),this.adjustGrid()}adjustGrid(){this.adjustCropperBounds();let c=this.cropperBounds;this.cropLayer.element.style.gridTemplateColumns=c.left+"px auto "+c.right+"px",this.cropLayer.element.style.gridTemplateRows=c.top+"px auto "+c.bottom+"px"}adjustCropperBounds(){if(!this.aspectRatio)return;if(!this.draggingElement||this.draggingElement=="cropper")return;let c=this.cropArea.element.offsetWidth,d=this.cropArea.element.offsetHeight,e=this.cropperBounds,h=c-e.left-e.right,f=d-e.top-e.bottom,g=h/this.aspectRatio,k=f-g;switch(this.draggingElement){case"leftTop":case"rightTop":e.top+=k;break;case"leftBottom":case"rightBottom":e.bottom+=k;break}}}a.Imagedrop=i;const b=i18n.T("@@or drop a file to upload")})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("img",b,c)}get image(){return this.element}get src(){return this.image.src}set src(b){this.image.src=b}}a.Img=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c,d){super("a","ui-link");this.text=b,c&&(typeof c==="string"?this.url=c:this.click=c),d&&d.appendChild(this),this.element.addEventListener("click",e=>this.onClick(e))}get text(){return this.element.textContent}set text(b){this.element.textContent=i18n.T(b)}get link(){return this.element}get url(){return this._url}set url(b){this._url=b,this.link.href=b}onClick(b){b.preventDefault(),b.stopPropagation(),this.click&&this.click(),this.url&&S.executeAction(this.url)}}a.Link=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c,d){super("div","ui-list",d);this._numbered=b,c&&a.addClass(this,c)}get numbered(){return this._numbered}set numbered(b){this._numbered=b,this.render()}get options(){return this._options}set options(b){this._options=b,this.render()}render(){this.clear();let b=new a.Control(this._numbered?"ol":"ul",null,this);for(let c of this.options)new a.Control("li",null,b,c)}}a.List=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-modal");this.overlay=new a.Control("div","modalOverlay",this),this.overlay.addFinalListener("click",b=>this.overlayClick(b)),this.dialog=new a.Control("div","modalDialog",this),this.dialog.style.width="100%",this.headerPanel=new a.Control("div","modalHeader",this.dialog),this.titlePanel=new a.Control("div","title",this.headerPanel),this.dismissPanel=new a.Control("div","dismiss",this.headerPanel),this.dismissible=!0,this.contentPanel=new a.Control("div","modalContent",this.dialog),this.footerPanel=new a.Control("div","modalFooter",this.dialog),this.footerLeft=new a.Control("div","footerLeft",this.footerPanel),this.footerRight=new a.Control("div","footerRight",this.footerPanel)}overlayClick(b){this.closeOnOverlayClick&&this.close()}get width(){return this.dialog.style.width}set width(b){this.dialog.style.width=b}get maxWidth(){return this.dialog.style.maxWidth}set maxWidth(b){this.dialog.style.maxWidth=b}get height(){return this.dialog.style.height}set height(b){this.dialog.style.height=b}get maxHeight(){return this.dialog.style.maxHeight}set maxHeight(b){this.dialog.style.maxHeight=b}show(b){this.element.parentElement||document.body.appendChild(this.element),a.blur(),requestAnimationFrame(()=>{this.element.classList.add("visible"),requestAnimationFrame(()=>{this.dialog.element.classList.add("visible"),this.overlay.element.classList.add("visible")})});let c=()=>{this.dialog.element.removeEventListener("transitionend",c),this.contentPanel.sendSignal("show",null,"bubbleDown"),b&&b()};this.dialog.element.addEventListener("transitionend",c),a.addCloser(this)}addContent(b){return this.contentPanel.appendChild(b)}clear(){this.contentPanel.clear(),this.footerLeft&&(this.footerLeft.clear(),this.footerRight.clear())}close(){let b=()=>{this.element.classList.remove("visible"),this.dialog.element.removeEventListener("transitionend",b),this.remove(),this.clear(),a.removeCloser(this)};this.dialog.element.addEventListener("transitionend",b),this.dialog.element.classList.remove("visible"),this.overlay.element.classList.remove("visible")}get dismissible(){return this._dismissible}set dismissible(b){this.dismissPanel.clear(),this._dismissible=b;if(b){let c=a.getIcon("close",20,20);this.dismissPanel.appendChild(c),c.addSignalListener("click",()=>{this.onDismiss?this.onDismiss():this.close()})}}get title(){return this.titlePanel.element.textContent}set title(b){this.titlePanel.element.textContent=b}}a.Modal=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(c,d){super("div","ui-monthcalendar",d);this._date=c||new S.Time(),this.firstDayOfWeek=S.locale.firstDayOfWeek??0,this.render()}get selectedDate(){return this._selectedDate}set selectedDate(c){this._selectedDate=c;if(!c)this.clearSelection();else{let d=this.cells.first(e=>e.date.isSameDay(c));d&&d.classList.add("selected")}}get selectedDates(){return this._selectedDates||(this._selectedDates=[]),this._selectedDates}set selectedDates(c){this._selectedDates=c;if(c)for(let d of c){let e=this.cells.first(h=>h.date.isSameDay(d));e&&e.classList.add("selected")}}get date(){return this._date}set date(c){this._date=c,this.render()}render(){let c=this.date||new S.Time();var d=c.month,e=new S.Time(null,c.location),h=c.startOfDay(),f=c.setDay(1),g=c.setDay(c.daysInMonth());f=f.addDays(f.weekDay*-1+this.firstDayOfWeek),f.month==d&&f.day>1&&(f=f.addDays(-7));var k=g.weekDay;k>0&&k<=7-this.firstDayOfWeek&&(g=g.addDays(6+this.firstDayOfWeek-k));let l=new a.Control("table"),p;if(this.showHeader!==!1){p=new a.Control("tr","header",l);let w=new a.Control("td",null,p);w.element.className="headerLeft",w.element.colSpan=5;let y=new a.Control("span","monthPanel",w);this.showMonthArrows===!1&&y.element.classList.add("noControls");let z=this.showMonthArrows!==!1;if(z){let D=a.getIcon("leftChevron");D.addSignalListener("click",G=>{G.stopPropagation();let A=c.addMonths(-1);this.date=A,this.sendSignal("monthChange",A,"bubbleUp")}),y.appendChild(D)}var m=c.format("MMM");this.showYear!==!1&&(m+=" "+c.year),new a.Control("span","monthName",y,m);if(z){let D=a.getIcon("rightChevron");D.addSignalListener("click",G=>{G.stopPropagation();let A=c.addMonths(1);this.date=A,this.sendSignal("monthChange",A,"bubbleUp")}),y.appendChild(D)}this.todayCell=new a.Control("td",null,p),this.todayCell.element.colSpan=2,this.todayCell.element.className="todayPanel";let F=new a.Control("span","todayLink",this.todayCell,i18n.T("@@Today"));F.addSignalListener("click",D=>{D.stopPropagation(),this.date=new S.Time()})}p=new a.Control("tr",null,l),p.element.className="weekDays";for(var n=0;n<=6;n++){var j=n+this.firstDayOfWeek;j>6&&(j=0);var o=new a.Control("td",null,p);o.appendChild(new a.Text(i18n.T(S.weekDaysShort[j])))}var q=this.pastDatesDisabled,s=f.copy();this.cells=[];let u=0;for(;s.beforeOrEqual(g);){s.weekDay==this.firstDayOfWeek&&(p=new a.Control("tr",null,l),u++);var o=new a.Control("td",null,p);let w=new b(s,o);this.cells.push(w);switch(s.weekDay){case 0:case 6:o.element.classList.add("weekend");break}var x=q&&s<h;x?w.element.classList.add("disabledDay"):s.month!=d?w.element.classList.add("notCurrentMonth"):s.isSameDay(e)&&w.element.classList.add("today"),this.isSelected(s)&&w.element.classList.add("selected");let y=s.copy();w.addSignalListener("click",z=>{z.stopPropagation(),this.onDayClick(y,w)}),s=s.addDays(1)}if(u<6){p=new a.Control("tr",null,l);var o=new a.Control("td",null,p);o.element.colSpan=7,new a.Control("span","calendarDay",o)}this.clear(),this.appendChild(l)}isSelected(c){return this.selectedDate&&this.selectedDate.isSameDay(c)?!0:this.selectedDates&&this.selectedDates.any(d=>d.isSameDay(d))?!0:!1}onDayClick(c,d){this.multiSelect||this.clearSelection(),d.element.classList.toggle("selected"),this.sendSignal("input",c)}clearSelection(){this.selectedDates=[],S.removeClass(this.element,"selected")}}a.MonthCalendar=i;class b extends a.Control{constructor(c,d){super("span","calendarDay",d,c.day.toString());this.date=c}}})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-multiselect");this.id=b,this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.options=[],this.addFinalListener("click",()=>this.show()),this.render()}togleOption(b){let c=this.selectedOptions.firstIndex(d=>d.value==b.value);c!=-1?this.selectedOptions.removeAt(c):this.selectedOptions.push(b),this.render(),this.sendSignal("input")}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get selectedValues(){return this.selectedOptions.select(b=>b.value)}set selectedValues(b){this.selectedOptions=this.options.where(c=>b.contains(c.value)),this.render()}get selectedOptions(){return this._selectedOptions||(this._selectedOptions=[]),this._selectedOptions}set selectedOptions(b){this._selectedOptions=b,this.render()}render(){this.inputPanel.clear();if(this.selectedOptions.length==0){let b=i18n.T(this.placeHolder||"@@Click to select");new a.Text(b,this.inputPanel);return}for(let b of this.selectedOptions)if(this.renderSelectedOption)this.inputPanel.appendChild(this.renderSelectedOption(b));else{let c=new a.Tag(i18n.T(b.label));this.inputPanel.appendChild(c)}}close(){this.modal.close(),this.modal=null}async getOptions(){if(!this.loaded)if(this.loadURL){let b=await S.get(this.loadURL);this.loaded=!0;let c=[];for(let d of b)typeof d=="string"?c.push({label:d,value:d}):c.push(d);this.options=c}else this.loadFunction&&(this.options=await this.loadFunction());return this.options}async show(){let b=new a.Modal();b.contentPanel.classList.add("ui-selectPanel"),b.width="100%",b.maxWidth="400px",b.height="fit-content",b.maxHeight="500px",b.closeOnOverlayClick=!0,b.headerPanel.remove(),b.footerPanel.remove(),this.modal=b;let c;try{c=await this.getOptions()}catch(h){a.showToast(S.getErrorMessage(h),"error");return}let d;if(this.search){let h=new a.Control("div","searchRow",b.contentPanel);d=new a.TextInput(),h.appendChild(d),d.placeholder=i18n.T("@@Search"),d.prefixIcon="search",setTimeout(()=>d.input.focus(),10),d.addSignalListener("input",()=>{let f=S.removeDiacritics(d.input.value);f=f.replace(/[^a-zA-Z0-9 -]/,""),this.updateList(e,c,f)})}if(this.actions){let h=new a.Control("div","actionsPanel",b.contentPanel);for(let f of this.actions){let g=new a.Control("div","actionRow",h);f.icon&&g.appendChild(a.getIcon(f.icon)),g.appendChild(new a.Text(i18n.T(f.label))),g.addFinalListener("click",()=>f.click(this))}}let e=new a.Control("div","rowsPanel",b.contentPanel);this.updateList(e,c,null),b.show(),requestAnimationFrame(()=>{b.height=b.dialog.element.offsetHeight+"px"})}updateList(b,c,d){b.clear();let e=[],h;d&&(h=new RegExp(d,"i"));for(let f=0,g=c.length;f<g;f++){let k=this.options[f];if(d){let l=S.removeDiacritics(k.label);if(!h.test(l))continue}e.push(k)}for(let f=0,g=e.length;f<g;f++){let k=e[f],l=new a.Control("div","row",b),p=new a.Checkbox();l.appendChild(p),p.addFinalListener("input",()=>this.togleOption(k)),this.renderItem?l.appendChild(this.renderItem(k)):l.appendChild(new a.Text(i18n.T(k.label))),k.class&&l.classList.add(k.class),this.selectedOptions.any(m=>m.value==k.value)&&(p.checked=!0,l.classList.add("selected")),l.addFinalListener("click",()=>{p.checked=!p.checked,this.togleOption(k)})}}}a.MultiSelect=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(){super("div","ui-navigation");this.mainPanel=new a.Control("div","main",this),this.bottomPanel=new a.Control("div","bottom",this),this.spinnerColor="#fff",window.addEventListener("routeChange",b=>this.onRouteChange(b.detail))}render(){this.renderMain(),this.renderBottom()}renderMain(){this.mainPanel.clear(),this.mainSections&&this.addSections(this.mainSections,this.mainPanel)}addSections(b,c){for(let d=0,e=b.length;d<e;d++){let h=b[d],f=new a.Control("div","section",c);d>0&&new a.Control("div","sectionLabel",f,i18n.T(h.text));for(let g of h.items){if(g.parentName)continue;let k=new a.Control("div","item",f);g.control=k,g.disabled&&k.classList.add("disabled");let l=new a.Control("div","row clickable",k);l.addSignalListener("click",m=>{m.stopPropagation(),g.children?this.toggle(g):this.navigate(g)}),this.selectIfIsPath(g);let p=new a.Control("span","icon",l);g.icon&&p.appendChild(a.getIcon(g.icon,20,20)),new a.Control("div","label",l,i18n.T(g.label));if(g.children){let m=a.getIcon("rightChevron");m.classList.add("arrowIcon"),l.appendChild(m);let n=new a.Control("div","childrenWrap",k),j=new a.Control("div","children",n);g.childrenWrap=n,g.childrenPanel=j;for(let o of g.children){o.parent=g;let q=new a.Control("div","child clickable",j,i18n.T(o.label));q.addSignalListener("click",s=>{s.stopPropagation(),this.navigate(o)}),o.control=q,this.selectIfIsPath(o)}}}}}renderBottom(){this.bottomPanel.clear();let b=S.systemSession;if(b?.user){let e=new a.Control("div","row clickable session",this.bottomPanel),h=b.user.name.substring(0,1).toUpperCase();new a.Control("span","avatar",e,h);let f=new a.Control("div","user label",e);new a.Control("div","label",f,S.toTitle(b.user.name)),e.addFinalListener("click",()=>S.executeAction("//admin/account"))}let c=new a.Control("div","row clickable settings",this.bottomPanel),d=new a.Control("span","icon",c);d.appendChild(a.getIcon("settings",20,20)),new a.Control("div","label",c,i18n.T("@@Settings")),c.addFinalListener("click",()=>S.executeAction("//admin/settingsGroup"))}navigate(b){if(b.children){this.expand(b);return}this.path=b.url,!S.isControlPressed()&&!b.url?.hasPrefix("URL:")&&this.select(b),this.sendSignal("menuItemClick");if(b.click){b.click();return}S.executeAction(b.url)}clearSelection(){this.path=null,this.selected&&(this.selected.control.classList.remove("selected"),this.selected.parent?this.collapse(this.selected.parent):this.collapse(this.selected)),this.selected=null}select(b){this.clearSelection(),this.selected=b,b.control.classList.add("selected"),this.expand(b.parent)}toggle(b){if(!b||!b.children)return;b.control.classList.contains("expanded")?this.collapse(b):this.expand(b)}expand(b){if(!b||!b.children)return;b.childrenWrap.style.height=b.childrenPanel.element.offsetHeight+1+"px",b.control.classList.add("expanded")}collapse(b){if(!b||!b.children)return;b.childrenWrap.style.height="0",b.control.classList.remove("expanded")}selectIfIsPath(b){if(!b.url)return;this.path||(this.path=S.getCurrentPath());if(b.url==this.path)return this.select(b),!0}onRouteChange(b){this.path=b;if(!this.mainSections)return;for(let c of this.mainSections)for(let d of c.items)if(d.children){for(let e of d.children)if(this.selectIfIsPath(e))break}else if(this.selectIfIsPath(d))break}}a.Navigation=i})(ui||(ui={}));var ui;(function(a){class i extends a.Input{constructor(){super("number");this.element.addEventListener("keydown",b=>this.onKeydown(b))}onKeydown(b){b.keyCode==Keys.ENTER&&this.sendSignal("submit")}}a.NumberInput=i})(ui||(ui={}));var ui;(function(a){class i extends a.Button{constructor(b){super(null,"ui-optionsButton");this.icon="downChevron",this.dropdown=!1,this.popupHorizontalMode="left",b&&b.appendChild(this)}}a.OptionsButton=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-overlay")}}a.Overlay=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c){super("div","ui-page");b&&a.addClass(this,b),c&&a.addClass(this,c),this.waitDelay=300,this.internalElement=new a.Control("div","internalElement",this),this.header=new a.Control("div","pageHeader",this.internalElement),this.content=new a.Control("div","pageContent",this.internalElement),this.titleRow=new a.Control("div","headerRow",this.header),this.titleRowLeft=new a.Control("div","left",this.titleRow),this.titleRowRight=new a.Control("div","right",this.titleRow),this.primaryActions=new a.Control("div","prmaryActions",this.titleRowRight),this.paginationPanel=new a.Control("div","paginationPanel",this.titleRowRight),this.titleLabelWrap=new a.Control("div","titleLabelWrap",this.titleRowLeft),this.backIcon=new a.Control("div","backIcon",this.titleLabelWrap),this.titleLabelPanel=new a.Control("h1",null,this.titleLabelWrap),this.metadataPanel=new a.Control("div","titleMetadata",this.titleLabelWrap),this.subtitleRow=new a.Control("div","subtitle",this.header),this.secondaryActions=new a.Control("div","headerRow secondaryActionsRow",this.header),this.addSignalListener("show",()=>this.onLoad())}onLoad(){if(this.displayed)return;this.displayed=!0;let b=a.getAdminViewOrNull();b&&(b.title=i18n.T(this.title)||"",this.contextbarSave&&(b.contextBar.onSave=this.contextbarSave))}get back(){return this._back}set back(b){this._back=b,this.backIcon.clear();if(b){let c=new a.Button();c.icon="arrowLeft",this.backIcon.appendChild(c),typeof b==="string"?c.click=()=>S.executeAction(b):c.click=b}}get view(){return this.parent}get title(){return this._title}set title(b){this._title=b,this.titleLabelPanel.textContent=i18n.T(b)}get titleMetadata(){return this._titleMetadata}set titleMetadata(b){this._titleMetadata=b,this.metadataPanel.clear(),this.metadataPanel.appendChild(b)}get subtitle(){return this.subtitleRow.textContent}set subtitle(b){this.subtitleRow.textContent=b}get pagination(){return this._pagination}set pagination(b){this._pagination=b,this.paginationPanel.setChild(b)}get narrowWidth(){return this.element.classList.contains("narrowWidth")}set narrowWidth(b){b?this.element.classList.add("narrowWidth"):this.element.classList.remove("narrowWidth")}get veryNarrowWidth(){return this.element.classList.contains("veryNarrowWidth")}set veryNarrowWidth(b){b?this.element.classList.add("veryNarrowWidth"):this.element.classList.remove("veryNarrowWidth")}get headerBorder(){return this.header.element.classList.contains("headerBorder")}set headerBorder(b){b?this.header.element.classList.add("headerBorder"):this.header.element.classList.remove("headerBorder")}}a.Page=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-pagination");this.classList.add("disabled"),b&&(this.pageSize=b),this.labelElement=new a.Control("span","label",this),this.left=a.getIcon("leftChevron",19,19),this.left.classList.add("arrowButton"),this.appendChild(this.left),this.right=a.getIcon("rightChevron",19,19),this.right.classList.add("arrowButton"),this.appendChild(this.right),this.left.addSignalListener("click",c=>{c.stopPropagation(),this.rowMode?this.model.rowIndex>0&&(this.model.rowIndex--,this.right.element.classList.remove("disabled"),this.model.rowIndex==0&&this.left.element.classList.add("disabled"),this.rowChange&&this.rowChange()):this.model.page>1&&(this.model.page--,this.pageChange&&this.pageChange(this.model.page))}),this.right.addSignalListener("click",c=>{c.stopPropagation(),this.rowMode?this.model.rowIndex<this.model.pageSize&&(this.model.rowIndex++,this.left.element.classList.remove("disabled"),this.model.rowIndex>=this.model.pageSize-1&&this.right.element.classList.add("disabled"),this.rowChange&&this.rowChange()):this.model.page<this.totalPages()&&(this.model.page++,this.pageChange&&this.pageChange(this.model.page))})}totalPages(){return Math.ceil(this.model.totalCount/this.model.pageSize)}get model(){return this._model}set model(b){this._model=b,this.refresh()}get label(){return this.labelElement.element.textContent}set label(b){this.labelElement.element.textContent=b}clear(){this.model&&(this.model.page=1)}refresh(){if(!this.model){this.classList.add("disabled");return}this.model.totalCount==0?this.classList.add("disabled"):this.classList.remove("disabled");if(this.rowMode)this.model.rowIndex==0?this.left.classList.add("disabled"):this.left.classList.remove("disabled"),this.model.rowIndex<this.model.rows.length-1?this.right.classList.remove("disabled"):this.right.classList.add("disabled");else{this.model.page<=1?this.left.classList.add("disabled"):this.left.classList.remove("disabled"),this.model.page<this.totalPages()?this.right.classList.remove("disabled"):this.right.classList.add("disabled");if(this.model.totalCount<=this.model.pageSize)this.label=i18n.T("@@%d rows",this.model.totalCount),this.left.element.style.display="none",this.right.element.style.display="none";else{let b=this.model.pageSize*(this.model.page-1);this.label=i18n.T("@@%d to %d of %d rows",b+1,b+this.model.rows.length,S.format("i",this.model.totalCount)),this.left.element.style.display="",this.right.element.style.display=""}}}}a.Pagination=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c){super("div","ui-panel");b&&S.addClass(this.element,b),c&&c.appendChild(this),this.settings.children={type:"controlList",kind:"property"}}}a.Panel=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("div","ui-paragraph",c,b)}get value(){return this.element.textContent}set value(b){this.element.textContent=b}}a.Paragraph=i})(ui||(ui={}));var ui;(function(a){class i extends a.Input{constructor(){super("password");this.element.addEventListener("keydown",b=>this.onKeydown(b)),this.suffixIcon="eye",this.suffixElement.style.cursor="pointer",this.suffixElement.addFinalListener("click",()=>{this.input.type=="password"?(this.suffixIcon="eyeOff",this.input.type="text"):(this.suffixIcon="eye",this.input.type="password")})}onKeydown(b){b.keyCode==Keys.ENTER&&this.sendSignal("submit")}}a.PasswordInput=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("text","ui-periodpanel");this.form=new a.Form(),this.appendChild(this.form),this.rightPanel=new a.Panel("rightColumn"),this.appendChild(this.rightPanel),this.form.addFields({name:"start",type:"date",label:"@@Start",requiredHint:!1},{name:"end",type:"date",label:"@@End",requiredHint:!1}),this.startCal=new a.MonthCalendar(),this.startCal.addFinalListener("input",b=>{let c=this.value;c.range=null,c.start=b.data,this.sendSignal("input"),this.refresh()}),this.endCal=new a.MonthCalendar(),this.endCal.addFinalListener("input",b=>{let c=this.value;c.range=null,c.end=b.data,this.sendSignal("input"),this.refresh()}),this.form.addRow(this.startCal,this.endCal),this.actionList=new a.ActionList(),this.rightPanel.appendChild(this.actionList),this.actionList.actions=S.PeriodTypes.select(b=>({id:b.name,label:i18n.T(b.label),click:()=>{let c=this.value;c.range=b.name,this.value=c,this.sendSignal("input")}})),this.form.addFinalListener("input",()=>{this.form.model.range=null,this.refresh()})}get value(){return this.form.model||(this.form.model={range:"today"}),this.form.model}set value(b){this.form.model=b,this.refresh()}refresh(){let b=this.value;this.actionList.select(b.range);if(b.range){let c=S.parsePeriod(b.range);b.start=c.start,b.end=c.end}this.form.refresh()}}a.PeriodPanel=i})(ui||(ui={}));var ui;(function(a){class i extends a.Input{constructor(){super("text","ui-periodpicker");this.suffixIcon="calendar",this.input.readOnly=!0,this.element.addEventListener("keydown",d=>this.onKeydown(d)),this.addFinalListener("click",()=>this.onIconclick()),this.popup=new a.Popup("periodpicker-popup"),this.appendWindow(this.popup),this.popup.offsetY=5,this.popup.activator=this,this.periodPanel=new a.PeriodPanel();let b=new a.Panel();b.appendChild(this.periodPanel),this.popup.appendChild(b);let c=new a.ButtonGroup();c.right=!0,b.appendChild(c),c.appendChild(new a.Button(i18n.T("@@Accept"),"highlighted",()=>{this.popup.close()})),this.periodPanel.addFinalListener("input",()=>this.refresh())}get value(){return this.periodPanel.value}set value(b){this.periodPanel.value=b,this.refresh()}refresh(){let b=this.value;if(b.range){let c=S.PeriodTypes.first(e=>e.name==b.range);this.input.value=i18n.T(c.label);let d=c.func();b.start=d.start,b.end=d.end}else b.start&&b.end?this.input.value=b.start.format("d")+" - "+b.end.format("d"):b.start?this.input.value=b.start.format("d")+" - ":b.end&&(this.input.value=" - "+b.end.format("d"))}onIconclick(){this.popup.togle()}onKeydown(b){b.keyCode==Keys.ENTER&&this.sendSignal("submit")}}a.PeriodPicker=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-popup");this.offsetX=5,this.offsetY=2,this.widthMode="center",b&&a.addClass(this,b),this.element.addEventListener("transitionend",()=>{this.transitionEnd&&this.transitionEnd()})}get visible(){return this.element.classList.contains("visible")}togle(){let b=this.activator;this.togleFor(b)}togleFor(b){if(this.element.classList.contains("visible")){this.close();return}this.show(b)}show(b){if(this.element.classList.contains("visible"))return;let c;if(b)c=b.element;else if(this.activator)c=this.activator.element;else throw"No activator set";let d=S.getOffset(c);requestAnimationFrame(()=>{this.element.parentElement||(a.currentView?a.currentView.appendChild(this):document.body.appendChild(this.element)),this.element.style.display="block";let e;switch(this.verticalMode){case"top":e=d.top-this.element.offsetHeight-this.offsetY;break;default:e=d.top+c.offsetHeight+this.offsetY;break}this.element.style.top=e+"px";let h;switch(this.horizontalMode){case"left":h=d.left+c.offsetWidth-this.element.offsetWidth-this.offsetX;break;case"right":h=d.left+this.offsetX;break}switch(this.widthMode){case"activatorWidth":h==null&&(h=d.left),this.element.style.left=h+"px";let f=c.offsetWidth;f<200&&(f=200),this.element.style.width=f+"px";break;case"center":if(h==null){let g=c.offsetWidth-this.element.offsetWidth;h=g>0?d.left+g/2:d.left}this.element.style.left=h+"px";break}this.globalClickFunc=a.addGlobalClick(()=>this.close(),this,b),a.isTouchScreen()||(this.globalResizeFunc=a.addGlobalResize(()=>this.close())),requestAnimationFrame(()=>{this.element.classList.add("visible"),this.sendSignal("show",null,"bubbleDown"),this.sendSignal("popupVisible",null,"dontBubble")})}),a.closeOthers(this),a.addCloser(this)}close(){this.globalClickFunc&&(a.removeGlobalClick(this.globalClickFunc),this.globalClickFunc=null),this.globalResizeFunc&&(a.removeGlobalResize(this.globalResizeFunc),this.globalResizeFunc=null);if(!this.element.classList.contains("visible"))return;let b=()=>{this.element.removeEventListener("transitionend",b),this.element.remove(),a.removeCloser(this)};this.element.addEventListener("transitionend",b),this.element.classList.remove("visible"),this.onClose&&this.onClose()}}a.Popup=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(b,c,d){super("div","ui-propertyLabel");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),b&&(this.property=b),c&&c.appendChild(this),d!==void 0&&(this.value=d)}get inlineLabel(){return!1}get value(){return this._value}set value(b){this._value=b,this.inputPanel.textContent=a.formatProperty(this.property,this.value)}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}}a.PropertyLabel=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-propertyLabels");b&&b.appendChild(this),this.properties=[]}get model(){return this._model}set model(b){this._model=b,this.render(b)}render(b){this.clear();for(let c of this.properties){let d=b[c.name];if(d==null)continue;let e=new a.Control("div","row",this);new a.Control("div","label",e,i18n.T(c.label||c.name)),new a.Control("div","value",e,a.formatProperty(c,d))}}}a.PropertyLabels=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(b,c){super("div","ui-radiobutton");this._inlineLabel=!0,this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.input=S.createInput("radio",null,this.inputPanel.element),this.input.addEventListener("click",d=>this.onCheckClick(d)),b&&(this.input.name=b),this.label=new a.Control("span","label",this.inputPanel,c),this.label.element.addEventListener("click",d=>this.onLabelClick(d))}get name(){return this.input.name}set name(b){this.input.name=b}get checked(){return this.input.checked}set checked(b){this.input.checked=b}get inlineLabel(){return this._inlineLabel}set inlineLabel(b){this._inlineLabel=b}get value(){return this.input.checked}set value(b){this.input.checked=b}get text(){return this.label.element.textContent}set text(b){this.label.element.textContent=i18n.T(b)}onCheckClick(b){b.stopPropagation(),this.sendSignal("input")}onLabelClick(b){b.preventDefault(),b.stopPropagation(),this.input.checked=!this.input.checked,this.sendSignal("input")}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}}a.Radio=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(b,c){super("div","ui-rangeinput");this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.input=S.createInput("range",null,this.inputPanel.element),this.label=new a.Control("span","label",this.inputPanel),b&&(this.min=String(b)),c&&(this.max=String(c)),this.input.addEventListener("input",()=>{this.label.textContent=this.input.value})}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get inlineLabel(){return!1}get value(){return this.input.value}get id(){return this.input.id}set id(b){this.input.id=b}set value(b){this.input.value=b,this.label.textContent=this.input.value}get min(){return this.input.min}set min(b){this.input.min=b}get max(){return this.input.max}set max(b){this.input.max=b}get step(){return this.input.step}set step(b){this.input.step=b}}a.RangeInput=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-rowList",b);this.rows=[]}addRow(b,c){let d=new a.Control("div","row",this,b);return this.rows.push(d),c&&(d.classList.add("clickable"),d.addFinalListener("click",()=>{typeof c==="string"?S.executeAction(c):c()})),d}}a.RowList=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-rowPanel",b)}}a.RowPanel=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b,c,d){super("div","ui-section",c);this.headerElement=new a.Control("div","sectionHeader",this),this.titleElement=new a.Control("div","sectionTitle",this.headerElement,i18n.T(b)),b||(this.headerElement.element.style.display="none"),this.collapsable=d,this.contentWrap=new a.Control("div","contentWrap",this),this.content=new a.Control("div","sectionContent",this.contentWrap),this.collapsable&&(this.element.classList.add("collapsable"),this.collapseIcon=a.getIcon("downChevron",20,20),this.headerElement.appendChild(this.collapseIcon),this.headerElement.addFinalListener("click",()=>this.headerClick()),this.collapsed=!0)}headerClick(){this.collapsable&&(this.collapsed=!this.collapsed)}get collapsed(){return this._collapsed}set collapsed(b){this._collapsed=b;if(b)this.contentWrap.element.style.maxHeight="0",this.element.classList.remove("expanded");else{this.element.classList.add("expanded");if(this.contentMaxHeight)this.contentWrap.element.style.maxHeight=this.contentMaxHeight;else{let c=()=>{this.contentWrap.element.removeEventListener("transitionend",c),this.contentMaxHeight=this.contentWrap.element.offsetHeight+"px",this.contentWrap.element.style.maxHeight=this.contentMaxHeight};this.contentWrap.element.addEventListener("transitionend",c);let d=this.content.element.offsetHeight;d?this.contentWrap.element.style.maxHeight=d+"px":this.contentWrap.element.style.maxHeight="600px"}}}}a.Section=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(c){super("div","ui-sectiongroup");this.blocks=[],c&&c.appendChild(this)}addBlock(c,d){let e=new b(c,d);return this.appendChild(e),this.blocks.push(e),e}}a.SectionGroup=i;class b extends a.Control{constructor(c,d){super("div","sectionBlock");this.headerPanel=new a.Control("div","headerPanel",this),this.titlePanel=new a.Control("div","titlePanel",this.headerPanel,c),this.actionsPanel=new a.Control("div","actionsPanel",this.headerPanel),this.content=new a.Control("div","content",this),d&&this.content.appendChild(d)}get bottomBorder(){return this.headerPanel.classList.contains("bottomBorder")}set bottomBorder(c){c?this.headerPanel.classList.add("bottomBorder"):this.headerPanel.classList.remove("bottomBorder")}addAction(c,d){let e=new a.Link(c,d,this.actionsPanel);return e}addIconAction(c,d){let e=a.getIcon(c,20,20);return e.addFinalListener("click",()=>d()),this.actionsPanel.appendChild(e),e}}a.SectionBlock=b})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-segmentedrow",b);this.left=new a.Control("div","left",this),this.right=new a.Control("div","right",this)}}a.SegmentedRow=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(b){super("div","ui-select");this.id=b,this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.labelElement=new a.Control("span","label",this.inputPanel),this.iconElement=a.getIcon("downChevron",20,20),this.inputPanel.appendChild(this.iconElement),this.options=[],this.addFinalListener("click",()=>this.show()),this.element.addEventListener("keydown",c=>this.onKeyDown(c)),this.focusVisible=!0,this.element.tabIndex=0,this.element.addEventListener("focus",c=>this.onFocus(c)),this.element.addEventListener("blur",c=>this.onBlur(c))}onFocus(b){this.focusVisible&&this.inputPanel.classList.add("focused")}onBlur(b){this.focusVisible&&this.inputPanel.classList.remove("focused")}higlightOption(){S.removeClass(this.modal.element,"selected");if(this.highlightedIndex==-1)return;let b=this.displayedOptions[this.highlightedIndex].row;b.classList.add("selected"),b.element.scrollIntoView()}selectOption(b){this.selectedOption=b,this.sendSignal("input",b)}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}get inlineLabel(){return!1}renderLabel(){this.labelElement.clear(),this.icon&&this.labelElement.appendChild(a.getIcon(this.icon));let b=this._selectedOption;if(this.renderSelectedOption){this.labelElement.appendChild(this.renderSelectedOption(b));return}if(!b){new a.Control("span","content",this.labelElement,i18n.T(this.placeHolder));return}this.label&&this.labelPrefix&&new a.Control("span","labelPrefix",this.labelElement,i18n.T(this.label)),new a.Control("span","content",this.labelElement,i18n.T(b.label))}get selectedOption(){return this._selectedOption}set selectedOption(b){this._selectedOption=b,this._value=b?b.value:null,this.renderLabel()}get value(){return this._value}set value(b){if(b==null){this._value=null,this._selectedOption=null,this.label=null,this.renderLabel();return}let c=this.options.first(d=>d.value==b);c?this.selectedOption=c:(this._value=b,this.label=b,this.renderLabel())}get icon(){return this._icon}set icon(b){this._icon=b}get label(){return this._label}set label(b){this._label=b,this.render()}get labelPrefix(){return this._labelPrefix}set labelPrefix(b){this._labelPrefix=b}render(){this.renderLabel()}close(){this.modal.close(),this.modal=null}async getOptions(){if(!this.loaded)if(this.loadURL){let b=await S.get(this.loadURL);this.loaded=!0;let c=[];for(let d of b)typeof d=="string"?c.push({label:d,value:d}):c.push(d);this.options=c}else this.loadFunction&&(this.options=await this.loadFunction());return this.options}onKeyDown(b){switch(b.keyCode){case Keys.ENTER:b.preventDefault(),this.show();break}}async show(){let b=new a.Modal();b.contentPanel.classList.add("ui-selectPanel"),b.width="100%",b.maxWidth="400px",b.height="fit-content",b.maxHeight="500px",b.closeOnOverlayClick=!0,b.headerPanel.remove(),b.footerPanel.remove(),this.modal=b;let c;try{c=await this.getOptions()}catch(h){a.showToast(S.getErrorMessage(h),"error");return}let d;if(this.search){let h=new a.Control("div","searchRow",b.contentPanel);d=new a.TextInput(),h.appendChild(d),d.placeholder=i18n.T("@@Search"),d.prefixIcon="search",setTimeout(()=>d.input.focus(),10),d.addSignalListener("input",()=>{let f=S.removeDiacritics(d.input.value);f=f.replace(/[^a-zA-Z0-9 -]/,""),this.updateList(e,c,f)}),d.input.addEventListener("keydown",f=>{switch(f.keyCode){case Keys.DOWN:f.preventDefault(),this.highlightedIndex<this.displayedOptions.length-1&&(this.highlightedIndex++,this.higlightOption());break;case Keys.UP:f.preventDefault(),this.highlightedIndex>0&&(this.highlightedIndex--,this.higlightOption());break;case Keys.TAB:case Keys.ENTER:f.preventDefault();if(this.highlightedIndex==-1)return;this.onSelectOption(this.displayedOptions[this.highlightedIndex].option);break}})}if(this.actions){let h=new a.Control("div","actionsPanel",b.contentPanel);for(let f of this.actions){let g=new a.Control("div","actionRow",h);f.icon&&g.appendChild(a.getIcon(f.icon)),g.appendChild(new a.Text(i18n.T(f.label))),g.addFinalListener("click",()=>f.click(this))}}let e=new a.Control("div","rowsPanel",b.contentPanel);this.updateList(e,c,null),b.show(),requestAnimationFrame(()=>{b.height=b.dialog.element.offsetHeight+"px"})}updateList(b,c,d){b.clear();let e=[],h;d&&(h=new RegExp(d,"i"));for(let f=0,g=c.length;f<g;f++){let k=this.options[f];if(d){let l=S.removeDiacritics(k.label);if(!h.test(l))continue}e.push(k)}this.displayedOptions=[],this.highlightedIndex=-1;for(let f=0,g=e.length;f<g;f++){let k=e[f],l=new a.Control("div","row",b),p=new a.Radio("opt_"+this.id);l.appendChild(p),p.addFinalListener("input",()=>this.onSelectOption(k)),this.renderItem?l.appendChild(this.renderItem(k)):l.appendChild(new a.Text(i18n.T(k.label))),k.class&&l.classList.add(k.class),k==this.selectedOption&&(p.checked=!0,l.classList.add("selected"),this.highlightedIndex=f),l.addFinalListener("click",()=>{p.checked=!p.checked,this.onSelectOption(k)}),this.displayedOptions.push({row:l,option:k})}}onSelectOption(b){this.close(),this.selectedOption=b,this.sendSignal("input",b)}}a.Select=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-slider");this._index=0,this.slides=[],b&&b.appendChild(this),this.panel=new a.Control("div","sliderPanel",this),a.addResizeObserver(this,()=>this.onResize()),this.panel.element.addEventListener("transitionend",()=>this.sendSignal("slideChange"))}get index(){return this._index}set index(b){this._index=b,this.setPanelPosition()}current(){return this.slides[this.index]}byIndex(b){return this.slides[b]}byID(b){return this.slides.first(c=>c.id==b)}addSlideId(b,c){let d=this.addSlide(c);return d.id=b,d}addSlide(b){let c=new a.Control("div","slide",this.panel,b),d={control:c};return this.slides.push(d),d}back(){if(this.index<=0)return;this.index--}next(){if(this.index>=this.slides.length-1){this.index=0;return}this.index++}show(b){let c=this.slides.firstIndex(d=>d.id==b);if(c==-1)throw"invalid id: "+b;this.index=c}onResize(){let b=this.element.offsetWidth;for(let c of this.slides)c.control.style.width=b+"px";this.setPanelPosition()}setPanelPosition(){let b=this.element.offsetWidth,c=this.index*b*-1;this.panel.style.transform="translateX("+c+"px)"}}a.Slider=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b){super("div","ui-sortable",b);this.controls=[],this.rows=[],this.placeholders=[],this.element.addEventListener("mousemove",c=>this.onMouseMove(c)),this.element.addEventListener("mouseup",c=>this.onDrop(c)),this.element.addEventListener("mouseleave",c=>this.onDrop(c))}get rightHandle(){return this._rightHandle}set rightHandle(b){this._rightHandle=b,b?this.element.classList.add("rightHandle"):this.element.classList.remove("rightHandle")}clear(){super.clear(),this.controls=[]}addRows(...b){let c=[];for(let d of b){let e=new a.Control("div","rowItem",null,d.text);e.customData=d.data,this.controls.push(e),c.push(e)}return this.render(),c}addControls(...b){for(let c of b)this.controls.push(c);this.render()}render(){S.clear(this.element),this.mouseOverRow=null,this.draggingItem=null,this.placeholder=null,this.rows=[],this.placeholders=[];let b=[];for(let d of this.controls){let e=S.create("div","placeholder",this.element);this.placeholders.push(e);let h=new a.Control("div","sortableRowWrap",this),f=new a.Control("div","sortableRow",h);f.element.id=this.nextRowId(),this.rows.push(f);if(!this.rightHandle){let k=new a.Control("div","sortHandle",f);k.appendChild(a.getIcon("gripVertical")),k.element.addEventListener("mousedown",l=>this.onDragStart(l,f))}let g=new a.Control("div","content",f);g.appendChild(d);if(this.rightHandle){let k=new a.Control("div","sortHandle",f);k.appendChild(a.getIcon("gripVertical")),k.element.addEventListener("mousedown",l=>this.onDragStart(l,f))}if(d instanceof a.AccordionItem){let k=d;b.push(k),k.bodyWrap=new a.Control("div","sortableAccordionBodyContainer",h),k.addSignalListener("expand",l=>{for(let p of b)p!=k&&p.close()})}}let c=S.create("div","placeholder",this.element);this.placeholders.push(c)}nextRowId(){return(this.element.id||"sortable_")+this.rows.length}getIdIndex(b){let c=b.indexOf("_");return Number(b.substring(c+1))}onDragStart(b,c){b.stopPropagation(),this.draggingItem=c,this.dragItemStartY=c.element.offsetTop,this.mouseStartY=b.y,c.element.style.top=c.element.offsetTop+"px",c.element.classList.add("dragging");let d=this.placeholders[this.getIdIndex(c.element.id)],e=this.element.style.transition,h=this.draggingItem.element.offsetHeight;d.style.transition="none",requestAnimationFrame(()=>{this.placeholder=d,d.style.height=h+"px",requestAnimationFrame(()=>d.style.transition=e)})}onMouseMove(b){if(!this.draggingItem)return;let c=b.y,d=c-this.mouseStartY;this.draggingItem.element.style.top=this.dragItemStartY+d+"px";let e,h;for(let l=0,p=this.rows.length;l<p;l++){let m=this.rows[l];if(m==this.draggingItem)continue;let n=m.element.getBoundingClientRect();if(c>=n.top&&c<n.top+n.height){e=m,h=n;break}}if(!e)return;this.mouseOverRow=e;let f=this.getIdIndex(e.element.id),g=h.top+h.height/2;c>g&&f++;let k=this.placeholders[f];if(this.placeholder){if(this.placeholder==k)return;this.placeholder.style.height="0"}k.style.height=this.draggingItem.element.offsetHeight+"px",this.placeholder=k}onDrop(b){if(!this.draggingItem)return;if(this.mouseOverRow){let c=this.getIdIndex(this.draggingItem.element.id),d=this.getPreviousTopId(b.y),e=this.controls[c];this.controls.removeAt(c),this.controls.insertAt(d,e),this.sendSignal("sorted",{from:c,to:d,item:e})}else this.draggingItem.element.style.top=this.mouseStartY+"px";this.render()}getPreviousTopId(b){let c=0;for(let d of this.rows){if(d==this.draggingItem)continue;let e=d.element.getBoundingClientRect();if(e.top>=b)break;c++}return c}}a.Sortable=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-spinner");this.spinnerIcon=S.create("div","spinnerIcon spin",this.element)}start(){this.spinnerIcon.classList.add("spin"),this.spinnerIcon.style.display=""}stop(){this.spinnerIcon.classList.remove("spin"),this.spinnerIcon.style.display="none"}get color(){return this._color}set color(b){this._color=b,this.spinnerIcon.style.borderColor=b,this.spinnerIcon.style.borderTopColor="transparent"}get size(){return this._size}set size(b){this._size=b,this.spinnerIcon.style.width=b+"rem",this.spinnerIcon.style.height=b+"rem",b>2?this.spinnerIcon.style.borderWidth="3px":this.spinnerIcon.style.borderWidth="2px"}get borderWidth(){return this.spinnerIcon.style.borderWidth}set borderWidth(b){this.spinnerIcon.style.borderWidth=b}}a.Spinner=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-stack",b)}get distribution(){return this.element.style.justifyContent}set distribution(b){this.element.style.justifyContent=b}}a.Stack=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b){super("div","ui-table",b);this.contentElement=new a.Control("div","content",this),this.waitDelay=200,this.columns=[],this._selectedIds=[]}setHeaderCheck(b){if(!this.headerCheckbox)return;this.headerCheckbox.checked=b}get idProperty(){return this._idProperty||"id"}set idProperty(b){this._idProperty=b}get selectedIds(){return this._selectedIds}set selectedIds(b){this._selectedIds=b,this.updateCheckedState()}get model(){return this._model}set model(b){this._model=b,this.render()}appendRows(b){this._model=this._model.concat(b),this.addRows(b),this.adjustBounds()}scrollToEnd(){this.contentElement.element.scrollBy(0,this.contentElement.element.scrollHeight)}setContent(b){this.contentElement.setChild(b)}addContent(b){this.contentElement.appendChild(b)}clearContent(){this.contentElement.clear()}render(){this.doRender(),this.adjustBounds()}doRender(){this.contentElement.clear();if(!this._model?.length){this.emptyState&&this.contentElement.appendChild(this.emptyState);return}this.table=new a.Control("table",null,this.contentElement),this.stickyHeader&&this.table.classList.add("sticky"),this.checkboxes=[];let b=new a.Control("tr","header",this.table);if(this.selectRows){let e=new a.Control("th","rowCheck",b),h=S.createInput("checkbox");this.headerCheckbox=h,h.addEventListener("click",()=>this.onHeaderCheckClick(h.checked)),e.element.appendChild(h)}if(this.columns.length==0&&this._model.length>0){let e=this._model[0];for(let h in e){let f;switch(typeof h){case"number":f="decimal";break;case"boolean":f="decimal";break;default:f="string";break}this.columns.push({name:h,type:f,label:h})}}let c,d;if(this.order){let e=this.order.split(" ");e.length!=2?console.log("Invalid table order: "+this.order):(c=e[0],d=e[1])}for(let e=0,h=this.columns.length;e<h;e++){let f=this.columns[e],g=new a.Control("th",null,b),k=i18n.T(f.label||f.name);this.sortable?this.renderSortableCell(g,k,f,c,d):g.textContent=k;switch(f.type){case"hash":case"encrypted":g.element.classList.add("hashPlaceholder");break;case"date":g.element.classList.add("date");break;case"datetime":g.element.classList.add("datetime");break;case"int":g.element.classList.add("number");break;case"decimal":g.element.classList.add("number");break;case"currency":g.element.classList.add("number");break}}this.addRows(this._model)}renderSortableCell(b,c,d,e,h){let f=new a.Control("span","sortable",b,c),g;e==d.name&&(g=this.getSorIcon(h),f.appendChild(g)),b.addFinalListener("click",()=>{let k=h&&h.toUpperCase()=="ASC"?"DESC":"ASC";g&&g.remove(),g=this.getSorIcon(k),f.appendChild(g),this.order=`${d.name} ${k}`,this.sendSignal("sort",{order:this.order,property:d,type:k})})}getSorIcon(b){let c=b=="ASC"?"upChevron":"downChevron",d=a.getIcon(c,14,14);return d}addRows(b){for(let c=0,d=b.length;c<d;c++){let e=b[c],h=new a.Control("tr",null,this.table);if(this.selectRows){let f=new a.Control("td","rowCheck",h),g=document.createElement("input");g.type="checkbox",g.addEventListener("click",k=>{k.stopPropagation(),this.onCheckClick(e,g.checked),g.checked?h.element.classList.add("selected"):h.element.classList.remove("selected")}),f.element.appendChild(g),this.checkboxes.push(g)}for(let f=0,g=this.columns.length;f<g;f++){let k=this.columns[f],l=e[k.name],p=new a.Control("td",null,h),m;this.renderCell&&(m=this.renderCell(p,l,k)),m||(p.element.innerText=this.format(l,k,p.element,e)),p.addSignalListener("click",()=>{let n={model:e,index:c};this.rowClick&&this.rowClick(n),this.sendSignal("rowClick",n,"bubbleUp")})}}this.updateCheckedState()}format(b,c,d,e){if(b==null)return"";switch(c.type){case"hash":case"encrypted":return d.classList.add("hashPlaceholder"),orm.PASSWORD_MASK;case"date":return d.classList.add("date"),S.format("d",b);case"datetime":return d.classList.add("datetime"),S.format("g",b);case"int":return d.classList.add("number"),S.format("i",b);case"decimal":return d.classList.add("number"),S.format("f",b);case"currency":return d.classList.add("number"),S.format("c",b);case"bool":return b==1||b==!0?i18n.T("@@yes"):i18n.T("@@no");case"picklist":if(c.items)for(var h=0,f=c.items.length;h<f;h++){var g=c.items[h];if(g.value==b)return i18n.T(g.label||g.name)}break;case"lookup":if(e){let k=orm.getRefDesc(c),l=e[k];return l}break}return String(b).replaceAll(`
`," ")}onCheckClick(b,c){c?this.selectedIds.push(b[this.idProperty]):(this.selectedIds.remove(b[this.idProperty]),this.headerCheckbox.checked=!1,this.allSelected&&(this.allSelected=!1,this.updateCheckedState())),this.sendSignal("rowCheck",{item:b,selected:c},"bubbleUp")}onHeaderCheckClick(b){if(!this.selectRows)return;this.sendSignal("headerRowCheck",{selected:b},"bubbleUp"),this.selectAll(b)}selectAll(b){this.selectedIds=[];if(b)for(let c=0,d=this._model.length;c<d;c++){let e=this._model[c];this.selectedIds.push(e[this.idProperty])}this.updateCheckedState()}updateCheckedState(){if(!this.selectRows)return;for(let b=0,c=this._model.length;b<c;b++){let d=this._model[b];this.allSelected||this.selectedIds.contains(d[this.idProperty])?(this.checkboxes[b].checked=!0,this.checkboxes[b].parentElement.parentElement.classList.add("selected")):(this.checkboxes[b].checked=!1,this.checkboxes[b].parentElement.parentElement.classList.remove("selected"))}}adjustBounds(){this.adjustVerticalScroll()}adjustVerticalScroll(){this.style.height="",this.contentElement.style.overflowY="";let b=a.getAdminViewOrNull();if(!b)return;let c=b.page.element,d=c.scrollHeight-c.offsetHeight;if(d<=0){this.contentElement.style.overflowY="hidden";return}this.element.offsetWidth>=this.element.scrollWidth&&(d+=20),this.style.height=this.element.scrollHeight-d+"px"}}a.Table=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("span","ui-tabpanel");b&&(this._tabs=b,this.render()),this.settings.tabs={type:"objectList",kind:"property",settings:{id:{type:"string",kind:"property"},icon:{type:"icon",kind:"property"},label:{type:"string",kind:"property"},selected:{type:"boolean",kind:"property"},data:{type:"string",kind:"property"},click:{type:"function",kind:"property"}}},this.addSignalListener("show",()=>this.render()),a.addResizeObserver(this,()=>this.adjustVisibleTabs(),50)}get tabs(){return this._tabs||(this._tabs=[]),this._tabs}set tabs(b){this._tabs=b}render(){this.clear();for(let b of this.tabs){b.control=new a.Control("div","tab",this);let c=new a.Control("div","inner",b.control);b.icon&&c.appendChild(a.getIcon(b.icon)),b.label&&new a.Control("span",null,c,b.label),b.selected&&b.control.element.classList.add("selected"),c.addSignalListener("click",d=>{d.stopPropagation(),this.onTabClick(b)})}}adjustVisibleTabs(){if(!this.tabs)return;this.btnShowMoreTabs&&(this.btnShowMoreTabs.remove(),this.btnShowMoreTabs=null);const b=this.element.offsetWidth;let c=25,d=[];for(let e of this.tabs)e.control.element.style.display="",c+=e.control.element.offsetWidth,c>b&&(e.control.element.style.display="none",d.push(e));if(d.length>0){let e=new a.Button();this.appendChild(e),this.btnShowMoreTabs=e,e.dropdownIcon="more",e.plain=!0,e.popupHorizontalMode="left",e.actions=d.select(h=>({label:h.label,click:()=>this.selectTab(h)}))}}onTabClick(b){this.selectTab(b),this.sendSignal("tabSelected",b)}selectId(b,c){let d=this.tabs.first(e=>e.id==b);this.selectTab(d),c&&this.sendSignal("tabSelected",d)}selectTab(b){this.selectedTab=b;for(let c of this.tabs)c==b?(c.selected=!0,c.control.element.classList.add("selected")):(c.selected=!1,c.control.element.classList.remove("selected"));b.click&&b.click()}}a.TabPanel=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("span","ui-tag");b&&(this._text=b,this.render())}get text(){return this._text}set text(b){this._text=b}get closeAction(){return this._closeAction}set closeAction(b){this._closeAction=b}render(){this.clear();let b=new a.Control("span","tagText",this,this.text);if(this._closeAction){b.element.classList.add("withClose");let c=a.getIcon("close",18,18);new a.Control("span","close",this,c),c.addSignalListener("click",d=>{d.stopPropagation(),this._closeAction(this,d)})}}}a.Tag=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-tageditor");this.autocomplete=new a.Autocomplete(),this.appendChild(this.autocomplete),this.autocomplete.element.addEventListener("keydown",b=>this.onKeydown(b)),this.autocomplete.addSignalListener("input",b=>this.onAutocompleteSelect(b)),this._tags=[],this.stack=new a.Stack(),this.appendChild(this.stack)}get placeholder(){return this.autocomplete.placeholder}set placeholder(b){this.autocomplete.placeholder=b}onAutocompleteSelect(b){this.autocomplete.value="",this.addTag(b.data.label)}onKeydown(b){if(b.keyCode!=Keys.ENTER)return;let c=this.autocomplete.text;if(!c)return;for(let e of this.stack.children){let h=e;if(h.text==c){this.autocomplete.value="";return}}this.autocomplete.value="",this.sendSignal("tagAdded",c);let d=this.addTag(c);d.render(),this.autocomplete.input.focus()}addTag(b){if(this._tags.contains(b))return;let c=new a.Tag();return c.text=b,c.closeAction=()=>{c.remove(),this.sendSignal("tagRemoved",b),this.tags.remove(b)},c.render(),this.stack.appendChild(c),this.tags.push(b),c}get tags(){return this._tags}set tags(b){this._tags=b;for(let c of b)this.addTag(c)}}a.TagEditor=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("span","ui-text",c,b)}get value(){return this.element.textContent}set value(b){this.element.textContent=b}}a.Text=i})(ui||(ui={}));var ui;(function(a){class i extends a.InputControl{constructor(){super("div","ui-textarea");this.settings.spellcheck={type:"boolean",kind:"property"},this.inputPanel=new a.Control("div","inputPanel",this),this.errorPanel=new a.Control("div","errPanel",this),this.input=document.createElement("textarea"),this.inputPanel.element.appendChild(this.input),this.input.addEventListener("keyup",()=>this.adjustHeightIfNeeded()),this.input.addEventListener("input",()=>this.sendSignal("input")),this.addSignalListener("show",()=>this.adjustHeightIfNeeded()),this.input.addEventListener("focus",b=>this.onFocus(b)),this.input.addEventListener("blur",b=>this.onBlur(b))}get spellcheck(){return this.input.spellcheck}set spellcheck(b){this.input.spellcheck=b}onFocus(b){this.focusVisible&&this.inputPanel.classList.add("focused")}onBlur(b){this.focusVisible&&this.inputPanel.classList.remove("focused")}get inlineLabel(){return!1}adjustHeightIfNeeded(){this.autosize&&this.adjustHeight()}adjustHeight(){this.input.style.height="1px",this.input.style.height=25+this.input.scrollHeight+"px"}get value(){return this.input.value}set value(b){this.input.value=b}get placeholder(){return this.input.placeholder}set placeholder(b){this.input.placeholder=b}showError(b){this.errorPanel.clear();if(!b){this.classList.remove("error");return}this.classList.add("error"),this.errorPanel.element.textContent=b}}a.TextArea=i})(ui||(ui={}));var ui;(function(a){class i extends a.Input{constructor(){super("text");this.element.addEventListener("keydown",b=>this.onKeydown(b))}onKeydown(b){b.keyCode==Keys.ENTER&&this.sendSignal("submit")}}a.TextInput=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c,d){super("div","ui-title");b&&(this.text=i18n.T(b)),c&&c.appendChild(this),d&&(this.padding=!0)}get padding(){return this._padding}set padding(b){this._padding=b,this.style.padding=b?"0 1rem":"0"}get text(){return this.textContent}set text(b){this.textContent=b}}a.Title=i})(ui||(ui={}));var ui;(function(a){let i;function b(d,e,h){let f=new c();f.show(d,e,h)}a.showToast=b;class c extends a.Control{constructor(d){super("div","ui-toast");this.contentPanel=S.create("div","content",this.element),this.dismissPanel=S.create("div","dismissPanel",this.element),d&&d.appendChild(this);let e=a.getIconElement("close",20,20);this.dismissPanel.appendChild(e),e.addEventListener("click",()=>this.close())}show(d,e,h){i&&(i.close(),i=null),d&&(this.text=d),this.classList.add(e||"default"),i=this,a.addCloser(this),h!==!1&&setTimeout(()=>this.close(),4000),this.parent?this.element.classList.add("visible"):(this.detached=!0,a.currentView?a.currentView.appendChild(this):document.body.appendChild(this.element),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.element.classList.add("visible")})}))}close(){if(this.detached){let d=()=>{this.element.removeEventListener("transitionend",d),this.remove()};this.element.addEventListener("transitionend",d)}this.element.classList.remove("visible"),a.removeCloser(this)}get visible(){return this.element.classList.contains("visible")}get text(){return this.contentPanel.textContent}set text(d){this.contentPanel.textContent=d}}a.Toast=c})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b,c){super("div","ui-tooltip");this.text=b,this.activator=c,this.activator.addFinalListener("click",()=>this.togle()),this.activator.element.addEventListener("mouseover",()=>this.show()),this.activator.element.addEventListener("mouseleave",()=>this.close())}ensureInitialized(){this.popup||(this.popup=new a.Popup(),this.popup.classList.add("ui-tooltip"),this.popup.horizontalMode="left",this.popup.verticalMode="top",this.popup.offsetY=5,this.popup.offsetX=0,this.popup.activator=this.activator,new a.Text(this.text,this.popup))}show(){this.ensureInitialized(),this.popup.show()}togle(){this.ensureInitialized(),this.popup.togle()}close(){this.popup&&this.popup.close()}}a.Tooltip=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(){super("div","ui-topbar");this.left=new a.Control("div","left",this),this.center=new a.Control("div","center",this),this.right=new a.Control("div","right",this),this.render()}render(){this.left.clear(),this.menuIcon=new a.Control("span","menuIcon",this.left),this.menuIcon.appendChild(a.getIcon("menu",27,27))}}a.Topbar=i})(ui||(ui={}));var ui;(function(a){class i extends a.WaitControl{constructor(b){super("div","ui-verticalLayout",b);this.settings.children={type:"controlList",kind:"property"}}}a.VerticalLayout=i})(ui||(ui={}));var ui;(function(a){class i extends a.Control{constructor(b){super("div","ui-view");b&&a.addClass(this,b)}get title(){return this._title}set title(b){this._title=b}}a.View=i})(ui||(ui={}));
